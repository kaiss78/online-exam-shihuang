(function(a){a.widget("ui.autocomplete",{options:{appendTo:"body",delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},_create:function(){var b=this,d=this.element[0].ownerDocument,c;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(d){if(b.options.disabled||b.element.attr("readonly"))return;c=false;var e=a.ui.keyCode;switch(d.keyCode){case e.PAGE_UP:b._move("previousPage",d);break;case e.PAGE_DOWN:b._move("nextPage",d);break;case e.UP:b._move("previous",d);d.preventDefault();break;case e.DOWN:b._move("next",d);d.preventDefault();break;case e.ENTER:case e.NUMPAD_ENTER:if(b.menu.active){c=true;d.preventDefault()}case e.TAB:if(!b.menu.active)return;b.menu.select(d);break;case e.ESCAPE:b.element.val(b.term);b.close(d);break;default:clearTimeout(b.searching);b.searching=setTimeout(function(){if(b.term!=b.element.val()){b.selectedItem=null;b.search(null,d)}},b.options.delay)}}).bind("keypress.autocomplete",function(a){if(c){c=false;a.preventDefault()}}).bind("focus.autocomplete",function(){if(b.options.disabled)return;b.selectedItem=null;b.previous=b.element.val()}).bind("blur.autocomplete",function(a){if(b.options.disabled)return;clearTimeout(b.searching);b.closing=setTimeout(function(){b.close(a);b._change(a)},150)});this._initSource();this.response=function(){return b._response.apply(b,arguments)};this.menu=a("<ul></ul>").addClass("ui-autocomplete").appendTo(a(this.options.appendTo||"body",d)[0]).mousedown(function(d){var c=b.menu.element[0];!a(d.target).closest(".ui-menu-item").length&&setTimeout(function(){a(document).one("mousedown",function(d){d.target!==b.element[0]&&d.target!==c&&!a.ui.contains(c,d.target)&&b.close()})},1);setTimeout(function(){clearTimeout(b.closing)},13)}).menu({focus:function(a,d){var c=d.item.data("item.autocomplete");if(false!==b._trigger("focus",a,{item:c}))/^key/.test(a.originalEvent.type)&&b.element.val(c.value)},selected:function(e,f){var a=f.item.data("item.autocomplete"),c=b.previous;if(b.element[0]!==d.activeElement){b.element.focus();b.previous=c;setTimeout(function(){b.previous=c},1)}false!==b._trigger("select",e,{item:a})&&b.element.val(a.value);b.term=b.element.val();b.close(e);b.selectedItem=a},blur:function(){b.menu.element.is(":visible")&&b.element.val()!==b.term&&b.element.val(b.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");a.fn.bgiframe&&this.menu.element.bgiframe()},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();a.Widget.prototype.destroy.call(this)},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments);b==="source"&&this._initSource();b==="appendTo"&&this.menu.element.appendTo(a(c||"body",this.element[0].ownerDocument)[0])},_initSource:function(){var b=this,c,d;if(a.isArray(this.options.source)){c=this.options.source;this.source=function(d,b){b(a.ui.autocomplete.filter(c,d.term))}}else if(typeof this.options.source==="string"){d=this.options.source;this.source=function(e,c){b.xhr&&b.xhr.abort();b.xhr=a.getJSON(d,e,function(a,e,d){d===b.xhr&&c(a);b.xhr=null})}}else this.source=this.options.source},search:function(a,b){a=a!=null?a:this.element.val();this.term=this.element.val();if(a.length<this.options.minLength)return this.close(b);clearTimeout(this.closing);return this._trigger("search",b)===false?void 0:this._search(a)},_search:function(a){this.element.addClass("ui-autocomplete-loading");this.source({term:a},this.response)},_response:function(a){if(a&&a.length){a=this._normalize(a);this._suggest(a);this._trigger("open")}else this.close();this.element.removeClass("ui-autocomplete-loading")},close:function(a){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this._trigger("close",a);this.menu.element.hide();this.menu.deactivate()}},_change:function(a){this.previous!==this.element.val()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return typeof b==="string"?{label:b,value:b}:a.extend({label:b.label||b.value,value:b.value||b.label},b)})},_suggest:function(b){var c=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(c,b);this.menu.deactivate();this.menu.refresh();this.menu.element.show().position(a.extend({of:this.element},this.options.position));this._resizeMenu()},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(d,b){var c=this;a.each(b,function(b,a){c._renderItem(d,a)})},_renderItem:function(c,b){return a("<li></li>").data("item.autocomplete",b).append(a("<a></a>").text(b.label)).appendTo(c)},_move:function(a,b){if(!this.menu.element.is(":visible")){this.search(null,b);return}if(this.menu.first()&&/^previous/.test(a)||this.menu.last()&&/^next/.test(a)){this.element.val(this.term);this.menu.deactivate();return}this.menu[a](b)},widget:function(){return this.menu.element}});a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(c,d){var b=new RegExp(a.ui.autocomplete.escapeRegex(d),"i");return a.grep(c,function(a){return b.test(a.label||a.value||a)})}})})(jQuery);(function(a){a.widget("ui.menu",{_create:function(){var b=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(c){if(!a(c.target).closest(".ui-menu-item a").length)return;c.preventDefault();b.select(c)});this.refresh()},refresh:function(){var b=this,c=this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem");c.children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(c){b.activate(c,a(this).parent())}).mouseleave(function(){b.deactivate()})},activate:function(e,b){this.deactivate();if(this.hasScroll()){var a=b.offset().top-this.element.offset().top,d=this.element.attr("scrollTop"),c=this.element.height();if(a<0)this.element.attr("scrollTop",d+a);else a>=c&&this.element.attr("scrollTop",d+a-c+b.height())}this.active=b.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",e,{item:b})},deactivate:function(){if(!this.active)return;this.active.children("a").removeClass("ui-state-hover").removeAttr("id");this._trigger("blur");this.active=null},next:function(a){this.move("next",".ui-menu-item:first",a)},previous:function(a){this.move("prev",".ui-menu-item:last",a)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(d,b,a){if(!this.active){this.activate(a,this.element.children(b));return}var c=this.active[d+"All"](".ui-menu-item").eq(0);if(c.length)this.activate(a,c);else this.activate(a,this.element.children(b))},nextPage:function(c){if(this.hasScroll()){if(!this.active||this.last()){this.activate(c,this.element.children(".ui-menu-item:first"));return}var e=this.active.offset().top,d=this.element.height(),b=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-e-d+a(this).height();return b<10&&b>-10});if(!b.length)b=this.element.children(".ui-menu-item:last");this.activate(c,b)}else this.activate(c,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))},previousPage:function(b){if(this.hasScroll()){if(!this.active||this.first()){this.activate(b,this.element.children(".ui-menu-item:last"));return}var d=this.active.offset().top,c=this.element.height();result=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-d+c-a(this).height();return b<10&&b>-10});if(!result.length)result=this.element.children(".ui-menu-item:first");this.activate(b,result)}else this.activate(b,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element.attr("scrollHeight")},select:function(a){this._trigger("selected",a,{item:this.active})}})})(jQuery)