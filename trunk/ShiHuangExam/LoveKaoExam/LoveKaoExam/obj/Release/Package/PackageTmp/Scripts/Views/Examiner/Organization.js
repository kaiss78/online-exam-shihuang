var ExaminerOrganization={Setup:{initData:function(e,h,g,f,c){var a=this.DataAssembly;a.Post.uHandleType=e;a.Post.设置类型=h;a.Post.试卷内容ID=g;a.Post.ID=f;if(e==1)a.Backup.操作类型="本地修改";else a.Backup.操作类型="引用添加";c=c||[];for(var d=0;d<c.length;d++)c[d].length=="36"&&c[d]!=Global.Guid.empty()&&a.Post.考生ID集合.push(c[d]);var b=this.ElemAssembly;Global.LoadIng.ready(function(){b.Post.及格条件=$("#及格条件");b.Post.考试时长=$("#考试时长");b.Post.考试开始时间=$("#考试开始时间");b.Post.考试结束时间=$("#考试结束时间");b.Post.是否公布考试结果=$("input[type='radio'][name='是否公布考试结果']");b.Other.提交按钮=$("#提交按钮");b.Post.考试开始时间.blur(function(){ExaminerOrganization.Setup.ValidationData.考试开始时间()}).change(function(){ExaminerOrganization.Setup.ValidationData.考试开始时间()}).datetimepicker({showButtonPanel:false})})},ElemAssembly:{Post:{及格条件:0,考试时长:0,考试开始时间:0,考试结束时间:0,是否公布考试结果:0},Other:{提交按钮:0}},DataAssembly:{Post:{uHandleType:0,设置类型:0,ID:null,试卷内容ID:null,及格条件:0,考试时长:0,考试开始时间:null,考试结束时间:null,是否公布考试结果:true,考生ID集合:[]},Backup:{操作类型:""}},CheckBox:{update考生交互总数:function(){var b=ExaminerOrganization.Setup.DataAssembly.Post.考生ID集合||[],a=b.length;$("#考生范围中选择交互总数").text(a);Global.TabSwitch.Text.set(1,"考生范围("+a+")");Global.MsgBox.Hide.all()},update集合:function(c,d){for(var a=ExaminerOrganization.Setup.DataAssembly.Post.考生ID集合||[],b=0;b<a.length;b++)a[b]==c&&a.splice(b,1);d&&a.push(c);this.update考生交互总数()},radioSelect:function(a){this.update集合(a.id,a.checked)},allSelect:function(a){Global.MvcPager.CheckBox.getTR().each(function(){var b=Global.MvcPager.CheckBox.getCheckBox(this)[0].id;ExaminerOrganization.Setup.CheckBox.update集合(b,a)})},defaultSelect:function(){for(var c=ExaminerOrganization.Setup.DataAssembly.Post.考生ID集合||[],b={},a=0;a<c.length;a++)b[c[a]]=true;Global.MvcPager.CheckBox.getTR().each(function(){var a=Global.MvcPager.CheckBox.getCheckBox(this),c=a[0].id;b[c]&&a.attr("checked","checked")});Global.MvcPager.CheckBox.setAll();this.update考生交互总数()}},ValidationData:{及格条件:function(a){var b=/[^0-9]/g;if(b.exec(a.value))a.value=a.value.replace(b,"")},考试时长:function(a){var b=/[^0-9]/g;if(b.exec(a.value))a.value=a.value.replace(/[^0-9]/g,"");this.考试开始时间()},考试开始时间:function(){var c=ExaminerOrganization.Setup,e=c.DataAssembly.Post,b=c.ElemAssembly.Post;if(e.设置类型==1){var f=parseInt(b.考试时长.val().trim()),d=b.考试开始时间.val().trim(),a=d.toDate();a.setMinutes(a.getMinutes()+(f||0));this.考试结束时间(a.toText())}},考试结束时间:function(a){$("#考试结束时间").val(a)}},Handle:{Type:{本地添加:"本地添加",引用添加:"引用添加",本地修改:"本地修改"},name:function(){return ExaminerOrganization.Setup.DataAssembly.Backup.操作类型=="本地修改"?"修改":"创建"},embedBoxyHide:function(){parent&&parent.ExaminerEmbedHandle&&parent.ExaminerEmbedHandle.Organization.Boxy.hide()},embedBoxyBtn:function(a){switch(ExaminerOrganization.Setup.DataAssembly.Backup.操作类型){case"引用添加":case"本地修改":parent&&parent.ExaminerEmbedHandle&&parent.ExaminerEmbedHandle.Organization.Boxy.setCloseVis(a)}},completed:function(){switch(ExaminerOrganization.Setup.DataAssembly.Backup.操作类型){case"引用添加":case"本地修改":parent&&parent.ExaminerEmbedHandle&&parent.ExaminerEmbedHandle.Organization.Update.list({waitType:"正在更新"})}}},Format:{及格条件:function(c){var a=ExaminerOrganization.Setup.ElemAssembly.Post.及格条件,b=a.val().trim(),d=/^[0-9]{1,2}$/;if(b==""){Global.TabSwitch.Trigger.click(0);Global.Object.Tag.onFocus(a);Global.CallBack.false_3(c,"请填写及格条件！",a)}else if(!d.exec(b)){Global.TabSwitch.Trigger.click(0);Global.Object.Tag.onFocus(a);Global.CallBack.false_3(c,"及格条件只允许使用2位数字组合！",a)}else if(parseInt(b)<1||parseInt(b)>99){Global.TabSwitch.Trigger.click(0);Global.Object.Tag.onFocus(a);Global.CallBack.false_3(c,"及格条件范围在0-99之间！",a)}else Global.CallBack.true_1(c,b)},考试时长:function(c){var a=ExaminerOrganization.Setup.ElemAssembly.Post.考试时长,b=a.val().trim(),d=/^[0-9]{1,3}$/;if(b==""){Global.TabSwitch.Trigger.click(0);Global.Object.Tag.onFocus(a);Global.CallBack.false_3(c,"请填写考试时长！",a)}else if(!d.exec(b)){Global.TabSwitch.Trigger.click(0);Global.Object.Tag.onFocus(a);Global.CallBack.false_3(c,"考试时长只允许使用3位数字组合！",a)}else if(parseInt(b)<5||parseInt(b)>300){Global.TabSwitch.Trigger.click(0);Global.Object.Tag.onFocus(a);Global.CallBack.false_3(c,"考试时长范围在5-300分钟之间！",a)}else Global.CallBack.true_1(c,b)},考试开始时间:function(c){var a=ExaminerOrganization.Setup.ElemAssembly.Post.考试开始时间,b=a.val().trim(),d=/^\d{4}(-|\/)\d{1,2}(-|\/)\d{1,2} [0-2]{0,1}\d{1}:[0-5]{0,1}[0-9]{1}$/;if(b==""){Global.TabSwitch.Trigger.click(0);Global.Object.Tag.onFocus(a);Global.CallBack.false_3(c,"请填写考试开始时间！",a)}else if(!d.exec(b)){Global.TabSwitch.Trigger.click(0);Global.Object.Tag.onFocus(a);Global.CallBack.false_3(c,"考试开始时间格式错误！",a)}else Global.CallBack.true_1(c,b)},考试结束时间:function(c){var a=ExaminerOrganization.Setup.ElemAssembly.Post.考试结束时间,b=a.val().trim(),d=/^\d{4}(-|\/)\d{1,2}(-|\/)\d{1,2} [0-2]{0,1}\d{1}:[0-5]{0,1}[0-9]{1}$/;if(b==""){Global.TabSwitch.Trigger.click(0);Global.Object.Tag.onFocus(a);Global.CallBack.false_3(c,"请填写考试结束时间！",a)}else if(!d.exec(b)){Global.TabSwitch.Trigger.click(0);Global.Object.Tag.onFocus(a);Global.CallBack.false_3(c,"考试结束时间格式错误！",a)}else Global.CallBack.true_1(c,b)},是否公布考试结果:function(b){var a=ExaminerOrganization.Setup.ElemAssembly.Post.是否公布考试结果;if(a.eq(0).attr("checked")==false&&a.eq(1).attr("checked")==false){Global.TabSwitch.Trigger.click(0);Global.Object.Tag.onFocus(a.eq(0));Global.CallBack.false_3(b,"请选择是否公布考试结果！",a)}else Global.CallBack.true_1(b,a.eq(0).attr("checked")?true:false)},考生ID集合:function(b){var a=ExaminerOrganization.Setup.DataAssembly.Post.考生ID集合||[];if(a.length==0){Global.TabSwitch.Trigger.click(1);Global.CallBack.false_3(b,"您还没有选择考生范围！",Global.TabSwitch.getTab(1))}else Global.CallBack.true_1(b,a)}},postAjax:function(e){var c="Examiner-Setup-Test",d=Global.Boxy.Topics.Examiner.organization(this.DataAssembly.Post.设置类型,null),b=this.Handle,a=b.name();b.embedBoxyBtn(false);Global.Boxy.wait(c,{newTitle:a,dtHtml:a+d,triggerBtn:ExaminerOrganization.Setup.ElemAssembly.Other.提交按钮});Global.AjaxServer.Post.json("/Organization/SetupUCEditor/",e,function(e){if(e.result)Global.Boxy.success(c,{newTitle:a+"成功",dtHtml:d+"已"+a+"成功.",boxyOptions:{beforeHide:function(){b.embedBoxyHide()},afterHide:function(){b.completed()}}});else{b.embedBoxyBtn(true);Global.Boxy.failure(c,{newTitle:a+"失败",dtHtml:d+a+"失败",newMessage:e.info})}})},submit:function(){var a=ExaminerOrganization.Setup.DataAssembly.Post.设置类型,b=a==0?["及格条件","考试时长","考生ID集合"]:["及格条件","考试时长","考试开始时间","考试结束时间","是否公布考试结果","考生ID集合"];Global.MsgBox.submit(this,b)}}}