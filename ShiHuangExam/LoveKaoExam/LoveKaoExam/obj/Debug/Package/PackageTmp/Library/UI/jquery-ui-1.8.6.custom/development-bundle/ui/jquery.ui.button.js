(function(a){var b,c="ui-button ui-widget ui-state-default ui-corner-all",g="ui-state-hover ui-state-active ",d="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",f=function(b){a(":ui-button",b.target.form).each(function(){var b=a(this).data("button");setTimeout(function(){b.refresh()},1)})},e=function(c){var d=c.name,e=c.form,b=a([]);if(d)if(e)b=a(e).find("[name='"+d+"']");else b=a("[name='"+d+"']",c.ownerDocument).filter(function(){return!this.form});return b};a.widget("ui.button",{options:{disabled:null,text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",f);if(typeof this.options.disabled!=="boolean")this.options.disabled=this.element.attr("disabled");this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var g=this,d=this.options,h=this.type==="checkbox"||this.type==="radio",j="ui-state-hover"+(!h?" ui-state-active":""),i="ui-state-focus";if(d.label===null)d.label=this.buttonElement.html();if(this.element.is(":disabled"))d.disabled=true;this.buttonElement.addClass(c).attr("role","button").bind("mouseenter.button",function(){if(d.disabled)return;a(this).addClass("ui-state-hover");this===b&&a(this).addClass("ui-state-active")}).bind("mouseleave.button",function(){if(d.disabled)return;a(this).removeClass(j)}).bind("focus.button",function(){a(this).addClass(i)}).bind("blur.button",function(){a(this).removeClass(i)});h&&this.element.bind("change.button",function(){g.refresh()});if(this.type==="checkbox")this.buttonElement.bind("click.button",function(){if(d.disabled)return false;a(this).toggleClass("ui-state-active");g.buttonElement.attr("aria-pressed",g.element[0].checked)});else if(this.type==="radio")this.buttonElement.bind("click.button",function(){if(d.disabled)return false;a(this).addClass("ui-state-active");g.buttonElement.attr("aria-pressed",true);var b=g.element[0];e(b).not(b).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed",false)});else{this.buttonElement.bind("mousedown.button",function(){if(d.disabled)return false;a(this).addClass("ui-state-active");b=this;a(document).one("mouseup",function(){b=null})}).bind("mouseup.button",function(){if(d.disabled)return false;a(this).removeClass("ui-state-active")}).bind("keydown.button",function(b){if(d.disabled)return false;(b.keyCode==a.ui.keyCode.SPACE||b.keyCode==a.ui.keyCode.ENTER)&&a(this).addClass("ui-state-active")}).bind("keyup.button",function(){a(this).removeClass("ui-state-active")});this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()})}this._setOption("disabled",d.disabled)},_determineButtonType:function(){if(this.element.is(":checkbox"))this.type="checkbox";else if(this.element.is(":radio"))this.type="radio";else if(this.element.is("input"))this.type="input";else this.type="button";if(this.type==="checkbox"||this.type==="radio"){this.buttonElement=this.element.parents().last().find("label[for="+this.element.attr("id")+"]");this.element.addClass("ui-helper-hidden-accessible");var a=this.element.is(":checked");a&&this.buttonElement.addClass("ui-state-active");this.buttonElement.attr("aria-pressed",a)}else this.buttonElement=this.element},widget:function(){return this.buttonElement},destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass(c+" "+g+" "+d).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());!this.hasTitle&&this.buttonElement.removeAttr("title");a.Widget.prototype.destroy.call(this)},_setOption:function(c,b){a.Widget.prototype._setOption.apply(this,arguments);if(c==="disabled")if(b)this.element.attr("disabled",true);else this.element.removeAttr("disabled");this._resetButton()},refresh:function(){var b=this.element.is(":disabled");b!==this.options.disabled&&this._setOption("disabled",b);if(this.type==="radio")e(this.element[0]).each(function(){if(a(this).is(":checked"))a(this).button("widget").addClass("ui-state-active").attr("aria-pressed",true);else a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed",false)});else if(this.type==="checkbox")if(this.element.is(":checked"))this.buttonElement.addClass("ui-state-active").attr("aria-pressed",true);else this.buttonElement.removeClass("ui-state-active").attr("aria-pressed",false)},_resetButton:function(){if(this.type==="input"){this.options.label&&this.element.val(this.options.label);return}var c=this.buttonElement.removeClass(d),f=a("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(c.empty()).text(),b=this.options.icons,e=b.primary&&b.secondary;if(b.primary||b.secondary){c.addClass("ui-button-text-icon"+(e?"s":b.primary?"-primary":"-secondary"));b.primary&&c.prepend("<span class='ui-button-icon-primary ui-icon "+b.primary+"'></span>");b.secondary&&c.append("<span class='ui-button-icon-secondary ui-icon "+b.secondary+"'></span>");if(!this.options.text){c.addClass(e?"ui-button-icons-only":"ui-button-icon-only").removeClass("ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary");!this.hasTitle&&c.attr("title",f)}}else c.addClass("ui-button-text-only")}});a.widget("ui.buttonset",{_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(b,c){b==="disabled"&&this.buttons.button("option",b,c);a.Widget.prototype._setOption.apply(this,arguments)},refresh:function(){this.buttons=this.element.find(":button, :submit, :reset, :checkbox, :radio, a, :data(button)").filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":visible").filter(":first").addClass("ui-corner-left").end().filter(":last").addClass("ui-corner-right").end().end().end()},destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy");a.Widget.prototype.destroy.call(this)}})})(jQuery)