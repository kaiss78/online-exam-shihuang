$(document).ready(function(){ExamLoadManage.ready()});document.onkeydown=function(){var a=ExamSubTypeManage.subTypeIndex,b=parseInt(ExamSubManage.subIndex),c=b;if(window.event.keyCode==37)if(!ExamSubTypeManage.isInitSubType){if(a==0)return;var a=parseInt(a)-1,d=ExamDataManage.get题型名称(a);ExamSubTypeManage.refurbish(a);ExamSubManage.refurbishSub(a,null);ExamCommonSetManage.viewSubList(a,d)}else ExamCommonSetManage.viewOneSub(a,b-1,c);else if(window.event.keyCode==39)if(!ExamSubTypeManage.isInitSubType){if(a==ExamDataManage.题型Len-1)return;var a=parseInt(a)+1,d=ExamDataManage.get题型名称(a);ExamSubTypeManage.refurbish(a);ExamSubManage.refurbishSub(a,null);ExamCommonSetManage.viewSubList(a,d)}else{c=ExamCommonSetManage.get序号集合(a,b,c);ExamCommonSetManage.viewOneSub(a,b+1,c+2)}};var ExamLoadManage={isNew:false,initLayoutId:0,ready:function(){this.complete()},complete:function(){var a=this.getGuidTeam();this.isNew=a==false?true:false;this.initLayoutId=this.initLayoutId||$("#LayoutID");AjaxExamManage.onlineExam(a)},getGuidTeam:function(){var b=window.location.href,c=b.indexOf("guid="),a;if(c!=-1){a=b.substring(c+5,b.length).split("&")[0];if(a.length==36)return a}return false},getTypeTeam:function(){return $.query.get("type")},login:function(){alert("你还没登陆")}},TestHashTable={data:{},length:0,put:function(b,a){this.data[b]=a;this.length++},"get":function(a){return this.data[a]},remove:function(a){delete this.data[a];this.length--}},ExamCommonSetManage={msgBox:0,interceptString:function(b,a,c){a=a||10;return b.length>a?a==10?b.substring(0,a):!c?b.substring(0,a)+"...":b.substring(0,a)+'...<a href="javascript:void(0)" onclick="ExamCommonSetManage.showMoreMsgBox(this,\''+c+"','"+b+"');\">更多>></a>":b},refreshTest:function(){window.location.reload()},getExamTimeString:function(a){return a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()},getOffset:function(c){var a=$(c),d=a.offset().top,b=a.offset().left;return{top:d,left:b}},getPosition:function(c){var a=$(c),d=a.position().top,b=a.position().left;return{top:d,left:b}},initMoreMsgBox:function(){this.msgBox=this.msgBox||new MsgBox("",{isTipMsg:true,isAutoHide:true})},setMoreMsgBox:function(a,b){this.msgBox.setContent(AjaxExamManage.getSubDetailHtml(a,b))},siteMoreMsgBox:function(b){var a=this.getOffset(b);a.top+=-12;a.left+=60;this.msgBox.moveElem(a);this.msgBox.setIndex(1500)},showMoreMsgBox:function(b,a,c){this.initMoreMsgBox();this.siteMoreMsgBox(b);this.setMoreMsgBox(a,c);this.msgBox.show()},isMakeSub:function(b){for(var c,d,a=0;a<ExamDataManage.get试题长度(b);a++){c=ExamDataManage.getSign不确定(b,a),d=ExamDataManage.getSign暂不做(b,a);if(ExamDataManage.get试题回答(b,a))if(c)ExamDataManage.add试题标记(b,a,"SignNav3 SignNav1");else if(d)ExamDataManage.add试题标记(b,a,"SignNav3 SignNav2");else ExamDataManage.add试题标记(b,a,"SignNav3");else if(c)ExamDataManage.add试题标记(b,a,"SignNav1");else if(d)ExamDataManage.add试题标记(b,a,"SignNav2");else ExamDataManage.add试题标记(b,a,"")}},get序号集合:function(d,e,b){var a="";if(d>0){for(var c=0;c<d;c++){a+=ExamDataManage.get试题长度(c);a=parseInt(a)}b=a+e}else b=e;return b},viewOneSub:function(a,b,c){c=parseInt(c);if(b==-1)if(a==0)return;else{a=parseInt(a)-1;ExamSubTypeManage.refurbish(a);var f=ExamDataManage.get试题长度(a);b=f-1;c=this.get序号集合(a,f,c)}else if(b==ExamDataManage.get试题长度(a))if(a!=ExamDataManage.题型Len-1){a=parseInt(a)+1;ExamSubTypeManage.refurbish(a);b=0}else return;else{c=this.get序号集合(a,parseInt(b)+1,c);ExamSubTypeManage.refurbish(a)}var d=TestHashTable.get(ExamDataManage.getSubID(a,b)),e="",g=SetExamTest.isCommon;if(g&&!SetExamTest._是否继续考试)ViewLibSubject.getItemHtml(1,d,c,function(c){if(SetExamTest.isAdmin)if(AjaxExamManage._exmaType==3){var g=d.该题考试回答?d.该题考试回答.该题的得分:"0",f=d.子小题集合;if(f)e+=c;else e+=c.slice(0,c.length-6)+ExamCommonSetManage.getRatingHtml(a,b,null,g);ViewSubject.viewBoxCsh.children().html(e)}else ViewSubject.viewBoxCsh.children().html(c);else ViewSubject.viewBoxCsh.children().html(c)},false,false,false);else ViewLibSubject.getItemHtml(3,d,c,function(a){ViewSubject.viewBoxCsh.children().html(a)},false,false,false);ViewSubject.viewBoxCsh.children().append(ViewSubject.getSignSubInfo(a,b,c));SetExamTest.isCommon&&ExamCommonSetManage.isMakeSub(a);ExamSubManage.refurbishSub(a,b);ExamSubManage.subIndex=b},viewSubList:function(b,h){if(h!=""){var i=ExamDataManage.get说明(b);ViewSubject.showViewSubBox(h,i)}var d="",f=0,e="",a;if(b>0){for(var g=0;g<b;g++){e+=ExamDataManage.get试题长度(g);e=parseInt(e)}f=e}for(var c=0;c<ExamDataManage.get试题长度(b);c++){a=TestHashTable.get(ExamDataManage.getSubID(b,c));if(SetExamTest.isCommon&&!SetExamTest._是否继续考试){a.该题题型索引=b;a.该题子小题索引=c;a.是否考试创建者=SetExamTest.isAdmin;a.是否评分=AjaxExamManage._exmaType;ViewLibSubject.getItemHtml(1,a,f+c+1,function(e){if(SetExamTest.isAdmin)if(AjaxExamManage._exmaType==3){var g=a.该题考试回答?a.该题考试回答.该题的得分:"0",f=a.子小题集合;if(f)d+=e;else d+=e.slice(0,e.length-6)+ExamCommonSetManage.getRatingHtml(b,c,null,g)}else d+=e;else d+=e},false,false,false)}else ViewLibSubject.getItemHtml(3,a,f+c+1,function(a){d+=a},false,false,false)}SetExamTest.isCommon&&ExamCommonSetManage.isMakeSub(b);ExamSubManage.refurbishSub(b,null);ViewSubject.viewBoxCsh.show();ViewSubject.viewBoxCsh.children().html(d)},getRatingHtml:function(b,c,a,d){return'<div class="stViewFoot"><span class="z333">考官判分：</span><span class="z333"><input type="text" maxlength="4" value=\''+d+'\'    onfocus="ExamCommonSetManage.onFous(this)" onkeyup="ExamCommonSetManage.onkeyup(this)"  onblur="ExamCommonSetManage.onblurRating(this,\''+b+"','"+c+"',"+a+');" style="width:100px" /></span></div></div>'},onFous:function(b){var a=$(b);a.select()},onblurRating:function(f,c,d,b){var a=$(f),e=a.val();if(b!=null)ExamDataManage.addSonSubValue(a,c,d,b,e);else ExamDataManage.addSubValue(a,c,d,e)},onkeyup:function(a){if(event.keyCode==9)return;a.value=a.value.replace(/[^\d.]/g,"");a.value=a.value.replace(/^\./g,"");a.value=a.value.replace(/\.{2,}/g,".");a.value=a.value.replace(".","$#$").replace(/\./g,"").replace("$#$",".")}},ExamDataManage={题型Len:0,试题Len:0,公共信息:{ID:"",会员ID:"00000000-0000-0000-0000-000000000000",相关ID:"00000000-0000-0000-0000-000000000000",试卷内容ID:"",是否公布考试结果:true,类型:1,批改状态类型:1,答题开始时间:"",答题结束时间:"",客观题总得分:0,主观题总得分:0,是否是已提交的试卷:true,试卷考试类别:0,考试用时:"",是否已批改:false},content:{ID:"",试卷外部信息ID:"",名称:"",说明:"",考试时长:"",总分:"",提交人ID:"",提交备注:"",及格条件:"",试卷中大题集合:[]},getRandom:function(){return((1+Math.random())*65536|0).toString(16).substring(1)},getGuid:function(){return this.getRandom()+this.getRandom()+"-"+this.getRandom()+"-"+this.getRandom()+"-"+this.getRandom()+"-"+this.getRandom()+this.getRandom()+this.getRandom()},textToJson:function(a){return JSON.textToJson(a)},jsonToText:function(a){return JSON.jsonToText(a)},addCommonID:function(a){this.公共信息.ID=a},getEditSubLen:function(){for(var b=0,a=0;a<this.题型Len;a++)for(var c=0;c<this.get试题长度(a);c++)b++;return b},dataSignSubType:{题型集合:[]},getExamJson:function(a,d,b){if(b!=null){a=this.textToJson(a);a.考生ID=GlobalManage.get_cookie_uid();if(b==1)a.批改状态类型=0;else a.批改状态类型=1}else a=a;var c={ID:a.ID||a.公共信息.ID,相关ID:d,考生ID:a.考生ID||a.公共信息.考生ID,类型:b!=null?a.类型:0,试卷内容ID:a.试卷内容ID||a.公共信息.试卷内容ID,答题开始时间:a.答题开始时间||a.公共信息.答题开始时间,答题结束时间:a.答题结束时间||a.公共信息.答题开始时间,是否是已提交的试卷:b!=null?a.是否是已提交的试卷:a.公共信息.是否是已提交的试卷,批改状态类型:b!=null?a.批改状态类型:a.公共信息.批改状态类型,考试设置:{设置人ID:"00000000-0000-0000-0000-000000000000",试卷内容:a.试卷内容}};c=this.jsonToText(c);return c},dataSignSub:'{"试题集合":[]}',get题型:function(a){return this.content.试卷中大题集合[a]},get说明:function(a){return this.get题型(a).说明},get试题集合:function(a){return this.get题型(a).试卷大题中试题集合},get试题长度:function(a){return this.get试题集合(a).length},getSubID:function(a,b){return this.get题型(a).试卷大题中试题集合[b].试题内容ID},get题型名称:function(a){return this.get题型(a).名称},get试题分值:function(a,b){return this.get题型(a).试卷大题中试题集合[b].每小题分值},get分值By题型:function(d){for(var b=0,b=parseInt(b),a,c=0;c<this.get试题长度(d);c++){a=this.get题型(d).试卷大题中试题集合[c].每小题分值;a=parseInt(a);b+=a}return b},getSubJson:function(c,b){return ExamDataManage.content.试卷中大题集合[c].试卷大题中试题集合[b]},getSonSub:function(b,a){var c=this.getSubJson(b,a);return c.子小题集合},getSonSubLen:function(b,a){return this.getSonSub(b,a).length},add试题标记:function(b,c,d){var a=this.get题型(b).试卷大题中试题集合[c];a.Sub标示=d},del试题标记:function(b,c){var a=this.get题型(b).试卷大题中试题集合[c];a.Sub标示=""},addSign不确定:function(b,c){var a=this.get题型(b).试卷大题中试题集合[c];a.sub不确定=true},delSign不确定:function(b,c){var a=this.get题型(b).试卷大题中试题集合[c];a.sub不确定=false},getSign不确定:function(b,c){var a=this.get题型(b).试卷大题中试题集合[c];return a.sub不确定},addSign暂不做:function(b,c){var a=this.get题型(b).试卷大题中试题集合[c];a.sub暂不做=true},delSign暂不做:function(b,c){var a=this.get题型(b).试卷大题中试题集合[c];a.sub暂不做=false},getSign暂不做:function(b,c){var a=this.get题型(b).试卷大题中试题集合[c];return a.sub暂不做},get试题标记:function(b,c){var a=this.get题型(b).试卷大题中试题集合[c];return a.Sub标示},get试题得分:function(a,b){var d=a.试题内容Json,e=d.content,c=e.小题型Enum;switch(c){case"11":case"12":case"13":case"14":case"15":case"20":case"30":case"8011":this["getT"+c](a.ID,a.试题内容ID,a.该题考试回答,b);break;case"60":case"61":case"62":case"63":case"64":case"65":case"66":case"67":case"68":case"69":this.getT60(a.ID,a.试题内容ID,a.该题考试回答,b);break;case"40":case"41":case"42":case"43":case"44":case"45":case"46":case"47":case"80":this.getT40(a.子小题集合||[],b)}},get试题回答:function(c,d){var b=this.get题型(c).试卷大题中试题集合[d],a;MakeSubjectManage.getFulFill(b,function(b){a=b.result});return a},get试题回答解析:function(c,d){var b=this.get题型(c).试卷大题中试题集合[d],a;MakeSubjectManage1.get考试回答(b,function(b){a=b.该题考试回答});return a},get题型:function(a){return this.content.试卷中大题集合[a]},get试题:function(a,b){return this.get题型(a).试卷大题中试题集合[b]},getOneSubID:function(a,c,b){this.get题型(a).试卷大题中试题集合[c].每小题分值=b},getSon试题:function(a,b){return this.get题型(a).试卷大题中试题集合[b].子小题集合[0]},addSubValue:function(b,f,g,a){var c=this.get试题(f,g),d=c.该题考试回答,e=parseFloat(c.每小题分值);a=parseFloat(a);if(a>e){alert("判分不能超过该题分值");b.focus();b.val(a);return}if(d){d.该题的得分=a;this.getAll分值()}else{if(a==0){b.val("0");return}alert("考生没有回答判分应该为0");b.val("0");return}},addSonSubValue:function(b,e,f,h,a){var c=this.getSon试题(e,f,h),d=c.该题考试回答,g=parseFloat(c.每小题分值);a=parseFloat(a);if(a>g){alert("判分不能超过该题分值");b.focus();b.val(a);return}if(d){d.该题的得分=a;this.getAll分值()}else{if(a==0){b.val("0");return}alert("考生没有回答判分应该为0");b.val("0");return}},add添加子小题分值:function(a,c,b,d){this.get题型(a).试卷大题中试题集合[c].子小题集合[d].每小题分值=b},isObjective:function(a){switch(a){case"11":case"12":case"13":case"14":case"15":case"20":case"30":case"8011":return true;break;case"60":case"61":case"62":case"63":case"64":case"65":case"66":case"67":case"68":case"69":return false}},getAll分值:function(){for(var m=0,h,d,g,c,e,i="",a=0,b=0,f,j=0;j<this.题型Len;j++)for(var l=0;l<this.get试题长度(j);l++){h=this.get题型(j).试卷大题中试题集合[l];e=h.子小题集合;if(e)for(var k=0;k<e.length;k++){i=e[k].试题内容Json.content.小题型Enum;g=this.isObjective(i);d=e[k].该题考试回答;c=d?d.该题的得分:0;if(g)b+=c;else a+=c}else{i=h.试题内容Json.content.小题型Enum;g=this.isObjective(i);d=h.该题考试回答;c=d?d.该题的得分:0;if(g)b+=c;else a+=c}}b=Math.round(b*10)/10;a=Math.round(a*10)/10;f=f||$("#objectiveID");f.prev().children().html(b);f.children().html(a);f.next().children().html(b+a)}},ExamDivSetBox={setBox:0,subDivId:0,getSubTypeNameAndCount:function(b,a){return'<div class="SubTypeAndCount"><span class="SuTypeName">'+b+'</span>总分<span class="Count">('+ExamCommonSetManage.interceptString(a,6,null)+")</span></div>"},getSignSubBg:function(){return'<div class="SignSubBgBox"><div  class="SignSubBgDiv"><div class="SignSubBgDivFont"></div>不确定</div><div class="SignSubBgDiv"><div class="SignSubBgDivFont" style="background-color:#e1f4d8;"></div>暂不做</div><div class="SignSubBgDiv"><div class="SignSubBgDivFont" style="background-color:#b8fcf2;"></div>已做</div><div class="SignSubBgDiv"><div class="SignSubBgDivFont" style="background-color:#ee8c00;"></div>选中</div>  </div>'},getSignSubBgFX:function(){return'<div class="SignSubBgBox"><div  class="SignSubBgDiv SignSubBgDiv1"><div class="SignSubBgDivFont" style="background-color:#FFFFCC;"></div>未批改</div><div class="SignSubBgDiv SignSubBgDiv1"><div class="SignSubBgDivFont" style="background-color:#e1f4d8;"></div>没做</div><div  class="SignSubBgDiv SignSubBgDiv1"><div class="SignSubBgDivFont"></div>错误</div><div class="SignSubBgDiv SignSubBgDiv1"><div class="SignSubBgDivFont" style="background-color:#b8fcf2;"></div>正确</div><div class="SignSubBgDiv SignSubBgDiv1"><div class="SignSubBgDivFont" style="background-color:#ee8c00;"></div>选中</div>  </div>'},getSubTitleAndValues:function(){return'<div class="SubTitleAndValues"><span class="SubTitle">题干</span><span class="Values">分值</span></diiv>'},ShowSubInforBox:function(c,b){var a="";if(SetExamTest.isCommon&&!SetExamTest.isCommon)a=this.getSignSubBgFX();else a=this.getSignSubBg();this.setBox=this.setBox||$("#AddSubBox");ExamDivSetBox.subDivId=ExamDivSetBox.subDivId||$("#SubContentId");_addSubHtml=a+this.getSubTypeNameAndCount(c,b)+this.getSubTitleAndValues();this.setBox.html(_addSubHtml).show();ExamDivSetBox.subDivId.show()}},ExamSubTypeManage={isInitSubType:false,subTypeIndex:0,_序号:0,subTypeName:0,subjectViewId:0,isInit:false,isInitFindSub:false,intDivBox:function(){this.subTypeName=this.subTypeName||$("#AddSubTypeBox")},getOneSubType:function(b,a,c){var d=c?"navCur":"";if(c)this.subTypeIndex=b;_strSubTypeHtml='<div class="navSubTypeBox  navNor '+d+'"><span class="SubjectTypeSpan" onclick="ExamSubTypeManage.OnclikSubjectTypeSpan(this,\''+a+"','"+b+'\');"onmousemove="ExamSubTypeManage.OnmousemoveSubTypeSpan(this);"   onmouseout="ExamSubTypeManage.OnmouseoutSubTypeSpan(this);" title="双击该题型可以重命名" >'+(a.length>8?a.substring(0,8)+"...":a)+"("+ExamDataManage.get试题长度(b)+")</span></div>";return _strSubTypeHtml},refurbish:function(e){var b="",d,c=ExamDataManage.content.试卷中大题集合;_len=c.length;for(var a=0;a<_len;a++){d=a==e?true:false;b+=this.getOneSubType(a,c[a].名称,d)}this.subTypeName.html(b)},initSubType:function(){this.intDivBox();var g=ExamDataManage.content,b=g.试卷中大题集合,f=b.length;ExamDataManage.题型Len=f;this.setSubType(b);var d=ExamDataManage.get题型名称(0);ExamDataManage.试题Len=ExamDataManage.getEditSubLen();ExamDivSetBox.ShowSubInforBox(d,ExamDataManage.get分值By题型(0));for(var a=0;a<f;a++)for(var c=0;c<ExamDataManage.get试题长度(a);c++){var e=b[a].试卷大题中试题集合[c];TestHashTable.put(e.试题内容ID,e)}ExamSubManage.refurbishSub(0,null);ExamCommonSetManage.viewSubList(0,d);this.isInit=true},setSubType:function(c){this.subTypeName.html("");for(var b=c.length,a=0;a<b;a++)this.refurbish(b-a-1)},showDivBg:function(a){$(a).parent().addClass("navNor1")},removeDivBg:function(a){$(a).parent().removeClass("navNor1")},onclikDivShowBg:function(c,b,a){this.isInitSubType=false;this.subTypeName.children("div").removeClass("navCur");$(c).parent("div").addClass("navCur");ExamDivSetBox.setBox.children("div:eq(1)").children("span:eq(0)").text(b);this.subTypeIndex=a;SetExamTest.isCommon&&ExamCommonSetManage.isMakeSub(a);ExamSubManage.refurbishSub(a,null);ExamDivSetBox.ShowSubInforBox(ExamDataManage.get题型名称(a),ExamDataManage.get分值By题型(a));ExamCommonSetManage.viewSubList(a,b)},OnmousemoveSubTypeSpan:function(a){var b=$(a);this.showDivBg(a);b.next("samp").children("a").show()},OnmouseoutSubTypeSpan:function(a){var b=$(a);this.removeDivBg(a);b.next("samp").children("a").hide()},OnclikSubjectTypeSpan:function(c,b,a){this.onclikDivShowBg(c,b,a)}},MakeSubjectManage1={getT40:function(c,d){for(var b=[],a=0;a<c.length;a++)b.push({该题考试回答:c[a].该题考试回答});d({子小题集合:b})},get考试回答:function(a,b){var c=a.试题内容Json,d=c.content;switch(d.小题型Enum){case"11":case"12":case"13":case"14":case"15":case"20":case"30":case"8011":case"60":case"61":case"62":case"63":case"64":case"65":case"66":case"67":case"68":case"69":b({该题考试回答:a.该题考试回答});break;case"40":case"41":case"42":case"43":case"44":case"45":case"46":case"47":case"80":this.getT40(a.子小题集合||[],b)}}},ExamSubManage={isSure:false,isResponse:false,subIndex:0,subNumber:0,signBg:0,getSubFontSpan:function(b,c,d,a){this.subIndex=b;this.subNumber=a;return'<span class="SubjectTypeSpan  SubjectSpan"onclick="ExamSubManage.OnclikSubjectSpan(this,\''+ExamSubTypeManage.subTypeIndex+"','"+b+"','"+a+'\');"onmousemove="ExamSubTypeManage.OnmousemoveSubTypeSpan(this);"   onmouseout="ExamSubTypeManage.OnmouseoutSubTypeSpan(this);"><samp class="subTaxis" title="第'+a+'题">'+a+".</samp>"+ExamCommonSetManage.interceptString(c,12-(""+a).length,null)+'<span class="subValues">'+d+"分</span></span>"},getOneSubject:function(a,f,h,g,j){var i=h?"navCur":"",e=ExamSubTypeManage.subTypeIndex,c=0,b="";a=parseInt(a);if(e>0){for(var d=0;d<e;d++){b+=ExamDataManage.get试题长度(d);b=parseInt(b)}c=b+a+1}else c=a+1;_strSubHtml='<div class="navSubTypeBox navSubBox navNor '+i+" "+j+'">'+this.getSubFontSpan(a,f,g,c)+"</div>";return _strSubHtml},refurbishSub:function(c,k){for(var h="",i,e,b,j,g,d,f,a=0;a<ExamDataManage.get试题长度(c);a++){j=a==k?true:false;if(SetExamTest.isCommon&&!SetExamTest._是否继续考试){d=ExamDataManage.get试题回答解析(c,a);if(d)if(d.该题的得分==0)b="SignNav4";else if(d.该题的得分==null)b="SignNav5";else b="SignNav6";else b="SignNav7"}else{e=ExamDataManage.get试题标记(c,a);b=e?e:""}i=ExamDataManage.getSubID(c,a);f=TestHashTable.get(i).试题内容Json.content.题干文本;g=ExamDataManage.get试题分值(c,a);h+=this.getOneSubject(a,f,j,g,b)}ExamDivSetBox.subDivId.html(h)},onclikDivShowSubBg:function(e,b,d,a){var c=parseInt(d);a=parseInt(a);ExamSubTypeManage.isInitSubType=true;ExamDivSetBox.subDivId.children("div").removeClass("navCur");$(e).parent("div").addClass("navCur");ExamCommonSetManage.viewOneSub(b,c,a)},OnclikSubjectSpan:function(c,a,b,d){this.onclikDivShowSubBg(c,a,b,d)},swichNoSure:function(f,b){var c=$(f),e,d,a=ExamSubTypeManage.subTypeIndex;e=ExamDataManage.getSign不确定(a,b);d=ExamDataManage.getSign暂不做(a,b);if(!e){c.addClass("SingNoSure1");c.parent().parent().addClass("SignNav1");ExamDataManage.addSign不确定(a,b);if(d){c.parent().parent().removeClass("SignNav2");c.next().removeClass("SignResponse1");ExamDataManage.delSign暂不做(a,b)}ExamDataManage.add试题标记(a,b,"SignNav1");this.refurbishSub(a,b)}else{c.removeClass("SingNoSure1");c.parent().parent().removeClass("SignNav1");ExamDataManage.del试题标记(a,b);ExamDataManage.delSign不确定(a,b);this.refurbishSub(a,b)}},swichResponse:function(f,b){var c=$(f),g,d,e,a=ExamSubTypeManage.subTypeIndex;d=ExamDataManage.getSign暂不做(a,b);e=ExamDataManage.getSign不确定(a,b);if(!d){c.addClass("SignResponse1");c.parent().parent().addClass("SignNav2");ExamDataManage.addSign暂不做(a,b);if(e){c.parent().parent().removeClass("SignNav1");c.prev().removeClass("SingNoSure1");ExamDataManage.delSign不确定(a,b)}ExamDataManage.add试题标记(a,b,"SignNav2");this.refurbishSub(a,b)}else{c.removeClass("SignResponse1");c.parent().parent().removeClass("SignNav2");ExamDataManage.del试题标记(a,b);ExamDataManage.delSign暂不做(a,b);this.refurbishSub(a,b)}}},ViewSubject={viewBox:0,viewBoxCsh:0,题型Index:0,gradeDiv:0,试题Index:0,getViewSubHead:function(b,a){return'<div class="E_E_L_I_C_R_C_Title"><div class="E_E_L_I_C_R_C_T_SubType">'+b+'</div><div class="E_E_L_I_C_R_C_T_Explain">说明:（<label title="'+a+'" style="color:#369;">'+ExamCommonSetManage.interceptString(a,60)+"</label>）</div></div>"},getViewSubContent:function(){return'<div class="E_E_L_I_C_R_C_Content"><div class="E_E_L_I_C_R_C_Font"></div></div>'},getSignSubInfo:function(d,a,h){a=parseInt(a);var c=ExamDataManage.get试题标记(d,a),g,b,e,i=SetExamTest.isCommon,f;if(i&&!SetExamTest._是否继续考试)f="none";else f="block";if(c=="SignNav3 SignNav1"||c=="SignNav1"){b="SignNav1";g="SingNoSure1"}else if(c=="SignNav3 SignNav2"||c=="SignNav2"){b="SignNav2";e="SignResponse1"}else{b="";g="";e=""}return'<div class="SignInfo '+b+'">                        <div class="UpAndDownSub ">                            <a href="javascript:void(0)" class="UpSub" title="快捷键←" onclick="ExamCommonSetManage.viewOneSub(\''+d+"', '"+(a-1)+"','"+(h-1)+'\')"><span>←</span>上一题</a>                            <a href="javascript:void(0)" title="快捷键→" onclick="ExamCommonSetManage.viewOneSub(\''+d+"', '"+(a+1)+"','"+(h+1)+'\')">下一题<span>→</span></a>                                                </div>                        <div class="SignIco" style="display:'+f+'">                             <span class="SignFont">标示：</span>                            <a href="javascript:void(0);" title="答案不确定,标记一下！" class="SignNoSure '+g+'"  onclick="ExamSubManage.swichNoSure(this,\''+a+'\');" ></a>                            <a href="javascript:void(0);" class="SignResponse '+e+'" title="暂不作答,标记一下！" onclick="ExamSubManage.swichResponse(this,\''+a+"');\"  ></a>                       </div>                    </div>"},showViewSubBox:function(c,b){this.viewBox=this.viewBox||$("#subViewID");var a='<div class="E_E_L_I_C_R_Content">'+this.getViewSubHead(c,b)+this.getViewSubContent();"</div>";this.viewBox.html(a);this.viewBoxCsh=this.viewBox.children().children("div:eq(1)")}},SetExamTest={isCommon:true,isInit:false,_批改状态:0,_是否继续考试:false,objectCount:0,subjectCount:0,isAdmin:false,titleID:0,isShowChooseBox:false,rartingSubmitID:0,getPartingSubmit:function(){return' <div class="C_E_L_I_H_T_Refer">                        <a class="C_E_L_I_H_T_R_Left" title="提 交" href="javascript:void(0)" onclick="AjaxExamManage.submitRarting(\'2\');">                            提 交</a><a class="C_E_L_I_H_T_R_Right" title="选择保存类型" href="javascript:void(0)" onclick="SetExamTest.showChooseRefer(this);"> </a>                    </div>                    <div class="SaveType" id="SaveTypeID">                        <a href="javascript:void(0)" onclick="AjaxExamManage.submitRarting(\'2\');" style="word-spacing: 7px;">                            提 交</a><a href="javascript:void(0)" onclick="AjaxExamManage.submitRarting(\'1\');">保存批改</a>                    </div>'},getObjectAnadSubject:function(){return" <span id='objectiveID'>客观题总分：<label>"+this.objectCount+"</label>分</span><span>主观题总得分：<label>"+this.subjectCount+"</label>分</span>"},getSubjectiveValue:function(b,a){var c=b+a;return" <span id='objectiveID'>主观题得分：<label>"+a+"</label>分</span><span>总得分：<label>"+c+"</label>分</span>"},getObjectiveHtml:function(b,d,e){var a="",c="";if(LKConfig.URLAssembly.Test.Server.get("isGetExamJson")){a=this.getSubjectiveValue(b,d);c=this.getObjectAnadSubject()}return""+c+"<span>客观题得分：<label>"+b+"</label>分</span>"+a+" <span>考试用时：<label>"+e+"</label></span> "},showChooseRefer:function(c){var a=$(c),b=a.parent().next();if(!this.isShowChooseBox){a.addClass("C_E_L_I_H_T_R_Right1");b.show();this.isShowChooseBox=true}else{a.removeClass("C_E_L_I_H_T_R_Right1");b.hide();this.isShowChooseBox=false}},closeJson:function(d){var b,a;this.titleID=$("#ExamTitleID");ExamDataManage.content=d.试卷内容;ExamDataManage.公共信息=d.公共信息;ExamDataManage.dataSignSubType.题型集合=d.试卷内容.试卷中大题集合;d=null;b=ExamDataManage.content.考试时长;this.titleID.text(ExamDataManage.content.名称);this.titleID.next().children("span:eq(0)").children().text(b);this.titleID.next().children("span:eq(1)").children().text(ExamDataManage.content.总分);this.isCommon=ExamDataManage.公共信息.是否公布考试结果;this._批改状态=ExamDataManage.公共信息.批改状态类型;if(this.isCommon){this.isCommon=ExamDataManage.公共信息.是否公布考试结果;this.isAdmin=AjaxExamManage.userID==ExamDataManage.公共信息.设置人ID?true:false;if(this.isAdmin){this.isCommon=true;this.objectCount=ExamDataManage.content.客观题总分;this.subjectCount=ExamDataManage.content.主观题总分}if(this.isCommon){var c="",f=ExamDataManage.公共信息.客观题总得分,e=ExamDataManage.公共信息.主观题总得分,h=ExamDataManage.公共信息.客观题,g=ExamDataManage.公共信息.考试用时;if(AjaxExamManage._exmaType==3&&this.isAdmin){this.rartingSubmitID=this.rartingSubmitID||$("#RatingHeaderID");this.rartingSubmitID.append(this.getPartingSubmit());c=this.getObjectiveHtml(f,e,g);this.titleID.next().append(c)}else if(AjaxExamManage._exmaType==2){c=this.getObjectiveHtml(f,e,g);this.titleID.next().append(c)}else{this._是否继续考试=true;ExamTimeManage.initExamTime(b);setTimeout(ExamTimeManage.openSaveExam,1e3);a=new Date;a=ExamCommonSetManage.getExamTimeString(a);ExamDataManage.公共信息.答题开始时间=a}}}else{ExamTimeManage.initExamTime(b);setTimeout(ExamTimeManage.openSaveExam,1e3);a=new Date;a=ExamCommonSetManage.getExamTimeString(a);ExamDataManage.公共信息.答题开始时间=a}ExamSubTypeManage.initSubType()}},BoxyMsgInfo={referExamBox:0,referDiv:0,showNoMakeMsg:function(a){Boxy.confirm('<div class="ExamMsgBox"><div class="ExamMsgHeader"></div><div class="ExamMsgFooter">以下题型中的试题还没有做,你是否继续提交?</div></div>'+a,function(){AjaxExamManage.isSubmit=true;AjaxExamManage.isSubmit&&AjaxExamManage.submitExam()},{title:"提醒",modal:true})},InitReferExam:function(){this.referExamBox=this.referExamBox||new Boxy('<div class="referBox" id="referBoxId"></div>',{title:"提交考卷",modal:true,show:0,closeText:"关闭",afterHide:function(){AjaxExamManage.isRefersh&&ExamCommonSetManage.refreshTest()}});this.referDiv=this.referDiv||$("#referBoxId")},showReferBox:function(){this.InitReferExam();this.referExamBox.show()},hideReferBox:function(){this.referExamBox.hide()}},MaskDivManage={_subMarkId:0,showSubmitExamDiv:function(){this._saveLoadingId=this._saveLoadingId||$("#loadingID");var b=this._saveLoadingId.parents().outerWidth(true),a=this._saveLoadingId.parents().outerHeight(true);this._saveLoadingId.css("display","block");this._saveLoadingId.width(b);this._saveLoadingId.height(a)},hideSubmitExamDiv:function(){this._saveLoadingId.css("display","none")},getLoadingHtml:function(){return'<div class="E_E_L_Loading" align="center"">           <div class="E_E_L_LoadingIco"></div>           <div class="E_E_L_LoadingFont" style="margin-top:-130px; font-size:14px;"> Loading...</div>        </div>'}},AjaxExamManage={isSubmit:false,_exmaType:1,textJsonData:0,isRefersh:false,userID:0,onlineExam:function(c){ExamLoadManage.initLayoutId.parent().append(MaskDivManage.getLoadingHtml());var a=ExamLoadManage.getTypeTeam(),b;this._exmaType=a;if(a==0||a==1)b="GetExam";else if(a==2||a==3){var d=GlobalManage.get_cookie_utype();switch(d){case"0":b="GetStuMadeExam";break;case"1":b="GetTeaMadeExam";break;case"2":AjaxExamManage.setReferBox("getFail","unFinish","得到分析试卷,请重新连接")}}else{AjaxExamManage.setReferBox("getFail","unFinish","进行考试失败,请重新连接");return}this.userID=GlobalManage.get_cookie_uid();$.ajax({type:"POST",url:LKConfig.URLAssembly.Test.Server.get(b),data:{action:b,type:a,guid:c},dataType:"json",success:function(a){if(a.result){ExamLoadManage.initLayoutId.show();ExamLoadManage.initLayoutId.next().html("");if(typeof a.info=="string")a.info=eval("("+a.info+")");SetExamTest.closeJson(a.info)}else AjaxExamManage.setReferBox("getFail","unFinish",a.info)},error:function(c,a){AjaxExamManage.setReferBox("getFail","error",a)}})},getSubDetailHtml:function(b,a){return'<div class="ExamMsgContent moreMsg"><div class="ExamMsgSubType moreMsgSubType">'+b+':</div><div class="ExamMsgSub moreMsgSub">'+a+"</div></div>"},getNoMakeSubHtml:function(a,b){return'<div class="ExamMsgContent"><div class="ExamMsgSubType">'+a+':</div><div class="ExamMsgSub">'+ExamCommonSetManage.interceptString(b,38,a)+"</div></div>"},getReferHead:function(a){switch(a){case"success":return"提交考卷已保存成功，你可以继续执行以下操作:";break;case"fail":return"提交考卷失败，你可以检查一下失败信息:";break;case"error":return"提交考卷失败，你可以检查一下错误信息:";break;case"getFail":return"获取考卷失败，你可以检查一下失败信息:";break;default:return""}},getReferContent:function(b,a){switch(b){case"checkWait":return"";break;case"unFinish":return a;break;case"referLink":return a}},getIcoFont:function(a){return'<div class="refer_I_Ico"></div><div class="refer_I_font">'+a+"</a></div>"},setReferBox:function(c,b,d){var a='<div class="referHeader">'+this.getReferHead(c)+'</div><div class="referInfor">'+this.getReferContent(b,d)+"</div>";BoxyMsgInfo.showReferBox();BoxyMsgInfo.referDiv.html(a)},getLink:function(c,a){var b='<a class="linkFont" href="'+a+'" >'+c+"</a>";return this.getIcoFont(b)},getExamRecord:function(c,b,a){var d=LKConfig.URLAssembly.Test.Server.get("isGetExamJson");return!d?this.getLink("查看考试结果","../Exam/EditExam.aspx?guid="+c+"&type=2")+this.getLink("再做一遍",""+LKConfig.URLAssembly.Test.Page.get("OnlineExam")+"?guid="+b+"&type="+a+""):a==0?this.getLink("查看答卷","/Exam/OnlineExam?guid="+c+"&type=2")+this.getLink("查看练习纪录","/Exam/LogPractice?DDStaticValItem=1")+this.getLink("再做一遍",""+LKConfig.URLAssembly.Test.Page.get("OnlineExam")+"?guid="+b+"&type="+a+""):this.getLink("查看考试纪录","/Exam/LogExam?DDStaticValItem=1")},submitExamReferHtml:function(a,b){var c=this._exmaType;return this.getExamRecord(b,a,c)+this.getLink("返回首页","/")},submitPartingReferHtml:function(b,a){return this.getLink("继续批改","/Test/Mark?guid="+a+"&type=3")+this.getLink("查看分析列表","/Analysis/ExamResult?TestID="+b+"&Duration=10")+this.getLink("返回首页","/")},submitExam:function(){var d,b,e,c,a,g;if(!this.isSubmit){b=new Date;b=ExamCommonSetManage.getExamTimeString(b);ExamDataManage.公共信息.答题结束时间=b;ExamDataManage.公共信息.是否是已提交的试卷=true;ExamDataManage.公共信息.是否已批改=true;ExamDataManage.公共信息.会员ID="00000000-0000-0000-0000-000000000000";ExamDataManage.公共信息.试卷内容ID=ExamDataManage.content.ID;ExamDataManage.addCommonID(ExamDataManage.getGuid());ExamTimeManage.jsonData.公共信息=ExamDataManage.公共信息;ExamTimeManage.jsonData.试卷内容=ExamDataManage.content;MakeSubjectManage.getOneTest(ExamTimeManage.jsonData,function(b){if(b.result==0){AjaxExamManage.textJsonData=b.text;AjaxExamManage.isSubmit=true}else if(b.result==1){AjaxExamManage.textJsonData=b.text;d=b.msgList;g="";for(var f=0;f<d.length;f++){a="";e=d[f].试题列表;for(var h=0;h<e.length;h++){c=e[h].试题的子小题集合;if(c)for(var i=0;i<c.length;i++)a+="["+c[i]+"],";else a+="["+e[h].试题序号+"],"}a=a.substring(0,a.length-1);g+=AjaxExamManage.getNoMakeSubHtml(d[f].题型名称,a)}BoxyMsgInfo.showNoMakeMsg(g)}else{AjaxExamManage.setReferBox("fail","unFinish","你还没做题,不能提交考卷");AjaxExamManage.isSubmit=false;return}})}if(!this.isSubmit){ExamDataManage.公共信息.是否已批改=false;return}var f=this;LK_LoginReg.show({是否提示未登录:true,预回调函数:function(){MaskDivManage.showSubmitExamDiv();var b=LKConfig.URLAssembly.Test.Server.get("isGetExamJson"),a=ExamDataManage.content.ID;if(b){if(f._exmaType==1)a=ExamLoadManage.getGuidTeam();if(SetExamTest._是否继续考试)a=ExamDataManage.公共信息.相关ID;f.textJsonData=ExamDataManage.getExamJson(f.textJsonData,a,1)}$.ajax({type:"POST",url:LKConfig.URLAssembly.Test.Server.get("SaveExam"),data:{action:"SaveExam",textJson:f.textJsonData},dataType:"json",success:function(b){MaskDivManage.hideSubmitExamDiv();if(b.result){AjaxExamManage.isRefersh=true;AjaxExamManage.setReferBox("success","referLink",AjaxExamManage.submitExamReferHtml(a,ExamDataManage.公共信息.ID))}else AjaxExamManage.setReferBox("fail","unFinish",b.info)},error:function(c,a){MaskDivManage.hideSubmitExamDiv();AjaxExamManage.setReferBox("fail","error",a)}})}})},submitRarting:function(c){ExamDataManage.公共信息.是否已批改=true;ExamDataManage.公共信息.试卷内容ID=ExamDataManage.content.ID;ExamDataManage.公共信息.批改状态类型=c;ExamTimeManage.jsonData.公共信息=ExamDataManage.公共信息;ExamTimeManage.jsonData.试卷内容=ExamDataManage.content;var a=ExamDataManage.公共信息.相关ID,b=ExamDataManage.getExamJson(ExamTimeManage.jsonData,a,null);MaskDivManage.showSubmitExamDiv();$.ajax({type:"POST",url:"/LKTest/SaveRarting/",data:{textJson:b},dataType:"json",success:function(b){MaskDivManage.hideSubmitExamDiv();if(b.result){AjaxExamManage.isRefersh=true;AjaxExamManage.setReferBox("success","referLink",AjaxExamManage.submitPartingReferHtml(a,ExamDataManage.公共信息.ID))}else AjaxExamManage.setReferBox("fail","unFinish",b.info)},error:function(c,a){MaskDivManage.hideSubmitExamDiv();AjaxExamManage.setReferBox("fail","error",a)}})}},MakeSubjectManage={getT11:function(f,d,b,e){var c=b?b.回答的选项ID:null,a=c!=null;e({result:a,info:a?{ID:f,试题内容ID:d,该题考试回答:{回答的题型:11,回答的选项ID:c}}:null})},getT12:function(f,d,c,e){var a=c?c.回答的选项ID集合:[],b=a.length!=0;e({result:b,info:b?{ID:f,试题内容ID:d,该题考试回答:{回答的题型:12,回答的选项ID集合:a}}:null})},getT13:function(f,d,c,e){var a=c?c.填空空格回答集合:[],b=a.length!=0;e({result:b,info:b?{ID:f,试题内容ID:d,该题考试回答:{回答的题型:13,填空空格回答集合:a}}:null})},getT14:function(f,d,c,e){var a=c?c.选词空格回答集合:[],b=a.length!=0;e({result:b,info:b?{ID:f,试题内容ID:d,该题考试回答:{回答的题型:14,选词空格回答集合:a}}:null})},getT15:function(f,d,c,e){var a=c?c.完形空格回答集合:[],b=a.length!=0;e({result:b,info:b?{ID:f,试题内容ID:d,该题考试回答:{回答的题型:15,完形空格回答集合:a}}:null})},getT20:function(f,d,c,e){var b=c?c.回答答案:null,a=b!=null;e({result:a,info:a?{ID:f,试题内容ID:d,该题考试回答:{回答的题型:20,回答答案:b}}:null})},getT30:function(i,g,f,h){for(var e=f?f.连线题回答集合:[],a,b=[],c,d=0;d<e.length;d++){a=e[d];a.回答的左选项ID!=null&&a.回答的右选项ID!=null&&b.push(a)}c=b.length!=0;h({result:c,info:c?{ID:i,试题内容ID:g,该题考试回答:{回答的题型:30,连线题回答集合:b}}:null})},getT40:function(f,g){for(var e,c=[],d,b=[],a=0;a<f.length;a++){e=f[a];this.getFulFill(e,function(d){if(d.result)c.push(d.info);else b.push(a+1)})}d=c.length!=0;g({result:d,info:d?{子小题集合:c}:null,子小题提示信息集合:b.length!=0?b:undefined})},getT60:function(f,d,c,e){var a=c?c.回答答案:null,b;a=$.trim(a);b=a!="";e({result:b,info:b?{ID:f,试题内容ID:d,该题考试回答:{回答的题型:60,回答答案:a}}:null})},getT8011:function(f,d,b,e){var c=b?b.回答的选项ID:null,a=c!=null;e({result:a,info:a?{ID:f,试题内容ID:d,该题考试回答:{回答的题型:8011,回答的选项ID:c}}:null})},jsonToText:function(a){return JSON.jsonToText(a)},getFulFill:function(a,b){var d=a.试题内容Json,e=d.content,c=e.小题型Enum;switch(c){case"11":case"12":case"13":case"14":case"15":case"20":case"30":case"8011":this["getT"+c](a.ID,a.试题内容ID,a.该题考试回答,b);break;case"60":case"61":case"62":case"63":case"64":case"65":case"66":case"67":case"68":case"69":this.getT60(a.ID,a.试题内容ID,a.该题考试回答,b);break;case"40":case"41":case"42":case"43":case"44":case"45":case"46":case"47":case"80":this.getT40(a.子小题集合||[],b)}},getOneTest:function(n,q){for(var p=n.试卷内容,o=p.试卷中大题集合||[],f,i,j,g=[],e,h=[],b,d=0,k=0;k<o.length;k++){f=o[k];i=f.试卷大题中试题集合;e=[];b=[];for(var l=0;l<i.length;l++){j=i[l];d++;this.getFulFill(j,function(a){if(a.result)e.push(a.info);else j.子小题集合==null&&b.push({试题序号:d,试题的子小题集合:null});var c=a.子小题提示信息集合;if(typeof c!="undefined"){var f=d+"."+c.join(","+d+".");b.push({试题序号:d,试题的子小题集合:f.split(",")||null})}})}e.length!=0&&g.push({ID:f.ID,试卷大题中试题集合:e});b.length!=0&&h.push({题型名称:f.名称,试题列表:b})}var a=n.公共信息,m={ID:a.ID,会员ID:a.会员ID,相关ID:a.相关ID,是否公布考试结果:a.是否公布考试结果,类型:a.类型,试卷内容ID:a.试卷内容ID,答题开始时间:a.答题开始时间,答题结束时间:a.答题结束时间,是否是已提交的试卷:a.是否是已提交的试卷,是否已批改:a.是否已批改,试卷内容:{试卷中大题集合:g}},c;if(g.length==0){c=2;m.是否已批改=false}else if(h.length!=0)c=1;else c=0;q({result:c,text:c!=2?this.jsonToText(m):null,msgList:h})}},ExamTimeManage={examTime:0,saveSpan:0,isSave:false,jsonData:{试卷内容:0,试卷外部信息:0,公共信息:0},getExamTimeHtml:function(a){return'<div class="ExamTime" style="top:0px;right:0px; position:fixed;_position:relative;_float:right;_top:-130px;_bottom:0px;">                            <span class=" ExamTimeFont">考试剩余时间</span>                            <span class="ExamLeavingTime">'+a+'</span>                            <a class="commonExam submitExam" href="javascript:void(0)" onclick="AjaxExamManage.submitExam();">我要交卷</a>                            <span title="保存以后五分钟之后才能保存" class="commonExam SaveExam" onclick="ExamTimeManage.showSaveingTest();" >保存试卷</span>                    </div>'},initExamTime:function(a){SetExamTest.titleID.parent().append(this.getExamTimeHtml(a));this.saveSpan=SetExamTest.titleID.parent().children("div:eq(3)").children("span:eq(2)");this.examTime=a*60;this.refurbishTime()},getExamTime:function(){this.examTime--;var b,a;a=this.examTime%60;b=parseInt(this.examTime/60)+":"+(a<10?"0"+a:a);return b},refurbishTime:function(){var a=ExamTimeManage.getExamTime();SetExamTest.titleID.parent().children("div:eq(3)").children("span:eq(1)").text(a);delete a;if(ExamTimeManage.examTime>0)setTimeout(ExamTimeManage.refurbishTime,1e3);else alert("考试时间已到请交卷！！")},openSaveExam:function(){ExamTimeManage.saveSpan.removeClass("SaveExam");ExamTimeManage.saveSpan.addClass("submitExam");ExamTimeManage.isSave=true},noOpenNoSaveExam:function(){ExamTimeManage.saveSpan.removeClass("SaveExam1");ExamTimeManage.saveSpan.addClass("SaveExam");ExamTimeManage.isSave=false},showSaveingTest:function(){if(ExamTimeManage.isSave){ExamTimeManage.saveSpan.removeClass("submitExam");ExamTimeManage.saveSpan.addClass("SaveExam1");ExamTimeManage.saveSpan.text("正在保存考卷...");ExamTimeManage.isSave=false;this.ajaxSaveExam()}},noSaveExam:function(){ExamTimeManage.saveSpan.removeClass("SaveExam1");ExamTimeManage.saveSpan.addClass("submitExam");ExamTimeManage.saveSpan.text("保存考卷");ExamTimeManage.isSave=true},hideSaveingTest:function(){ExamTimeManage.saveSpan.removeClass("SaveExam1");ExamTimeManage.saveSpan.addClass("submitExam");ExamTimeManage.saveSpan.text("保存考卷")},showSavedTestInfo:function(a){ExamTimeManage.saveSpan.text(a);setTimeout(function(){ExamTimeManage.saveSpan.removeClass("SaveExam1");ExamTimeManage.saveSpan.addClass("SaveExam");ExamTimeManage.saveSpan.text("保存考卷");ExamTimeManage.isSave=false},5e3);setTimeout(function(){ExamTimeManage.saveSpan.removeClass("SaveExam");ExamTimeManage.saveSpan.addClass("submitExam");ExamTimeManage.isSave=true},3e5)},ajaxSaveExam:function(){var a,b;b=new Date;b=ExamCommonSetManage.getExamTimeString(b);ExamDataManage.公共信息.答题结束时间=b;ExamDataManage.公共信息.是否是已提交的试卷=false;ExamDataManage.公共信息.是否已批改=false;ExamDataManage.公共信息.会员ID="00000000-0000-0000-0000-000000000000";ExamDataManage.公共信息.试卷内容ID=ExamDataManage.content.ID;ExamDataManage.addCommonID(ExamDataManage.getGuid());this.jsonData.公共信息=ExamDataManage.公共信息;this.jsonData.试卷内容=ExamDataManage.content;MakeSubjectManage.getOneTest(this.jsonData,function(b){if(b.result==0)a=b.text;else if(b.result==1)a=b.text;else{AjaxExamManage.setReferBox("fail","unFinish","你还没做题,不能保存考卷!");ExamTimeManage.hideSaveingTest();ExamTimeManage.openSaveExam();return}var f=this,d=LKConfig.URLAssembly.Test.Server.get("isGetExamJson"),c=ExamDataManage.content.ID;if(d){var e=AjaxExamManage._exmaType;if(e==1)c=ExamLoadManage.getGuidTeam();if(SetExamTest._是否继续考试)c=ExamDataManage.公共信息.相关ID;a=ExamDataManage.getExamJson(a,c,0)}LK_LoginReg.show({是否提示未登录:true,关闭之后回调函数:function(){ExamTimeManage.noSaveExam()},预回调函数:function(){LK_LoginReg.options.关闭之后回调函数=function(){};$.ajax({type:"POST",url:LKConfig.URLAssembly.Test.Server.get("SaveExam"),data:{action:"SaveExam",textJson:a},dataType:"json",success:function(a){if(a.result)ExamTimeManage.showSavedTestInfo("保存考卷成功!");else ExamTimeManage.showSavedTestInfo("保存考卷失败!")},error:function(c,a){AjaxExamManage.setReferBox("fail","error",a)}})}})})}}