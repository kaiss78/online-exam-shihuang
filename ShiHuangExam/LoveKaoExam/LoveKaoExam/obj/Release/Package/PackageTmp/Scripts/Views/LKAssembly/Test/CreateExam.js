$(document).ready(function(){TestPageManage.ready();$(document).bind("contextmenu",function(){return false})});$(document).keydown(function(a){a.keyCode==13});function DisableF5(){with(event)if(keyCode==116||ctrlKey&&keyCode==82){event.keyCode=0;event.cancelBubble=true;return false}}document.onkeydown=DisableF5;var TestPageManage={isNew:false,initIntegerID:0,ready:function(){TestSubjectTypeManage.initSubType();TestBoxyManage.init();TestBoxyManage.initTestSetBox();TestBoxyManage.initAddSubBox();TestAddSortManage.initSort();TestOutsideManage.outsideInfoBox=TestOutsideManage.outsideInfoBox||$("#outsideInfoId");TestOutsideManage.outsideInfoBox.next().children("span:eq(0)").css("display",LKConfig.URLAssembly.Test.Css.get("IsNone"));this.complete();$.ajaxSetup({timeout:6e4})},complete:function(){var a=this.getGuidTeam(),b=this.getTestType();this.initIntegerID=this.initIntegerID||$("#IntegerID");this.isNew=a==false?true:false;if(this.isNew)this.initIntegerID.show();else TestReferSever.ajaxGetTest(a,b);this.setSort()},getGuidTeam:function(){var b=window.location.href,c=b.indexOf("guid="),a;if(c!=-1){a=b.substring(c+5,b.length).split("&")[0];if(a.length==36)return a}return false},setSort:function(){var a=window.location.href,b=a.indexOf("sort=");if(b!=-1){var c=a.substring(b+5,a.length).split("&")[0],d=TestDataManage.outside.分类列表[0]=c?unescape(c):"";this.initIntegerID.children().children().children("div:eq(1)").children("span:eq(3)").children().text(d)}},getTestType:function(){var a=GlobalManage.getUrlArg(),b=a.type;return b},login:function(){alert("你还没登陆")},back:function(){if(confirm("你确定要退出手工出卷页面吗？")){var a=LKConfig.URLAssembly.Test.Page.get("BackTest");window.location.href=a}}},TestDataManage={sort:{min:1,max1:10,max:12},getRandom:function(){return((1+Math.random())*65536|0).toString(16).substring(1)},getGuid:function(){return this.getRandom()+this.getRandom()+"-"+this.getRandom()+"-"+this.getRandom()+"-"+this.getRandom()+"-"+this.getRandom()+this.getRandom()+this.getRandom()},clone:function(a){var b;if(a instanceof Array){b=[];var c=a.length;while(c--)b[c]=this.clone(a[c]);return b}else if(a instanceof Object){b={};for(var d in a)b[d]=this.clone(a[d]);return b}else return a},题型Len:0,试题Len:0,outside:{分类列表:[],ID:"",名称:"",考试时长:"120",创建人ID:"00000000-0000-0000-0000-000000000000",及格条件:"60",试卷状态Enum:"0",是否公开:true},content:{ID:"",试卷外部信息ID:"",名称:"",说明:"",考试时长:"120",总分:"100",提交人ID:"",提交备注:"",及格条件:"60",试卷中大题集合:[]},findSub:{试题内容:"",分类:[],题型名称:[],是否查找自己试题:false},names:{T10:"自由题",T11:"单选题",T12:"多选题",T13:"填空题",T14:"选词填空",T15:"完形填空",T20:"判断题",T30:"连线题",T40:"复合题",T41:"诗词鉴赏",T42:"阅读理解",T43:"快速阅读",T44:"文言文",T45:"现代文",T46:"材料分析",T47:"案例分析",T50:"改错题",T60:"问答题",T61:"简答题",T62:"论述题",T63:"翻译题",T64:"计算题",T65:"作文题",T66:"案例题",T67:"材料题",T68:"推理题",T69:"名词解释",T80:"多题干共用选项题"},questionTypes:'{ "名称": "","说明": "", "多选题评分策略": "0","试卷大题中试题集合": []}',textToJson:function(a){return JSON.textToJson(a)},jsonToText:function(a){return JSON.jsonToText(a)},getTypesJson:function(b){var a=this.textToJson(this.questionTypes);a.名称=b;return a},get分类列表:function(){return this.outside.分类列表},get查找试题的分类列表:function(){return this.findSub.分类},get试卷的ID:function(){return this.content.试卷外部信息ID},get试卷的名称:function(){return this.outside.名称},get考试时长:function(){return this.content.考试时长},get试卷总分:function(){return this.content.总分},get及格条件:function(){return this.content.及格条件},get是否公开:function(){return this.outside.是否公开},get试卷说明:function(){return this.content.说明},get是否查找自己试题:function(){return this.findSub.是否查找自己试题},edit试卷名称:function(b){var a=b;this.outside.名称=a;this.content.名称=a},edit考试时长:function(b){var a=b;this.outside.考试时长=a;this.content.考试时长=a},edit试卷总分:function(a){this.content.总分=a},edit及格条件:function(b){var a=b;this.content.及格条件=a;this.outside.及格条件=a},edit是否公开:function(a){this.outside.是否公开=a},edit考试说明:function(a){this.content.说明=a},addOutsideID:function(a){this.content.试卷外部信息ID=a;this.outside.ID=a},addContentID:function(a){this.content.ID=a},AddReferID:function(a){this.content.提交人ID=a;this.outside.创建人ID=a},SetTestState:function(a){this.outside.试卷状态Enum=a},get题型集合:function(){return this.content.试卷中大题集合},get题型:function(a){return this.content.试卷中大题集合[a]},get题型名称:function(a){return this.get题型(a).名称},get说明:function(a){return this.get题型(a).说明},get多选题评分策略:function(){return this.get题型(index).多选题评分策略},add大题的集合:function(a){var b=this.getTypesJson(a);this.content.试卷中大题集合.push(b);this.题型Len++},Del大题的集合:function(a){this.content.试卷中大题集合.splice(a,1);this.题型Len--},reName大题的集合:function(a,b){this.content.试卷中大题集合[a].名称=b},reName大题的说明:function(a,b){this.content.试卷中大题集合[a].说明=b},add试题的集合:function(b,c){var a=this.content.试卷中大题集合[b].试卷大题中试题集合;a.push({试题内容ID:c,每小题分值:"0",子小题集合:[]});this.试题Len++},add试题中子试题集合:function(b,d,c){var a=this.content.试卷中大题集合[b].试卷大题中试题集合[d].子小题集合;a.push({试题内容ID:c,每小题分值:"0"})},get试题长度:function(a){return this.get试题集合(a).length},del试题的集合:function(c,d){for(var b=this.content.试卷中大题集合[c].试卷大题中试题集合,a=0;a<this.get试题长度(c);a++)if(b[a].试题内容ID==d){b.splice(a,1);this.试题Len--;break}},get试题:function(a,b){return this.get题型(a).试卷大题中试题集合[b]},getOneSubID:function(a,c,b){this.get题型(a).试卷大题中试题集合[c].每小题分值=b},add添加子小题分值:function(a,c,b,d){this.get题型(a).试卷大题中试题集合[c].子小题集合[d].每小题分值=b},get试题的每小题分值:function(e,f){for(var b=0,d=this.get试题(e,f).子小题集合,g=d.length,a=0,c=0;c<g;c++){a=d[c].每小题分值;if(a=="0")a=parseInt(a);b+=a}b=Math.round(b*10)/10;return b},addAllSubValue:function(b,c){for(var a=0;a<this.get试题长度(b);a++)this.get题型(b).试卷大题中试题集合[a].每小题分值=c},getAllSubID:function(c){for(var a=0;a<this.题型Len;a++)for(var b=0;b<this.get试题长度(a);b++)if(c==this.get题型(a).试卷大题中试题集合[b].试题内容ID){return c;break}},getEditSubLen:function(){for(var b=0,a=0;a<this.题型Len;a++)for(var c=0;c<this.get试题长度(a);c++)b++;return b},getSubID:function(a,b){return this.get题型(a).试卷大题中试题集合[b].试题内容ID},get试题分值:function(a,b){return this.get题型(a).试卷大题中试题集合[b].每小题分值},get子题分值:function(a,b,c){return this.get题型(a).试卷大题中试题集合[b].子小题集合[c].每小题分值},get分值By题型:function(d){for(var b=0,a=0,c=0;c<this.get试题长度(d);c++){a=this.get题型(d).试卷大题中试题集合[c].每小题分值;if(a=="0")a=parseInt(a);b+=a}b=Math.round(b*10)/10;return parseFloat(b)},getAll分值:function(){for(var b=0,a=0,c=0;c<this.题型Len;c++)for(var d=0;d<this.get试题长度(c);d++){a=this.get题型(c).试卷大题中试题集合[d].每小题分值;if(a=="0")a=parseInt(a);b+=a}b=Math.round(b*10)/10;return parseFloat(b)},subValueIsNull:function(){for(var c,a=0;a<this.题型Len;a++)for(var b=0;b<this.get试题长度(a);b++){c=this.get题型(a).试卷大题中试题集合[b].每小题分值;if(c==0){return'<div class="referCount"><span>'+this.get题型名称(a)+"</span>的<span>第"+(b+1)+"小题</span>分值未设置</div>";return true}}},get试题集合:function(a){return this.get题型(a).试卷大题中试题集合},trim:function(a){return $.trim(a)}},TestEqualManage={data:{},cloneData:function(a){TestDataManage.outside=a.outside;TestDataManage.content=a.content;var c=TestDataManage.get试卷的名称();if(!c){TestOutsideManage.outsideInfoBox.text("未设置");TestDataManage.outside.名称=""}else TestOutsideManage.outsideInfoBox.text(c);TestOutsideManage._testTime.text(TestDataManage.get考试时长());var b=TestDataManage.get试卷总分();TestOutsideManage._testCount.text(b);TestOutsideManage.currentValue=b;TestOutsideManage._currentCount.text(b);TestOutsideManage.sortList.html(TestCommonSetManage.sortHtml(TestDataManage.get分类列表()));TestSubjectTypeManage.initSubType();this.data=TestDataManage.clone(a);delete a},changeOutside:function(a){return!LK_Equals.json(this.data.outside,a)},changeSort:function(a){return!LK_Equals.json(this.data.outside.分类列表,a)},changeContent:function(a){return!LK_Equals.json(this.data.content,a)}},TestCommonSetManage={interceptString:function(b,a){a=a||10;return b.length>a?a==10?b.substring(0,a):b.substring(0,a)+"...":b},getIcoFont:function(a){return'<div class="refer_I_Ico"></div><div class="refer_I_font">'+a+"</a></div>"},isEmptyOrNull:function(a,b){a=TestDataManage.trim(a);if(a==""||a==null||a==0){TestReferSever.setReferBox("unFinishTest","unFinish",this.getIcoFont(b));return true}else return false},sortHtml:function(c){for(var d="",b,a=0;a<c.length;a++){b=c[a];d+=(a>0&&b!=""?",":"")+this.interceptString(b,8)}return d},get序号集合:function(d){var b=0,a="";if(d>0){for(var c=0;c<d;c++){a+=TestDataManage.get试题长度(c);a=parseInt(a)}b=a}else b=b;return b},viewOneSub:function(a,b,d){var c=TestHashTable.get(TestDataManage.getSubID(a,b));ViewLibSubject.getItemHtml(0,c,d,function(a){ViewSubject.viewBoxCsh.children().html(a)},false,false,false)},viewSubList:function(a,h){if(h!=""){var i=TestDataManage.get说明(a);ViewSubject.showViewSubBox(h,i)}var e="",f=0,b="",g;if(a>0){for(var d=0;d<a;d++){b+=TestDataManage.get试题长度(d);b=parseInt(b)}f=b}for(var c=0;c<TestDataManage.get试题长度(a);c++){g=TestHashTable.get(TestDataManage.getSubID(a,c));ViewLibSubject.getItemHtml(0,g,f+c+1,function(a){e+=a},false,false,false)}ViewSubject.viewBoxCsh.show();ViewSubject.viewBoxCsh.children().html(e)},countIsEques:function(){var a=TestOutsideManage.currentValue,b=TestDataManage.get试卷总分();if(a!=b){var c='<div class="referCount"><span>试卷总分'+b+"分</span>和<span>当前试题总分"+a+"分</span>不相等，请修改试卷总分或者试题分值</div>";TestReferSever.setReferBox("unFinishTest","unFinish",this.getIcoFont(c));return true}else return false},checkSubValue:function(){var a=TestDataManage.subValueIsNull();if(a){TestReferSever.setReferBox("unFinishTest","unFinish",this.getIcoFont(a));return true}else return false},checkValueFlow:function(a){if(a<0||a>99.9){alert("分值设置的范围0-99.9之间，请重新填写分值");return true}else return false},getReNameSubType:function(e,c){var d=$(e),b=TestDataManage.get题型名称(c),a=d.val();a=TestDataManage.trim(a);if(a==""){alert("题型不能为空,请重新填写!");a=b}return a},refreshTest:function(){window.location.reload()},hideFindSub:function(){TestAddSortManage.IdFindSub.prev().children("a:eq(2)").remove();TestAddSortManage.IdFindSub.children("div:eq(2)").html("");TestAddSortManage.IdFindSub.prev().children("a:eq(0)").click();AddSubManage.dataJson=0;AddSubManage.isFind=false},setCurrentValue:function(){var a=TestDataManage.getAll分值();TestOutsideManage._currentCount.text(a);TestOutsideManage.currentValue=a},setCurrentSubTypeValue:function(){TestDivSetBox.ShowSubInforBox(subTypeName,TestDataManage.get分值By题型(subTypeIndex))}},TestHashTable={data:{},length:0,put:function(b,a){this.data[b]=a;this.length++},"get":function(a){return this.data[a]},remove:function(a){delete this.data[a];this.length--}},TestBoxyManage={box:0,testSetBox:0,radioPulicID:0,AddSubBox:0,setValueBox:0,setAllSubBox:0,referTestBox:0,referDiv:0,allSubValueDiv:0,allValueInput:0,isAddColor:false,init:function(){this.box=this.box||new Boxy("<iframe src="+LKConfig.URLAssembly.Test.IFrame.get("SubjectType")+' scrolling="no" frameborder="0" height="135px" width="353px;"></iframe>',{title:"选择添加题型",modal:true,show:0,closeText:"[关闭]"})},show:function(){this.init();this.box.centerAt(800,200);this.box.show();TestDivTier.isInit&&TestDivTier.hide()},InitDelSubType:function(a){Boxy.confirm('<div class="delSubBox"><div class="delSubTypeWtIco"></div><div class="delSubTypeWtFont">您确定删除"<span style="color:Red;">'+TestDataManage.content.试卷中大题集合[a].名称+'</span>"题型?</div></div>',function(){TestSubjectTypeManage.subTypeBoxRemove(a);TestDivTier.hide()},{title:"提醒",modal:true})},InitDelSub:function(b,a,c){Boxy.confirm('<div class="delSubBox"><div class="delSubTypeWtIco"></div><div class="delSubTypeWtFont">您确定删除该试题</div></div>',function(){AddSubManage.subBoxRemove(b,a,c);TestDivTier.hideSubBox()},{title:"提醒",modal:true})},initTestSetBox:function(){this.testSetBox=this.testSetBox||new Boxy("",{title:"试卷信息基本设置",show:0,modal:true,closeText:"[关闭]",beforeShow:function(){TestBoxyManage.setTestContent();TestOutsideManage.initSort();TestBoxyManage.radioPulicID=$("#TestRadioPulicID");if(TestDataManage.get是否公开())TestBoxyManage.radioPulicID.children("input:eq(0)").attr("checked",true);else TestBoxyManage.radioPulicID.children("input:eq(1)").attr("checked",true)}})},getTestContent:function(){return'<div class="TestSetBox" id="TestSetBoxID" style='+LKConfig.URLAssembly.Test.Css.get("TestSetHeight")+'><div class="TestSetBoxContent">    <div class="TestSetBoxLeft">试卷名称：</div>    <div class="TestSetBoxRight"><input  onfocus="TestBoxyManage.onFous(this,\'testName\')" class="TestSetBoxInput" maxlength="32"  value="'+TestDataManage.get试卷的名称()+'"  onblur="TestOutsideManage.editTestName(this)" /></div> </div><div class="TestSetBoxContent" style=" margin-top:10px;"><div class="TestSetBoxLeft">分类：</div><div class="TestSetBoxRight" id="TestSortID"></div> </div><div class="TestSetBoxContent" style='+LKConfig.URLAssembly.Test.Css.get("TestSet")+'><div class="TestSetBoxLeft " >考试时间：</div><div class="TestSetBoxRight"><input onfocus="TestBoxyManage.onFous(this,\'outsideInfo\')"onkeyup="TestBoxyManage.onkeyup1(this)" maxlength="3" class="TestSetBoxInput TestTimeInputBg"   value="'+TestDataManage.get考试时长()+'"  onblur="TestOutsideManage.editTestTime(this)" /></div> </div><div class="TestSetBoxContent"><div class="TestSetBoxLeft" >总分：</div><div class="TestSetBoxRight"><input onfocus="TestBoxyManage.onFous(this,\'outsideInfo\')"onkeyup="TestBoxyManage.onkeyup1(this)"  maxlength="3" class="TestSetBoxInput" value="'+TestDataManage.get试卷总分()+'" onblur="TestOutsideManage.editTestCount(this)" /></div> </div><div class="TestSetBoxContent" style='+LKConfig.URLAssembly.Test.Css.get("TestSet")+'><div class="TestSetBoxLeft ">及格条件：</div><div class="TestSetBoxRight "><input onfocus="TestBoxyManage.onFous(this,\'outsideInfo\')"onkeyup="TestBoxyManage.onkeyup1(this)" maxlength="3" class="TestSetBoxInput PassInputBg"  maxlength="3" value="'+TestDataManage.get及格条件()+'"onblur="TestOutsideManage.editTestPass(this)" /></div> </div><div class="TestSetBoxContent" style='+LKConfig.URLAssembly.Test.Css.get("TestSet")+'>    <div class="TestSetBoxLeft">公开试卷：</div>    <div class="TestSetBoxRight TestSetBoxRadio" id=TestRadioPulicID><input id="TestRadioPublic1" type="radio" name="TestPublic" onclick="TestOutsideManage.editTestIsOpen(\'1\');" /><label for="TestRadioPublic1">公开</label><input id="TestRadioPublic2" type="radio" name="TestPublic" onclick="TestOutsideManage.editTestIsOpen(\'0\');" style="margin-left: 6px; *margin-left: 2px;" /><label for="TestRadioPublic2">不公开</label></div> </div> <div class="TestSetBoxContent">    <div class="TestSetBoxLeft">考试说明：</div>    <div class="TestSetBoxRight"><textarea class="TestSetBoxInput TestTextarea" cols="20" onkeydown="return TestBoxyManage.isMaxLen(this);" maxlength="200" rows="2"onfocus="TestBoxyManage.onFous(this,\'testNarrate\')"onblur="TestOutsideManage.editTestNarrate(this)" >'+TestDataManage.get试卷说明()+'</textarea></div> </div>  <div class="TestSetBoxContent" style=" margin-bottom:20px;_padding-bottom:20px;"><span class="btn1 TestSetBoxSubLeft SubBg" ><span><input style="width:80px; font-size:13px;" class="FindSub FindSubLeft" type="button" value="确 定" onclick="TestBoxyManage.closeTestSetBox();"/></span></span></div></div>'},setTestContent:function(){this.testSetBox.setContent(this.getTestContent())},showTestSetBox:function(){this.initTestSetBox();this.testSetBox.show()},closeTestSetBox:function(){this.testSetBox.hide()},onkeyup:function(a){if(event.keyCode==9)return;a.value=a.value.replace(/[^\d.]/g,"");a.value=a.value.replace(/^\./g,"");a.value=a.value.replace(/\.{2,}/g,".");a.value=a.value.replace(".","$#$").replace(/\./g,"").replace("$#$",".")},onkeyup1:function(a){if(event.keyCode==9)return;a.value=a.value.replace(/[^\d.]/g,"");a.value=a.value.replace(/^\./g,"");a.value=a.value.replace(/\.{2,}/g,"");a.value=a.value.replace("","$#$").replace(/\./g,"").replace("$#$","")},onFous:function(b,c){var a=$(b);switch(c){case"oneSubValue":a.select();a.addClass("oneValueColor");break;case"allSubValue":a.select();a.addClass("allValueColor");break;case"testNarrate":a.select();a.addClass("testNarrateColor");break;case"testName":a.addClass("narCurTestSetInput");break;case"findSubContent":b.select();a.addClass("findSubContent");break;default:a.select();a.addClass("narCurTestSetInput")}},onBlur:function(a){$(a).removeClass("allValueColor")},isMaxLen:function(a){var b=a.getAttribute?parseInt(a.getAttribute("maxlength")):"";if(a.getAttribute&&a.value.length>b)a.value=a.value.substring(0,b)},initAddSubBox:function(){this.AddSubBox=this.AddSubBox||new Boxy('<div id="subMaskID" class="AddSubBox"><div class="AddSubHeader"><a href="javascript:void(0)" onclick="TestAddSortManage.switchTag(this,\'ID_AddSub_Box\',0);" class="TagUnSelect TagsSelect" style="margin-left:25px;">查找试题</a><a href="javascript:void(0)" onclick="TestAddSortManage.switchTag(this,\'ID_AddSub_Box\',1);" class="TagUnSelect">添加新试题</a></div><div class="AddSubContent" id="ID_AddSub_Box">'+this.getFindSubTagDiv()+this.getAddSubTagDiv()+"<div></div></div></div>",{title:"添加试题",modal:true,show:0,closeText:"[关闭]",afterShow:function(){TestBoxyManage.AddSubBox.boxy.css("filter","none")}})},getFindSubTagDiv:function(){$("#ID_IsFindSelf").attr("checked",TestDataManage.get是否查找自己试题?true:false);return'<div class="AddSubContent"><div class="AddSubBoxIfram"><div class="AddSubBoxContent"><div class="AddSubBoxLeft">试题内容：</div><div class="AddSubBoxRight"><input class="AddSubBoxInput" onfocus="TestBoxyManage.onFous(this,\'findSubContent\')" onblur="IframeFindSubTypeManage.editTestName(this)" /></div> </div><div class="AddSubBoxContent" style="padding-top:20px;"><div class="AddSubBoxLeft">分类：</div><div class="AddSubBoxRight FindSubSort" id="FindSubSortID"></div> </div><div class="AddSubBoxContent"><div class="AddSubBoxLeft">题型名称：</div><div class="AddSubBoxRight FindSubIframe"><iframe src='+LKConfig.URLAssembly.Test.IFrame.get("FindSubType")+' height="138px" width="447px" scrolling="no" frameborder="0"></iframe></div></div><div class="AddSubBoxContent"><div class="AddSubBoxLeft AddMySubCBox"><input id="ID_IsFindSelf"  type="checkbox"  onclick="IframeFindSubTypeManage.editIsFindSelf(this)" /></div><div class="AddSubBoxInput AddMySubFont ">只查找我出的试题</div> </div>    <div class="AddSubBoxContent" style=" _margin-top:10px; height:45px;"><span class="btn1"><span><input style="width:80px; font-size:13px;" class="FindSub FindSubLeft" type="button" value="查 询" onclick="TestReferSever.ajaxFindSub(1);"/></span></span><span class="btn2"><span><input style="width:80px; font-size:13px;" class="FindSub" type="button" value="取 消" onclick="TestBoxyManage.closeFIndSubBox();" /></span></span></div></div></div>'},closeFIndSubBox:function(){this.AddSubBox.hide()},loadCssFile:function(c){var a=document.getElementById("loadCss"),b=document.getElementsByTagName("head").item(0);a&&b.removeChild(a);css=document.createElement("link");css.href=c;css.rel="stylesheet";css.type="text/css";b.appendChild(css)},AddSubLoadCss:function(){this.loadCssFile("/Content/LKAssembly/Subject/EditHtml.css");this.loadCssFile("/Content/LKAssembly/Subject/EditSubject.css")},loadAddSubJs:function(){$.getScript("/Scripts/Views/LKAssembly/Subject/EditSubjects.js",function(){PageManage.ready();TestManage.isTest=true},false)},getAddSubTagDiv:function(){return'<div class="AddSubContent" style="display:none;"><div class="AddSubBoxIfram" id="TestID" ></div></div>'},getAddSubHtml:function(){return'<div class="E_S_Layout" style="margin:30px 0px 0px 45px;"><div class="E_S_Layout">    <div class="E_S_L_Masks" id="ID_Masks_Box">        数据正在加载中......</div>    <div style="clear: both;">    </div>    <div class="E_S_L_Bar">        <div class="E_S_L_B_Mark">            所属题型：</div>        <div class="E_S_L_B_Auto" id="ID_QuestionTypes_Box">            <a class="E_S_L_B_QuestionTypes E_S_L_B_Q_S_Link" mark="" title="选择题型" style="display: none;"                href="javascript:void(0)" onclick="IFrameQuestionTypesManage.show(this);"><span class="E_S_L_B_Q_Value">                </span></a><a class="E_S_L_B_QuestionTypes"><span class="E_S_L_B_Q_Value"></span>                    <samp class="E_S_L_B_Q_State">                        [修改试题]</samp>                </a>        </div>    </div>    <div class="E_S_L_Hidden" id="ID_Hidden_Box">        <div class="E_S_L_Bar" id="ID_MoreHtml_Box" style="margin-top: 0px;">        </div>        <div class="E_S_L_Bar unxtbj">            <div class="E_S_L_B_Mark">                分类：</div>            <div id="ID_Sort_Box" style="float:left;"></div>        </div><div class="E_S_L_Bar unxtbj">            <div class="E_S_L_B_Mark">                难易度：</div>            <div class="E_S_L_B_Difficult" id="ID_Difficult_Box">            </div>            <span class="E_S_L_B_Difficult_Amount" id="ID_Difficult_Amount"></span>        </div>        <div class="E_S_L_Bar unxtbj hidden">            <div class="E_S_L_B_Mark">                是否公开：</div>            <div class="E_S_L_B_Fix E_S_L_B_Radio" id="ID_Public_Box">                <input id="RadioPublic1" type="radio" name="Public" onclick="OutsideManage.setPublic(\'1\');"                    checked="checked" />                <label for="RadioPublic1">                    公开</label>                <input id="RadioPublic2" type="radio" name="Public" onclick="OutsideManage.setPublic(\'0\');"                    style="margin-left: 6px; *margin-left: 2px;" />                <label for="RadioPublic2">                    不公开</label>            </div>            <div class="E_S_L_B_Fix E_S_L_B_Radio" style="display: none;">                <span>是</span><span style="color: #999;">(已公开不能更改)</span>            </div>        </div>        <div class="E_S_L_Bar" style="height: 100px;margin-top:10px;">            <div class="E_S_L_B_Mark">            </div>            <div class="E_S_L_B_Fix E_S_L_B_Handle">                <a class="E_S_L_B_H_base" title="智能识别输入试题" href="javascript:void(0)" onclick="Recog试题管理.显示识别输入(this,null,null);">识 别 输 入</a>                <a class="E_S_L_B_H_base" title="预览该试题内容" href="javascript:void(0)" onclick="View试题管理.显示试题预览(null);">预 览 试 题</a>                <div class="E_S_L_B_H_base">                    <a class="E_S_L_B_H_B_left" href="javascript:void(0)" title="提交到爱考网" onclick="ReferServer.submit(0);">&nbsp;提&nbsp;&nbsp;&nbsp;交</a>                     <a class="E_S_L_B_H_B_right0" href="javascript:void(0)" onmouseover="ReferServer.save_sel_mouse(this,\'over\');" onmouseout="ReferServer.save_sel_mouse(this,\'out\');" onclick="ReferServer.save_sel(this);" title="选择保存类型"></a>                </div>            </div>        </div>    </div></div>'},showAddSubBox:function(){this.initAddSubBox();this.AddSubBox.show();if(TestSubjectTypeManage.isInitFindSub){AddSubManage.showFindSub(AddSubManage.dataJson);if(FatherIframeSubManage.isNewAdd){TestAddSortManage.IdFindSub.prev().children("a:eq(0)").addClass("TagsSelect");TestAddSortManage.IdFindSub.prev().children("a:eq(2)").removeClass("TagsSelect");TestAddSortManage.IdFindSub.children("div:eq(0)").show();TestAddSortManage.IdFindSub.children("div:eq(2)").hide()}}},closeAddSubBox:function(){this.AddSubBox.hide()},initSetValues:function(b,a){this.setValueBox=new Boxy("",{title:"设置试题的分值",modal:true,show:0,closeText:"[关闭]",beforeShow:function(){TestBoxyManage.setSetValueContent(b,a);TestBoxyManage.allSubValueDiv=$("#allSubID")}})},getSetValueContent:function(a,b){return'<div class="subSetValues"><div class="TestSetBoxContent"><div class="TestSetBoxLeft">题型名称：</div> <div class="TestSetBoxRight"><input class="TestSetBoxInput" maxlength="16" onfocus="TestBoxyManage.onFous(this,\'outsideInfo\')"onblur="TestSubjectTypeManage.renameSubtype(this,\''+a+'\')" value="'+TestDataManage.get题型名称(a)+'" /></div> </div>   <div class="TestSetBoxContent"> <div class="TestSetBoxLeft" style="padding-top:10px;">题型说明：</div> <div class="TestSetBoxRight"><textarea class="TestSetBoxInput TestTextarea" onfocus="TestBoxyManage.onFous(this,\'testNarrate\')"onkeydown="return TestBoxyManage.isMaxLen(this);" maxlength="100"  onblur="TestSubjectTypeManage.renameExplain(this,\''+a+'\');" cols="20" rows="2" maxlength="150"  style="margin-top:10px;">'+TestDataManage.get说明(a)+'</textarea></div> </div><div class="SubTitleAndValues ShowAddSubHeadBox subSetValuesHeader"><span class="commonFont SubContent setContent" >题干</span><span class="commonFont blank">空格数量</span>   <span class="commonFont SetSubPreview">分值(<a href="javascript:void(0)" onclick="TestBoxyManage.showSetAllSubValue(\''+a+'\');">设置</a>)</span></div><div class="FindSubContentBox subSetValuesContent" id="allSubID">'+this.getSubList(a,b)+"</div> </div>"},setSetValueContent:function(b,a){this.setValueBox.setContent(this.getSetValueContent(b,a))},getSetValueHtml:function(c,h,a,d,g,f,e,i,j,b){return'<div class="FindSubContentBoxFont setValueBox '+(c?"subClickColor":"")+'">     <span title="'+TestCommonSetManage.interceptString(a,100)+'"  class="commonFont SubContent setContent" >'+h+""+TestCommonSetManage.interceptString(a,i)+'</span><span  title="该题总共有'+b+'个空格" class="commonFont blank">共有<samp>'+b+'</samp>个空格</span>  <span  class="commonFont SubPreview setValueDiv"><input class="setValueInput" maxlength="4" type="text" value="'+d+'"onblur="TestBoxyManage.changeValue(this,\''+g+"','"+f+"','"+e+"','"+j+'\')"onkeyup="TestBoxyManage.onkeyup(this)"onfocus="TestBoxyManage.onFous(this,\'oneSubValue\')" /></span></div>'},getSubList:function(d,p){var i="",g,j,o,n,e,k,f,q,h="",m,r="",c=0,l="",s;p=parseInt(p);if(d>0){for(var b=0;b<d;b++){l+=TestDataManage.get试题长度(b);l=parseInt(l)}c=l}for(var a=0;a<TestDataManage.get试题长度(d);a++){g=TestDataManage.getSubID(d,a);n=TestHashTable.get(g).试题内容Json;e=n.content;if(e.选词空格集合)f=e.选词空格集合.length;else if(e.单选空格集合)f=e.单选空格集合.length;else if(e.填空空格集合)f=e.填空空格集合.length;else f=0;j=n.content.题干文本;o=TestDataManage.get试题分值(d,a);p==a?this.isAddColor=true:this.isAddColor=false;k=TestHashTable.get(g).子小题集合;if(k)if(k.length!=0){i+='<div class="FindSubContentBoxFont setValueBox '+(this.isAddColor?"subClickColor":"")+'">     <span title="'+TestCommonSetManage.interceptString(j,100)+'" class="commonFont SubContent setContent" ><samp class="subTaxis" title="第'+(c+a+1)+'题">'+(c+a+1)+".</samp>"+TestCommonSetManage.interceptString(j,36)+"</span></div>";for(var b=0;b<k.length;b++){q=k[b].试题内容Json.content.题干文本;m=TestDataManage.get子题分值(d,a,b);if(m==null)m=0;h='<samp style="padding-left:30px; padding-right:8px;" class="subTaxis" title="第'+(c+a+1)+"大题的第"+(b+1)+'小题">'+(c+a+1)+"."+(b+1)+"</samp>";i+=this.getSetValueHtml(this.isAddColor,h,q,m,d,g,a,30,b,f)}}else{h='<samp class="subTaxis" title="第'+(c+a+1)+'题">'+(c+a+1)+".</samp>";i+=this.getSetValueHtml(this.isAddColor,h,j,o,d,g,a,35,null,f)}else{h='<samp class="subTaxis" title="第'+(c+a+1)+'题">'+(c+a+1)+".</samp>";i+=this.getSetValueHtml(this.isAddColor,h,j,o,d,g,a,35,null,f)}}return i},changeValue:function(e,b,j,a,i){var h=$(e);h.removeClass("oneValueColor");if(!parseFloat(e.value))e.value=0;a=parseInt(a);var c=h.val(),g=TestDataManage.get题型名称(b),f,k,d;c=Math.round(c*10)/10;c=parseFloat(c);d=TestHashTable.get(j);Json子试题集合=d.子小题集合;_大题分值=parseInt(d.每小题分值);if(TestCommonSetManage.checkValueFlow(c)){e.value=0;return}if(Json子试题集合&&Json子试题集合.length!=0){TestDataManage.add添加子小题分值(b,a,c,i);f=TestDataManage.get试题的每小题分值(b,a);TestDataManage.getOneSubID(b,a,f);Json子试题集合[i].每小题分值=c;d.每小题分值=f}else{TestDataManage.getOneSubID(b,a,c);d.每小题分值=c}AddSubManage.refurbishSub(b,a);TestDivSetBox.ShowSubInforBox(g,TestDataManage.get分值By题型(b));TestCommonSetManage.setCurrentValue();if(a==0||a)TestCommonSetManage.viewOneSub(b,a,a+1);else TestCommonSetManage.viewSubList(b,g)},changeAllSubValue:function(){var i=this.allValueInput,a=TestSubjectTypeManage.subTypeIndex;if(!parseFloat(i[0].value))i[0].value=0;var b=this.allValueInput.val(),h=TestDataManage.get题型名称(a),k,e,g,d,j;b=Math.round(b*10)/10;b=parseFloat(b);if(TestCommonSetManage.checkValueFlow(b)){this.onFous(this.allValueInput,"allSubValue");return}for(var c=0;c<TestDataManage.get试题长度(a);c++){k=TestDataManage.getSubID(a,c);e=TestHashTable.get(k);d=e.子小题集合;if(d&&d.length!=0){for(var f=0;f<d.length;f++){TestDataManage.add添加子小题分值(a,c,b,f);d[f].每小题分值=b}g=TestDataManage.get试题的每小题分值(a,c);TestDataManage.getOneSubID(a,c,g);e.每小题分值=g}else{e.每小题分值=b;TestDataManage.getOneSubID(a,c,b)}}AddSubManage.refurbishSub(a,null);TestDivSetBox.ShowSubInforBox(h,TestDataManage.get分值By题型(a));j=this.allSubValueDiv.find("input");j.val(b);TestBoxyManage.setSetValueContent(a,null);TestCommonSetManage.viewSubList(a,h);this.closeSetAllSubValue()},showSetValuesBox:function(b,a){this.initSetValues(b,a);this.setValueBox.show()},closeSetValuesBox:function(){this.setTestContent.hide()},InitSetAllSub:function(){this.setAllSubBox=this.setAllSubBox||new Boxy("",{title:"设置每个试题分值",modal:true,show:0,closeText:false,beforeShow:function(){TestBoxyManage.setAllSubBoxContent();TestBoxyManage.allValueInput=$("#allSubValueID")},afterShow:function(){TestBoxyManage.allValueInput.focus()},afterHide:function(){TestCommonSetManage.setCurrentValue()}})},getAllSubBoxContent:function(){return'<div class="allSubVaule"><div class="allSub_V_Head">每题分值:<input id="allSubValueID" class="allSubValue" style="padding:0px 1px;"  onfocus="TestBoxyManage.onFous(this,\'allSubValue\');" maxlength="4" onblur="TestBoxyManage.onBlur(this);" onkeyup="TestBoxyManage.onkeyup(this)" value="0"  type="text" /></div><div class="allSub_V_Footer"><div class="allSub_V_F_Botton"><span class="btn1" style=" float:left;" ><span><input type="button" value="确定" onclick="TestBoxyManage.changeAllSubValue();" /></span></span><span class="btn2" style=" float:right;"><span><input type="button" value="取消" onclick="TestBoxyManage.closeSetAllSubValue()" /></span></span></div></div></div>'},setAllSubBoxContent:function(){this.setAllSubBox.setContent(this.getAllSubBoxContent())},showSetAllSubValue:function(a){if(TestDataManage.get试题长度(a)==0){alert("添加试题才可以设置分值");return}this.InitSetAllSub(a);this.setAllSubBox.show()},closeSetAllSubValue:function(){this.setAllSubBox.hide()},InitReferTest:function(){this.referTestBox=this.referTestBox||new Boxy('<div class="referBox" id="referBoxId"></div>',{title:"提交试卷",modal:true,show:0,closeText:"[关闭]",afterHide:function(){if(TestReferSever.isRefersh)TestCommonSetManage.refreshTest();else TestReferSever.isReFind&&TestCommonSetManage.hideFindSub()}});this.referDiv=$("#referBoxId")},showReferBox:function(){this.InitReferTest();this.referTestBox.show()},hideReferBox:function(){this.referTestBox.hide()}},FatherIframeSubManage={isNewAdd:false,subLen:0,add:function(a){var b=TestSubjectTypeManage.subTypeName,c=TestDataManage.题型Len,d=TestSubjectTypeManage.getOneSubType(c-1,a,true);b.children("div").removeClass("navCur");b.append(d);TestDivSetBox.ShowSubInforBox(a,0);AddSubManage.refurbishSub(c-1,null);if(!AddSubManage.dataJson==0){TestSubjectTypeManage.isInitFindSub=true;this.isNewAdd=true}ViewSubject.showViewSubBox(a,"")},receive:function(a){TestDataManage.add大题的集合(a);this.add(a)}},TestSubjectTypeManage={subTypeIndex:0,subTypeName:0,subjectViewId:0,isInit:false,isInitFindSub:false,intDivBox:function(){this.subTypeName=this.subTypeName||$("#AddSubTypeBox")},getOneSubType:function(b,a,c){var d=c?"navCur":"";if(c)this.subTypeIndex=b;_strSubTypeHtml='<div class="navSubTypeBox  navNor '+d+'"><span class="SubjectTypeSpan" ondblclick="TestSubjectTypeManage.DblclickSubjectTypeBox(this)" onclick="TestSubjectTypeManage.OnclikSubjectTypeSpan(this,\''+a+"','"+b+'\');"onmousemove="TestSubjectTypeManage.OnmousemoveSubTypeSpan(this);"   onmouseout="TestSubjectTypeManage.OnmouseoutSubTypeSpan(this);" title="双击该题型可以重命名" >'+(a.length>8?a.substring(0,8)+"...":a)+"("+TestDataManage.get试题长度(b)+')</span><samp class="SubjectTypeSamp"onclick="TestSubjectTypeManage.OnclikSubjectTypeSamp(this,\''+a+"','"+b+'\');"onmousemove="TestSubjectTypeManage.OnmousemoveSubTypeSamp(this);"   onmouseout="TestSubjectTypeManage.OnmouseoutSubTypeSamp(this);"   ><a class="SubjectTypeSet" href="javascript:void(0)" title="设置该题型" onclick="TestDivTier.show题型Tier(\''+b+'\');TestDivTier.set题型Site(this);"></a></samp><input class="SubjectTypeInput"  maxlength="10" onblur="TestSubjectTypeManage.OnblurSubjectTypeInput(this,\''+b+'\')" type="text" value="'+a+'" /></div>';return _strSubTypeHtml},refurbish:function(e){var b="",d,c=TestDataManage.content.试卷中大题集合;_len=c.length;for(var a=0;a<_len;a++){d=a==e?true:false;b+=this.getOneSubType(a,c[a].名称,d)}this.subTypeName.html(b)},initSubType:function(){this.intDivBox();var g=TestDataManage.content,b=g.试卷中大题集合,c=b.length;TestDataManage.题型Len=c;this.setSubType(b);if(c>0){var e=TestDataManage.get题型名称(0);TestDataManage.试题Len=TestDataManage.getEditSubLen();TestDivSetBox.ShowSubInforBox(e,TestDataManage.get分值By题型(0));for(var a=0;a<c;a++)for(var d=0;d<TestDataManage.get试题长度(a);d++){var f=b[a].试卷大题中试题集合[d];TestHashTable.put(f.试题内容ID,f)}AddSubManage.refurbishSub(0,null);TestCommonSetManage.viewSubList(0,e)}this.isInit=true},setSubType:function(c){this.subTypeName.html("");for(var b=c.length,a=0;a<b;a++)this.refurbish(b-a-1)},showDivBg:function(a){$(a).parent().addClass("navNor1")},removeDivBg:function(a){$(a).parent().removeClass("navNor1")},onclikDivShowBg:function(c,b,a){AddSubManage.isSubIndex=false;this.subTypeName.children("div").removeClass("navCur");$(c).parent("div").addClass("navCur");TestDivSetBox.setBox.children("div:eq(1)").children("span:eq(0)").text(b);this.subTypeIndex=a;AddSubManage.refurbishSub(a,null);if(!AddSubManage.dataJson==0){this.isInitFindSub=true;FatherIframeSubManage.isNewAdd=false}TestDivSetBox.ShowSubInforBox(TestDataManage.get题型名称(a),TestDataManage.get分值By题型(a));TestCommonSetManage.viewSubList(a,b)},OnmousemoveSubTypeSpan:function(a){var b=$(a);this.showDivBg(a);b.next("samp").children("a").show()},OnmouseoutSubTypeSpan:function(a){var b=$(a);this.removeDivBg(a);b.next("samp").children("a").hide()},OnmousemoveSubTypeSamp:function(a){var b=$(a);this.showDivBg(a);b.children().show()},OnmouseoutSubTypeSamp:function(a){var b=$(a);this.removeDivBg(a);b.children().hide()},OnclikSubjectTypeSpan:function(c,b,a){this.onclikDivShowBg(c,b,a);TestDivTier.isInit&&TestDivTier.hide()},OnclikSubjectTypeSamp:function(c,b,a){this.onclikDivShowBg(c,b,a)},ShowSubTypeSetBox:function(a,b){$("#"+b).show();$("#"+b).css("top",$(a).position().top);$("#"+b).css("left",$(a).position().left+$(a).outerWidth(true)-1)},DblclickSubjectTypeBox:function(c){var a=$(c);a.hide();var d=a.next("samp");d.hide();a.parent("div").css("padding-left","0px");var b=a.siblings("input");b.show();b.select()},OnblurSubjectTypeInput:function(d,b){var c=TestCommonSetManage.getReNameSubType(d,b),a=$(d);TestDataManage.reName大题的集合(b,c);ViewSubject.viewBoxType.text(c);TestSubjectTypeManage.refurbish(b);a.hide();a.parent("div").css("padding-left","5px");a.prev("span").show();a.prev("span").removeClass("SubjectTypeBoxShow")},renameSubtype:function(c,a){var b=TestCommonSetManage.getReNameSubType(c,a);$(c).removeClass("narCurTestSetInput");TestDataManage.reName大题的集合(a,b);ViewSubject.viewBoxType.text(b);TestSubjectTypeManage.refurbish(a)},renameExplain:function(d,b){var c=$(d),a=c.val();c.removeClass("testNarrateColor");a=TestDataManage.trim(a);TestDataManage.reName大题的说明(b,a);ViewSubject.viewBoxSub.text(TestCommonSetManage.interceptString(a,60));TestSubjectTypeManage.refurbish(b)},subTypeBoxClose:function(a){$(a).parent("div").hide()},subTypeBoxMoveUp:function(a){a=parseInt(a);for(var d=TestDataManage.题型Len,c=TestDataManage.content.试卷中大题集合,b=0;b<d;b++)if(b==a){if(c[b-1]){c.splice(b-1,2,c[b],c[b-1]);this.refurbish(a-1);TestDivTier.show题型Tier(a-1);AddSubManage.refurbishSub(a-1,null);TestCommonSetManage.viewSubList(a-1,c[a-1].名称)}break}},subTypeBoxMoveDown:function(a){a=parseInt(a);for(var d=TestDataManage.题型Len,c=TestDataManage.content.试卷中大题集合,b=0;b<d;b++)if(b==a){if(c[b+1]){c.splice(b,2,c[b+1],c[b]);this.refurbish(a+1);TestDivTier.show题型Tier(a+1);AddSubManage.refurbishSub(a+1,null);TestCommonSetManage.viewSubList(a+1,c[a+1].名称)}break}},subTypeBoxRemove:function(b){b=parseInt(b);for(var d=TestDataManage.题型Len,a=b==0?b:b-1,f="",c=0;c<d;c++)if(c==b){TestDataManage.Del大题的集合(c);this.refurbish(a);if(d>1){var e=TestDataManage.get题型名称(a);AddSubManage.refurbishSub(a,null);TestDivSetBox.setBox.children("div:eq(1)").children("span:eq(0)").text(e);TestDivSetBox.ShowSubInforBox(TestDataManage.get题型名称(a),TestDataManage.get分值By题型(a));TestCommonSetManage.setCurrentValue();TestCommonSetManage.viewSubList(a,e)}else if(d==1){TestDivSetBox.setBox.hide();ViewSubject.viewBox.html("");TestDivSetBox.setBox.parent().children("div").hide();TestCommonSetManage.hideFindSub()}else if(!AddSubManage.dataJson==0){AddSubManage.showFindSub(AddSubManage.dataJson);TestAddSortManage.IdFindSub.prev().children("a:eq(0)").click()}}},subTypeBoxRename:function(){}},TestDivSetBox={setBox:0,getAddSubject:function(){return'<div class="AddSubject"><a class="AddSubjctIco" href="javascript:void(0)" onclick="TestBoxyManage.showAddSubBox();">新增试题</a></div>'},getSubTypeNameAndCount:function(b,a){return'<div class="SubTypeAndCount"><span class="SuTypeName">'+b+'</span>总分<span class="Count">('+TestCommonSetManage.interceptString(a,6)+")</span></div>"},getSubTitleAndValues:function(){return'<div class="SubTitleAndValues"><span class="SubTitle">题干</span><span class="Values">分值</span></diiv>'},ShowSubInforBox:function(b,a){this.setBox=this.setBox||$("#AddSubBox");AddSubManage.subDivId=AddSubManage.subDivId||$("#SubContentId");_addSubHtml=this.getAddSubject()+this.getSubTypeNameAndCount(b,a)+this.getSubTitleAndValues();this.setBox.html(_addSubHtml).show();AddSubManage.subDivId.show()}},TestDivTier={isInit:false,tierBox:0,isInitSub:false,tierSubBox:0,initTier:function(){if(this.isInit)return;this.tierBox=$("<div>",{"class":"SubjectTools"}).appendTo("body");this.isInit=true},initSubTier:function(){if(this.isInitSub)return;this.tierSubBox=$("<div>",{"class":"SubjectTools"}).appendTo("body");this.isInitSub=true},hide:function(){this.tierBox.hide()},hideSubBox:function(){this.tierSubBox.hide()},getMoveUp:function(a){return'<span class="UpAndDownSpan UpAndSetSpan" style="padding-top:4px;"><a class="MoveUp" href="javascript:void(0)" title="上移该题型" onclick="TestSubjectTypeManage.subTypeBoxMoveUp(\''+a+"');\">上移</a></span>"},getMoveDown:function(a){return'<span class="UpAndDownSpan DownAndDelSpan" style="margin-top:2px;"><a class="MoveDown"  href="javascript:void(0)" title="下移该题型" onclick="TestSubjectTypeManage.subTypeBoxMoveDown(\''+a+"');\">下移</a></span>"},getCloseSubType:function(){return'<a class="Close"  href="javascript:void(0)" title="关闭题型设置框"  onclick="TestDivTier.hide();"></a>'},getDel题型:function(a){return'<span class="SetAndDel DownAndDelSpan DelSpan"><a class="DelSubject"  href="javascript:void(0)" title="删除该题型" onclick="TestBoxyManage.InitDelSubType(\''+a+"');\">删除题型</a></span>"},getSetCount:function(a){return'<span class="SetAndDel UpAndSetSpan Set"><a class="SetSubject" title="设置该题型分值"  onclick="TestBoxyManage.showSetValuesBox(\''+a+'\');"  href="javascript:void(0)" >设置分值</a></span>'},getOffset:function(b){var a=$(b);return{left:a.offset().left,top:a.offset().top}},set题型Site:function(b){var a=this.getOffset(b);a.left=a.left+20;a.top=a.top-4;this.tierBox.css(a)},show题型Tier:function(a){this.initTier();var b=this.getMoveUp(a)+this.getSetCount(a)+this.getCloseSubType(a)+this.getMoveDown(a)+this.getDel题型(a);this.tierBox.html(b).show();this.isInit=true},getSubMoveUp:function(b,a,c){return'<span class="UpAndDownSpan UpAndSetSpan" style="padding-top:4px;"><a class="MoveUp" href="javascript:void(0)" title="上移该试题" onclick="AddSubManage.subBoxMoveUp(\''+b+"', '"+a+"','"+c+"');\">上移</a></span>"},getSubMoveDown:function(b,a,c){return'<span class="UpAndDownSpan DownAndDelSpan" style="margin-top:2px;"><a class="MoveDown"  href="javascript:void(0)" title="下移该试题" onclick="AddSubManage.subBoxMoveDown(\''+b+"', '"+a+"','"+c+"');\">下移</a></span>"},getCloseSub:function(){return'<a class="Close"  href="javascript:void(0)" title="关闭试题设置框"  onclick="TestDivTier.hideSubBox();"></a>'},getDel试题:function(b,a,c){return'<span class="SetAndDel DownAndDelSpan DelSpan"><a class="DelSubject"  href="javascript:void(0)" title="删除该试题" onclick="TestBoxyManage.InitDelSub(\''+b+"', '"+a+"', '"+c+"');\">删除试题</a></span>"},getSubSetCount:function(b,a){return'<span class="SetAndDel UpAndSetSpan Set"><a class="SetSubject" title="设置该试题分值" onclick="TestBoxyManage.showSetValuesBox(\''+b+"', '"+a+'\')";  href="javascript:void(0)">设置分值</a></span>'},set试题Site:function(b){var a=this.getOffset(b);a.left=a.left+20;a.top=a.top-4;this.tierSubBox.css(a)},show试题Tier:function(b,a,c){this.initSubTier();var d=this.getSubMoveUp(b,a,c)+this.getSubSetCount(b,a)+this.getCloseSub(b,a)+this.getSubMoveDown(b,a,c)+this.getDel试题(b,a,c);this.tierSubBox.html(d).show();this.isInitSub=true}},TestOutsideManage={outsideInfoBox:0,sortList:0,_testTitle:0,_testCount:0,_testTime:0,_currentCount:0,currentValue:0,initBox:function(){var a=this;$("#TestSortID").tags({source:GlobalManage.clone(TestDataManage.outside.分类列表),inp_width:168,change:function(b){TestDataManage.outside.分类列表=GlobalManage.clone(b);a.editSort(TestDataManage.outside.分类列表)}})},initOutsideInfor:function(){this.outsideInfoBox=this.outsideInfoBox||$("#outsideInfoId");this._testTime=this.outsideInfoBox.next().children("span:eq(0)").children("label");this._testCount=this.outsideInfoBox.next().children("span:eq(1)").children("label");this._currentCount=this.outsideInfoBox.next().children("span:eq(2)").children("label");this.sortList=this.outsideInfoBox.next().children("span:eq(3)").children("label")},initSort:function(){this.initBox()},editSort:function(b){var a=TestCommonSetManage.sortHtml(b);this.sortList.html(a);this.sortList.attr("title",a)},editTestName:function(c){var b=$(c),a=b.val();b.removeClass("narCurTestSetInput");a=TestDataManage.trim(a);if(a=="")a="未设置";TestDataManage.edit试卷名称(a);this.outsideInfoBox.text(a)},editTestTime:function(b){if(!parseFloat(b.value))b.value=0;var c=$(b),a=c.val();c.removeClass("narCurTestSetInput");a=parseFloat(a);if(a>300||a<10){alert("考试时间的范围10-300分钟,请重新填写考试时间!");b.value=120;a=120}TestDataManage.edit考试时长(a);this._testTime.text(a)},editTestCount:function(b){if(!parseFloat(b.value))b.value=0;var c=$(b),a=c.val();c.removeClass("narCurTestSetInput");a=parseFloat(a);TestDataManage.edit试卷总分(a);this._testCount.text(a)},editTestPass:function(b){if(!parseFloat(b.value))b.value=0;var c=$(b),a=c.val();c.removeClass("narCurTestSetInput");a=parseFloat(a);if(a<0||a>100){alert("及格条件的范围0-100,请重新填写及格条件!");b.value=60;a=60}TestDataManage.edit及格条件(a)},editTestIsOpen:function(b){var a;if(b==1)a=true;else a=false;TestDataManage.edit是否公开(a)},editTestNarrate:function(c){var b=$(c),a=b.val();b.removeClass("testNarrateColor");a=TestDataManage.trim(a);TestDataManage.edit考试说明(a)}},TestAddSortManage={isInitAddSubPage:false,IdFindSub:0,initBox:function(){var a=this;$("#FindSubSortID").tags({source:GlobalManage.clone(TestDataManage.findSub.分类),inp_width:305,change:function(a){TestDataManage.findSub.分类=GlobalManage.clone(a)}});this.IdFindSub=this.IdFindSub||$("#ID_AddSub_Box");TestOutsideManage.initOutsideInfor()},switchTag:function(d,e,c){var a,b;a=a||"TagsSelect";b=$(d).parent().children();b.each(function(){$(this).removeClass(a)});$(d).addClass(a).blur();var b=$("#"+e).children();b.each(function(a){if(a==c){$(this).show();if(c==1)if(!TestAddSortManage.isInitAddSubPage){TestBoxyManage.AddSubLoadCss();$("#TestID").html(TestBoxyManage.getAddSubHtml());TestBoxyManage.loadAddSubJs();TestAddSortManage.isInitAddSubPage=true}}else $(this).hide()})},initSort:function(){this.initBox()}},IframeFindSubTypeManage={receive:function(a){this.setName(a)},setName:function(b){_listObj=TestDataManage.findSub,_listName=_listObj.题型名称,_len=_listName.length;for(var a=0;a<_len;a++)if(_len>0){_listName.splice(a,1);_listObj.题型名称.push(b);return}_listObj.题型名称.push(b)},editTestName:function(c){var b=$(c),a=b.val();b.removeClass("findSubContent");a=TestDataManage.trim(a);TestDataManage.findSub.试题内容=a},editIsFindSelf:function(a){TestDataManage.findSub.是否查找自己试题=$(a).attr("checked")}},MaskDivManage={_subMarkId:0,_saveLoadingId:0,showSubMaskDiv:function(){this._subMarkId=this._subMarkId||$("#subMaskID");this._subMarkId.block({message:'<h2><img src="/Content/Images/Base/loading-32.gif" style="vertical-align:middle"/> 正在获取数据,请稍后...</h2>',css:{backgroundColor:"#fff",cursor:"auto",width:"380px",height:"75px",fontSize:"13px",lineHeight:"70px"},overlayCSS:{backgroundColor:"#ccc",opacity:"0.5",cursor:"auto"}})},hideSubMarkDiv:function(){this._subMarkId.unblock()},showSaveTestDiv:function(){this._saveLoadingId=this._saveLoadingId||$("#loadingID");var b=this._saveLoadingId.parents().outerWidth(true),a=this._saveLoadingId.parents().outerHeight(true);this._saveLoadingId.css("display","block");this._saveLoadingId.width(b);this._saveLoadingId.height(a)},hideSaveTestDiv:function(){this._saveLoadingId.css("display","none")},getLoadingHtml:function(){return'<div class="C_E_L_Loading" align="center"">           <div class="C_E_L_LoadingIco"></div>           <div class="C_E_L_LoadingFont" style="margin-top:-130px; font-size:14px;"> Loading...</div>        </div>'}},AddSubManage={subDivId:0,isSubIndex:false,_subTypeIndex:0,objParDiv:0,_jsonData:0,dataJson:0,试题Json:0,subContentHtml:0,isFind:false,isChecked:false,isDisabled:false,isAllChecked:false,chsInput:0,isAddFckSub:false,getChecked:function(b,g,e,a){var f=a?"该试题已被引用":"选择/不选",d=e?"checked='checked'":"",c=a?"disabled='disabled'":"";return'<span class="commonFont AllChose" id="'+b+'0"  onclick="AddSubManage.receiveSub(this,\''+b+"','"+g+'\')"><input title="'+f+'" name="oneChecked" type="checkbox" style="margin-left:7px; margin-top:6px;*margin:0px;" onclick="this.checked=this.checked?false:true;" '+d+""+c+"/></span>"},getSubTitle:function(a,b){return'<label  for="'+b+'0" title="'+TestCommonSetManage.interceptString(a,100)+'" class="commonFont SubContent">'+TestCommonSetManage.interceptString(a,20)+"</label>"},getSortContent:function(b,c,a){return'<label for="'+b+'0" title="'+a.join(",")+'" class="commonFont SubSort">'+TestCommonSetManage.interceptString(a.join(","),16)+"</label>"},getSubTypeName:function(b,c,a){return'<label  for="'+b+'0" title="'+a+'" class="commonFont SubType">'+TestCommonSetManage.interceptString(a,8)+"</label>"},getCreatPeople:function(b,c,a){return'<label for="'+b+'0" title="'+a+'"class="commonFont">'+TestCommonSetManage.interceptString(a,6)+"</label>"},getCreatSubTime:function(b,c,a){return'<label for="'+b+'0" class="commonFont SubFontPreview">'+TestCommonSetManage.interceptString(a,10)+"</label>"},showFindSub:function(d){this.dataJson=d;if(this.dataJson==0)return;this._subTypeIndex=TestSubjectTypeManage.subTypeIndex;if(typeof d.subData=="string")d.subData=eval("("+d.subData+")");var b=d.subData;strSub=' <div id="SubHeaderID" class="SubTitleAndValues ShowAddSubHeadBox">      <span class="commonFont AllChose">选择</span>      <span class="commonFont SubContent">题干</span>      <span class="commonFont SubSort">所属分类</span>      <span class="commonFont SubType">题型</span>      <span class="commonFont">创建人</span>      <span class="commonFont SubPreview">创建时间</span> </div><div class="FindSubContentBox">';for(var a=0;a<b.length;a++){for(var n=TestDataManage.names["T"+b[a].试题内容Json.outside.小题型Enum],g=[],h,c=b[a].试题内容Json.outside.试题内容ID,l=b[a].试题内容Json.content.题干文本,k=b[a].试题内容Json.outside.创建人.昵称||b[a].试题内容Json.outside.创建人.姓名,m=b[a].试题内容Json.outside.创建时间,e=0;e<b[a].试题内容Json.outside.分类列表.length;e++){h=b[a].试题内容Json.outside.分类列表[e];g.push(h)}if(c==TestDataManage.getAllSubID(c)){this.isChecked=true;this.isDisabled=true;for(var f=0;f<TestDataManage.get试题长度(this._subTypeIndex);f++)if(c==TestDataManage.getSubID(this._subTypeIndex,f)){this.isDisabled=false;break}}else{this.isChecked=false;this.isDisabled=false}var j=this.isChecked?"subClickColor":"",i=this.isDisabled?"subDisabledColor":"";strSub+='<div class="FindSubContentBoxFont '+j+"  "+i+' " onmouseover="AddSubManage.onmouseoverFindSub(this);" >'+this.getChecked(c,a,this.isChecked,this.isDisabled)+this.getSubTitle(l,c,a)+this.getSortContent(c,a,g)+this.getSubTypeName(c,a,n)+this.getCreatPeople(c,a,k)+this.getCreatSubTime(c,a,m)+"</div>"}this.subContentHtml='<div class="AddSubContent">'+strSub+"</div>"+this.getSubPage(d)+"</div>";if(!this.isFind){TestAddSortManage.IdFindSub.prev().append('<a href="javascript:void(0)" onclick="TestAddSortManage.switchTag(this,\'ID_AddSub_Box\',2);" class="TagUnSelect">查询试题结果</a>');this.isFind=true}TestAddSortManage.IdFindSub.prev().children("a:eq(2)").click();TestAddSortManage.IdFindSub.children("div:eq(2)").html(this.subContentHtml);this._jsonData=b},getStartPage:function(){return'<a class="startPage" href="javascript:TestReferSever.getSubPageByPi(0)" >首页</a>'},getEndPage:function(a){return'<a class="startPage" href="javascript:TestReferSever.getSubPageByPi('+(a-1)+')">未页</a>'},getUpPage:function(a){return'<a style="margin:0px 20px 0px 4px;" href="javascript:TestReferSever.getSubPageByPi('+(a-1)+')">«　上一页</a>'},getDownPage:function(a){return'<a style="margin:0px 4px 0px 20px;" href="javascript:TestReferSever.getSubPageByPi('+(a+1)+')">下一页　»</a>'},getNumberPage:function(a,b){return'<a class="'+b+'"  href="javascript:TestReferSever.getSubPageByPi(\''+a+"')\">"+(a+1)+"</a>"},getSubPage:function(g){var c='<div class="SubPages">',d,b=Math.ceil(g.count/TestReferSever._pageSize),a=parseInt(TestReferSever._pageIndex);if(a<=1&&b>1){if(a==1)c+=this.getStartPage()+this.getUpPage(a);if(b<=5)for(var e=0;e<b;e++){d=a==e?"pagesBg":"";c+=this.getNumberPage(e,d)}else for(var f=0;f<5;f++){d=a==f?"pagesBg":"";c+=this.getNumberPage(f,d)}c+=d!=b-1?this.getDownPage(a)+this.getEndPage(b):""}else if(a>1&&b>1&&a!=b-1){c+=this.getStartPage()+this.getUpPage(a)+this.getNumberPage(a-2,null)+this.getNumberPage(a-1,null)+this.getNumberPage(a,"pagesBg")+this.getNumberPage(a+1,null);if(a!=b-2)c+=this.getNumberPage(a+2,null);c+=this.getDownPage(a)+this.getEndPage(b)}else if(a==b-1&&b>1)c+=this.getStartPage()+this.getUpPage(a)+this.getNumberPage(a-2,null)+this.getNumberPage(a-1,null)+this.getNumberPage(a,"pagesBg");else c+="";c+='<a class="startPage pageCount">第'+(a+1)+" / "+b+"页</a>";return c+="</div>"},getSubFontSpan:function(d,b,c,a){return'<span class="SubjectTypeSpan  SubjectSpan"onclick="AddSubManage.OnclikSubjectSpan(this,\''+TestSubjectTypeManage.subTypeIndex+"','"+d+"','"+a+'\');"onmousemove="TestSubjectTypeManage.OnmousemoveSubTypeSpan(this);"   onmouseout="TestSubjectTypeManage.OnmouseoutSubTypeSpan(this);"><samp class="subTaxis" title="第'+a+'题">'+a+".</samp>"+TestCommonSetManage.interceptString(b,16-(""+a).length)+'<span class="subValues">'+c+"分</span></span>"},getSubSetSamp:function(b,a){return'<samp class="SubjectTypeSamp"onclick="AddSubManage.OnclikSubjectSamp(this,\''+TestSubjectTypeManage.subTypeIndex+"','"+b+"','"+a+'\');"onmousemove="TestSubjectTypeManage.OnmousemoveSubTypeSamp(this);"   onmouseout="TestSubjectTypeManage.OnmouseoutSubTypeSamp(this);" > <a class="SubjectTypeSet" href="javascript:void(0)" title="设置该试题" onclick="TestDivTier.show试题Tier(\''+TestSubjectTypeManage.subTypeIndex+"','"+b+"','"+a+"');TestDivTier.set试题Site(this);\"></a></samp>"},getOneSubject:function(b,f,h,g,a){var i=h?"navCur":"",b=parseInt(b);if(!a){var e=TestSubjectTypeManage.subTypeIndex,a=0,c="";if(e>0){for(var d=0;d<e;d++){c+=TestDataManage.get试题长度(d);c=parseInt(c)}a=c+b+1}else a=b+1}_strSubHtml='<div class="navSubTypeBox navSubBox navNor '+i+'">'+this.getSubFontSpan(b,f,g,a)+this.getSubSetSamp(b,a)+"</div>";return _strSubHtml},receiveSub:function(c,a,f){var e=$(c),b,d=this.试题Json;_subContentHtml="",subTypeIndex=this._subTypeIndex;this.chsInput=e.children("input");this.objParDiv=$(c).parent("div");if(!this.chsInput.attr("checked")||this.isAddFckSub){this.chsInput.attr("checked",true);this.objParDiv.addClass("subClickColor");TestDataManage.add试题的集合(subTypeIndex,a);if(this.isAddFckSub){TestHashTable.put(a,d);this.isAddFckSub=false}else TestHashTable.put(a,this._jsonData[f]);b=TestHashTable.get(a).试题内容Json.content.题干文本;this.addSubject(b,subTypeIndex,a)}else{if(this.chsInput.attr("disabled")){this.chsInput.attr("title","该试题题已被引用");alert("该试题已经被其他题型引用,请重新选中其他试题,谢谢!!!");return}this.chsInput.attr("checked",false);this.objParDiv.removeClass("subClickColor");TestDataManage.del试题的集合(subTypeIndex,a);this.refurbishSub(subTypeIndex,null);TestCommonSetManage.viewSubList(subTypeIndex,"");TestSubjectTypeManage.refurbish(subTypeIndex)}},addSubject:function(l,a,n){this.subDivId.children("div").removeClass("navCur");var g,k,j,c,o="",b,p=TestSubjectTypeManage.subjectViewId,f,e,d="";g=TestDataManage.get试题长度(a);b=g-1;if(a>0){for(var h=0;h<=a;h++){d+=TestDataManage.get试题长度(h);d=parseInt(d)}e=d}else e=g;j=TestDataManage.get试题分值(a,b);k=this.getOneSubject(b,l,true,j,e);this.subDivId.append(k);f=TestHashTable.get(n);f.每小题分值=0;c=f.子小题集合;if(c){if(c.length!=0)for(var i=0;i<c.length;i++){var m=c[i].试题内容Json.content.ID;TestDataManage.add试题中子试题集合(a,b,m)}}else TestDataManage.content.试卷中大题集合[a].试卷大题中试题集合[b].子小题集合=null;ViewLibSubject.getItemHtml(0,f,e,function(a){ViewSubject.viewBoxCsh.show();if(AddSubManage.isSubIndex)ViewSubject.viewBoxCsh.children().html(a);else ViewSubject.viewBoxCsh.children().append(a)},false,false,false);TestSubjectTypeManage.refurbish(a)},AddSubJson:function(a,o){var b,j,c,d,m=$("#SubHeaderID").next().children("div:eq(0)").children("span"),p=a.试题内容Json.content.题干文本,g=a.试题内容Json.content.试题外部信息ID,i=a.试题内容Json.content.ID,k=TestHashTable.get(i),l=TestHashTable.get(g);if(k==undefined){if(l==undefined)TestHashTable.put(g,a);else{var f=this._subTypeIndex,h=TestDataManage.content.试卷中大题集合[f].试卷大题中试题集合,n=h.length-1;h.splice(n,1);TestDataManage.试题Len--;this.refurbishSub(f,null)}this.试题Json=a;this.isAddFckSub=true;j=a.试题内容Json.outside.小题型Enum;b=TestDataManage.findSub.题型名称;_len=b.length;for(var e=0;e<_len;e++)_len>0&&b.splice(e,1);b.push(j);this.receiveSub(m,i,null);TestReferSever.ajaxFindSub(2);c=true;d="您已成功添加试题到试卷中!"}else{c=false;d="该试题已经添加到试卷中,请重新添加!"}o({result:c,info:d})},refurbishSub:function(b,h){for(var e="",f,g,d,c,a=0;a<TestDataManage.get试题长度(b);a++){g=a==h?true:false;f=TestDataManage.getSubID(b,a);c=TestHashTable.get(f).试题内容Json.content.题干文本;d=TestDataManage.get试题分值(b,a);e+=this.getOneSubject(a,c,g,d,null)}this.subDivId.html(e)},onmouseoverFindSub:function(a){$(a).addClass("subOverColor");$(a).bind("mouseout",function(){$(this).removeClass("subOverColor")})},onclikDivShowSubBg:function(d,a,c,e){var b=parseInt(c);this.isSubIndex=true;this.subDivId.children("div").removeClass("navCur");$(d).parent("div").addClass("navCur");TestCommonSetManage.viewOneSub(a,b,e)},OnclikSubjectSpan:function(c,a,b,d){this.onclikDivShowSubBg(c,a,b,d);TestDivTier.isInitSub&&TestDivTier.hideSubBox()},OnclikSubjectSamp:function(c,a,b,d){this.onclikDivShowSubBg(c,a,b,d)},subBoxMoveUp:function(a,c,e){c=parseInt(c);e=parseInt(e);a=parseInt(a);for(var f=TestDataManage.get试题长度(a),d=TestDataManage.get试题集合(a),b=0;b<f;b++)if(b==c){if(d[b-1]){d.splice(b-1,2,d[b],d[b-1]);this.refurbishSub(a,c-1);TestDivTier.show试题Tier(a,c-1,e-1);TestCommonSetManage.viewOneSub(a,c-1,e-1)}break}},subBoxMoveDown:function(a,c,e){c=parseInt(c);a=parseInt(a);e=parseInt(e);for(var f=TestDataManage.get试题长度(a),d=TestDataManage.get试题集合(a),b=0;b<f;b++)if(b==c){if(d[b+1]){d.splice(b,2,d[b+1],d[b]);this.refurbishSub(a,c+1);TestDivTier.show试题Tier(a,c+1,e+1);TestCommonSetManage.viewOneSub(a,c+1,e+1)}break}},subBoxRemove:function(a,d,c){var b=parseInt(d),f=TestDataManage.get题型名称(a),e;a=parseInt(a);c=parseInt(c);if(d==0){c=c;b=b}else{c=c-1;b=b-1}e=TestDataManage.get试题长度(a);var g=TestDataManage.getSubID(a,d);TestDataManage.del试题的集合(a,g);AddSubManage.showFindSub(AddSubManage.dataJson);this.refurbishSub(a,b);TestSubjectTypeManage.refurbish(a);TestDivTier.show试题Tier(a,b);TestDivSetBox.ShowSubInforBox(f,TestDataManage.get分值By题型(a));TestCommonSetManage.setCurrentValue();if(e>1)TestCommonSetManage.viewOneSub(a,b,c);else ViewSubject.viewBoxCsh.children().html("")}},TestReferSever={isRefersh:false,isReFind:false,userId:0,testData:{content:0,ouside:0},equalInfo:{_isConten:false,_isOutside:false,_isSort:false},_pageIndex:0,_pageSize:15,_subContent:0,_sort:0,_subType:0,testContent:{},_sortList:[],isShowChooseBox:false,ajaxFindSub:function(c){var a=TestDataManage.findSub;this._subContent=a.试题内容;this._sort=a.分类;this._subType=a.题型名称;this._isFindSelf=a.是否查找自己试题;this._pageIndex=0;this.userId=this.userId||GlobalManage.get_cookie_uid();this._sortList=[];for(var b=0;b<this._sort.length;b++)this._sort[b]!=""&&this._sortList.push(this._sort[b]);MaskDivManage.showSubMaskDiv();$.ajax({type:"POST",url:LKConfig.URLAssembly.Test.Server.get("FindSubject"),data:{action:"findSubject",subContent:this._subContent,sortJson:this._sortList,subType:this._subType,isFindSelf:this._isFindSelf,pageIndex:this._pageIndex,pageSize:this._pageSize,userID:this.userId},timeout:2e4,dataType:"json",success:function(a){MaskDivManage.hideSubMarkDiv();if(a.result){AddSubManage.showFindSub(a);c==2&&TestAddSortManage.IdFindSub.prev().children("a:eq(1)").click()}else TestReferSever.setReferBox("unFinishFindSub","unFinish",a.info)},error:function(c,b,a){MaskDivManage.hideSubMarkDiv();TestReferSever.testError(c,b,a)}})},getSubPageByPi:function(a){a=parseInt(a);this._pageIndex=a;MaskDivManage.showSubMaskDiv();$.ajax({type:"POST",url:LKConfig.URLAssembly.Test.Server.get("FindSubject"),data:{action:"findSubject",subContent:this._subContent,sortJson:this._sortList,subType:this._subType,isFindSelf:this._isFindSelf,pageIndex:this._pageIndex,pageSize:this._pageSize,userID:this.userId},timeout:2e4,dataType:"json",success:function(a){MaskDivManage.hideSubMarkDiv();if(a.result){AddSubManage.showFindSub(a);if(a.subData.length==0){TestReferSever.isReFind=true;TestReferSever.setReferBox("unFinishFindSub","unFinish","没有找到符合条件的试题!")}}else TestReferSever.setReferBox("unFinishFindSub","unFinish",a.info)},error:function(c,b,a){MaskDivManage.hideSubMarkDiv();TestReferSever.testError(c,b,a)}})},getReferHead:function(a){switch(a){case"newTest":return"新增试卷已保存成功，你可以继续执行以下操作:";break;case"newDraft":return"新增草稿已保存成功，你可以继续执行以下操作:";break;case"editTest":return"修改试卷已保存成功，你可以继续执行以下操作:";break;case"editDraf":return"修改草稿已保存成功，你可以继续执行以下操作:";break;case"unFinishTest":return"提交试卷失败,请查看以下原因,更改后再提交:";break;case"unFinishDraft":return"保存草稿失败,请查看以下原因,更改后再提交:";break;case"unFinishFindSub":return"查询试题失败,请查看以下原因,更改后再提交:";break;case"timeOut":return"提交试卷已超时，你可以点击下面的按钮'重新提交'.";break;case"thrown":return"";break;default:return""}},getReferContent:function(b,a){switch(b){case"checkWait":return"";break;case"unFinish":return a;break;case"referLink":return a;break;case"unUpdate":return TestCommonSetManage.getIcoFont("您还没有做任何的修改,请修改内容后再提交");break;case"timeOut":return this.getLink("重新提交","");break;case"thrown":return"提交试卷发生异常，检测到以下异常信息."}},setReferBox:function(c,b,d){var a='<div class="referHeader">'+this.getReferHead(c)+'</div><div class="referInfor">'+this.getReferContent(b,d)+"</div>";TestBoxyManage.showReferBox();TestBoxyManage.referDiv.html(a)},getLink:function(d,b,a){var c='<a class="linkFont" href="'+b+'"  target="'+a+'" >'+d+"</a>";return TestCommonSetManage.getIcoFont(c)},newTestReferHtml:function(b,a){return this.getLink("预览该试卷",LKConfig.URLAssembly.Test.Page.get("ViewTest")+a+LKConfig.URLAssembly.Test.Page.get("isAddSuffix"),"_blank")+this.getLink("新增试卷",LKConfig.URLAssembly.Test.Page.get("NewTest"),"_parent")+this.getLink("修改该试卷",LKConfig.URLAssembly.Test.Server.get("EditExam")+"?guid="+b+"","_parent")+this.getLink("查看自己新添加的试卷",LKConfig.URLAssembly.Test.Page.get("MyNormalTest"),"_blank")},newDraftReferHtml:function(b,a){return this.getLink("预览该草稿",LKConfig.URLAssembly.Test.Page.get("ViewTest")+a+LKConfig.URLAssembly.Test.Page.get("isAddSuffix"),"_blank")+this.getLink("新增试卷",LKConfig.URLAssembly.Test.Page.get("NewTest"),"_parent")+this.getLink("修改该草稿",LKConfig.URLAssembly.Test.Server.get("EditExam")+"?guid="+b+"","_parent")+this.getLink("查看自己新添加的草稿",LKConfig.URLAssembly.Test.Page.get("MyDraftTest"),"_blank")},editTestReferHtml:function(b,a){return this.getLink("预览该试卷",LKConfig.URLAssembly.Test.Page.get("ViewTest")+a+LKConfig.URLAssembly.Test.Page.get("isAddSuffix"),"_blank")+this.getLink("新增试卷",LKConfig.URLAssembly.Test.Page.get("NewTest"),"_parent")+this.getLink("修改该试卷",LKConfig.URLAssembly.Test.Server.get("EditExam")+"?guid="+b+"","_parent")+this.getLink("查看自己已添加的试卷",LKConfig.URLAssembly.Test.Page.get("MyNormalTest"),"_blank")},editDraftReferHtml:function(b,a){return this.getLink("预览该草稿",LKConfig.URLAssembly.Test.Page.get("ViewTest")+a+LKConfig.URLAssembly.Test.Page.get("isAddSuffix"),"_blank")+this.getLink("新增试卷",LKConfig.URLAssembly.Test.Page.get("NewTest"),"_parent")+this.getLink("修改该草稿",LKConfig.URLAssembly.Test.Server.get("EditExam")+"?guid="+b+"","_parent")+this.getLink("查看自己已添加的草稿",LKConfig.URLAssembly.Test.Page.get("MyDraftTest"),"_blank")},testError:function(c,a){switch(a){case"timeout":this.setReferBox("timeout","timeout",null);break;default:this.setReferBox("thrown","thrown","对不起,未检测到任何异常信息！")}},testFail:function(a){this.setReferBox("unFinishTest","unFinish",a.info)},showChooseRefer:function(c){var a=$(c),b=a.parent().next();if(!this.isShowChooseBox){a.addClass("C_E_L_I_H_T_R_Right1");b.show();this.isShowChooseBox=true}else{a.removeClass("C_E_L_I_H_T_R_Right1");b.hide();this.isShowChooseBox=false}},isHaveNull:function(){for(var b=TestDataManage.outside.分类列表,c=b.length,a=0;a<c;a++)if(TestCommonSetManage.isEmptyOrNull(""+b[a]+"","试卷设置中:分类组的第"+(a+1)+"个分类名为空"))return false;return TestCommonSetManage.isEmptyOrNull(""+TestDataManage.get试卷的名称()+"","试卷设置中:试卷的名称为空")?false:TestCommonSetManage.isEmptyOrNull(""+TestDataManage.get考试时长()+"","试卷设置中:试卷的考试时长为空")?false:TestCommonSetManage.isEmptyOrNull(""+TestDataManage.get试卷总分()+"","试卷设置中:试卷的总分为空")?false:TestCommonSetManage.isEmptyOrNull(""+TestDataManage.get及格条件()+"","试卷设置中:试卷及格分数为空")?false:TestCommonSetManage.isEmptyOrNull(""+TestDataManage.题型Len+"","新增题型为空")?false:TestCommonSetManage.isEmptyOrNull(""+TestDataManage.试题Len+"","新增试题为空")?false:TestCommonSetManage.checkSubValue()?false:TestCommonSetManage.countIsEques()?false:true},checkContent:function(a){if(a)this.testData.content=TestDataManage.content;else this.testContent.content=null},checkOutside:function(a,b){if(!a){this.testData.ouside=TestDataManage.outside;if(!b)this.testData.ouside.分类列表=[]}else this.testData.ouside=TestDataManage.outside},isTestSame:function(){var c=this.equalInfo,a=TestEqualManage.changeContent(TestDataManage.content),b=TestEqualManage.changeOutside(TestDataManage.outside),d=TestEqualManage.changeSort(TestDataManage.get分类列表());if(!a&&!b){TestReferSever.setReferBox("unFinishTest","unUpdate",null);return false}else{c._isConten=a;c._isOutside=b;c._isSort=d;this.checkContent(a);this.checkOutside(b,d);return true}},getTestJsonData:function(b,c){var a;a=TestDataManage.jsonToText({content:b,outside:c});return a},isNewOrDraft:function(a){if(a==0){if(!this.isHaveNull())return}else if(TestCommonSetManage.isEmptyOrNull(""+TestDataManage.get试卷的名称()+"","试卷设置中:试卷的名称为空"))return;TestDataManage.SetTestState(a);TestDataManage.addOutsideID(TestDataManage.getGuid());TestDataManage.addContentID(TestDataManage.getGuid());this.ajaxSaveTest(a)},ajaxIsNew:function(a){if(!GlobalManage.get_cookie_uid()){TestReferSever.setReferBox("unFinishTest","unFinish","你还没登陆爱考在线考试系统!");return}else if(TestPageManage.isNew){TestDataManage.AddReferID(GlobalManage.get_cookie_uid());this.isNewOrDraft(a)}else{if(!this.isTestSame())return;TestDataManage.AddReferID(GlobalManage.get_cookie_uid());switch(a){case"4":this.ajaxEditDraft();break;default:if(!this.isHaveNull())return;this.ajaxEditTest()}}},ajaxSaveTest:function(a){MaskDivManage.showSaveTestDiv();$.ajax({type:"POST",action:"SaveTest",url:LKConfig.URLAssembly.Test.Server.get("SaveTest"),data:{testContent:this.getTestJsonData(TestDataManage.content,TestDataManage.outside)},dataType:"json",success:function(b){if(b.result){MaskDivManage.hideSaveTestDiv();var d=TestDataManage.get试卷的ID(),c=TestDataManage.content.ID;TestReferSever.isRefersh=true;if(a==0)TestReferSever.setReferBox("newTest","referLink",TestReferSever.newTestReferHtml(d,c));else TestReferSever.setReferBox("newDraft","referLink",TestReferSever.newDraftReferHtml(d,c))}else{MaskDivManage.hideSaveTestDiv();if(a==0)TestReferSever.setReferBox("unFinishTest","unFinish",b.info);else TestReferSever.setReferBox("unFinishDraft","unFinish",b.info)}},error:function(d,c,b){MaskDivManage.hideSaveTestDiv();TestReferSever.testError(d,c,b,function(){TestReferSever.ajaxSaveTest(a)})}})},ajaxGetTest:function(c,b){TestPageManage.initIntegerID.parent().append(MaskDivManage.getLoadingHtml());var a;if(b==2){a="GetRandomTest";TestPageManage.isNew=true}else a="GetNormalTest";$.ajax({type:"POST",url:LKConfig.URLAssembly.Test.Server.get(a),data:{action:a,guid:c},dataType:"json",success:function(a){if(a.result){if(typeof a.info=="string")a.info=eval("("+a.info+")");TestEqualManage.cloneData(a.info);TestPageManage.initIntegerID.show();a.info.outside.试卷状态Enum==0&&$("#SaveTypeID").children("a:eq(1)").hide();TestPageManage.initIntegerID.next().html("")}else TestReferSever.setReferBox("unFinishTest","unFinish",a.info)},error:function(c,b,a){TestPageManage.initIntegerID.next().html("");TestReferSever.testError(c,b,a)}})},ajaxEditTest:function(){MaskDivManage.showSaveTestDiv();TestDataManage.addContentID(TestDataManage.getGuid());$.ajax({type:"POST",url:LKConfig.URLAssembly.Test.Server.get("EditTest"),data:{action:"EditTest",试卷状态:this.testData.ouside.试卷状态Enum,editTestContent:this.getTestJsonData(this.testData.content,this.testData.ouside)},dataType:"json",success:function(a){MaskDivManage.hideSaveTestDiv();if(a.result){TestReferSever.isRefersh=true;TestReferSever.setReferBox("editTest","referLink",TestReferSever.editTestReferHtml(TestDataManage.outside.ID,TestDataManage.content.ID))}else TestReferSever.setReferBox("unFinishTest","unFinish",a.info)},error:function(c,b,a){MaskDivManage.hideSaveTestDiv();TestReferSever.testError(c,b,a)}})},ajaxEditDraft:function(){MaskDivManage.showSaveTestDiv();$.ajax({type:"POST",url:LKConfig.URLAssembly.Test.Server.get("EditDraft"),data:{action:"EditDraft",editDraftContent:this.getTestJsonData(this.testData.content,this.testData.ouside)},dataType:"json",success:function(a){MaskDivManage.hideSaveTestDiv();if(a.result){TestReferSever.isRefersh=true;TestReferSever.setReferBox("editTest","referLink",TestReferSever.editDraftReferHtml(TestDataManage.outside.ID,TestDataManage.content.ID))}else TestReferSever.setReferBox("unFinishDraft","unFinish",a.info)},error:function(c,b,a){MaskDivManage.hideSaveTestDiv();TestReferSever.testError(c,b,a)}})}},ViewSubject={viewBox:0,viewBoxCsh:0,viewBoxType:0,viewBoxSub:0,getViewSubHead:function(b,a){return'<div class="C_E_L_I_C_R_C_Title"><div class="C_E_L_I_C_R_C_T_SubType">'+b+'</div><div class="C_E_L_I_C_R_C_T_Explain">说明:（<label title="'+a+'" style="color:#369;">'+TestCommonSetManage.interceptString(a,60)+"</label>）</div></div>"},getViewSubContent:function(){return'<div class="C_E_L_I_C_R_C_Content"><div class="C_E_L_I_C_R_C_Font"></div></div>'},showViewSubBox:function(c,b){this.viewBox=this.viewBox||$("#subViewID");var a='<div class="C_E_L_I_C_R_Content">'+this.getViewSubHead(c,b)+this.getViewSubContent()+"</div>";this.viewBox.html(a);this.viewBoxCsh=this.viewBox.children().children("div:eq(1)");this.viewBoxType=this.viewBoxCsh.prev().children("div:eq(0)");this.viewBoxSub=this.viewBoxType.next().children()}}