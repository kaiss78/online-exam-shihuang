$(document).ready(function(){PageManage&&PageManage.ready()});var PageManage={masks:0,ready:function(){this.masks=$("#ID_Masks_Box");IFrameQuestionTypesManage.initQuestionBox();HtmlManage.initDivEle();IFrameFckEditor.initBoxy();$.ajaxSetup({timeout:6e4})},complete:function(){this.setUrlArg()},masksDiv:function(a){this.masks.fadeOut("normal",function(){IFrameQuestionTypesManage.switchTypes(a)})},setUrlArg:function(){var a=GlobalManage.getUrlArg(),c=a.sname,d="",b=a.guid,e=a.xtbj,g=Global.URL.js("CreateExam.js"),f=g.TestUse=="true";if(typeof c!="undefined")SetManage.outside.分类列表[0].分类名=unescape(c);if(typeof d!="undefined")SetManage.outside.分类列表[0].类型=unescape(d);if(typeof e!="undefined"&&e=="true")BaseManage.is协同编辑=true;if(!f&&typeof b!="undefined"&&b.length==36)ReferServer.ajaxGetData(b,function(){PageManage.masksDiv(false)});else{this.masksDiv(true);IFrameQuestionTypesManage.receive("11")}}},HashTable={data:{},put:function(b,a){this.data[b]=a},"get":function(a){return this.data[a]},updata:function(b,a){this.data[b]=a},remove:function(a){delete this.data[a]},clear:function(){this.data={}}},BaseManage={guidTeam:0,mark:0,isNew:true,names:"",is协同编辑:false},SetManage={sort:{min:1,max:15},option:{T11:{min:2,max:10},T12:{min:2,max:10},T14:{min:3,max:20},T15:{min:2,max:4},T8011:{min:2,max:10}},getOptionMax:function(a){return this.option["T"+a].max},getOptionMin:function(a){return this.option["T"+a].min},space:{T13:{min:1,max:20},T14:{min:1,max:15},T15:{min:1,max:25}},getSpaceMax:function(a){return this.space["T"+a].max},getSpaceMin:function(a){return this.space["T"+a].min},blank:{T13:{min:1,max:3}},getBlankMax:function(a){return this.blank["T"+a].max},getBlankMin:function(a){return this.blank["T"+a].min},link:{Left:{min:2,max:10},Right:{min:1,max:10},Answer:{min:1,max:10}},names:{T10:"自由题",T11:"单选题",T12:"多选题",T13:"填空题",T14:"选词填空",T15:"完形填空",T20:"判断题",T30:"连线题",T40:"复合题",T41:"诗词鉴赏",T42:"阅读理解",T43:"快速阅读",T44:"文言文",T45:"现代文",T46:"材料分析",T47:"案例分析",T50:"改错题",T60:"问答题",T61:"简答题",T62:"论述题",T63:"翻译题",T64:"计算题",T65:"作文题",T66:"案例题",T67:"材料题",T68:"推理题",T69:"名词解释",T80:"多题干共选项题",T8011:"单选题"},getNames:function(a){return this.names["T"+a]||"没有找到题型名称"},compose:{T11:["题干文本","选项列表","答案ID"],T12:["题干文本","选项列表","答案列表"],T13:["题干文本","填空空格集合"],T14:["题干文本","选项组","选词空格集合"],T15:["题干文本","单选空格集合"],T20:["题干文本","答案"],T30:["题干文本","连线题左选项集合","连线题右选项集合","连线题答案集合"],T40:["题干文本","子小题集合"],T60:["题干文本","答案"],T80:["题干文本","子小题集合","选项组集合"],T8011:["题干文本","答案ID","选项集合"]},outside:{分类列表:[{分类名:"",类型:""},{分类名:"",类型:""}],小题型Enum:"",是否公开:true,试题状态Enum:0,难易度:.5,答题人数:0},content:{T10:"{}",T11:'{ "小题型Enum": "11", "题干HTML": "", "题干文本": "", "解题思路": "", "答案ID": null,"选项列表": [{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": ""}]}',T12:'{ "小题型Enum": "12", "题干HTML": "", "题干文本": "", "解题思路": "", "答案列表": [],"选项列表": [{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" }]}',T13:'{ "小题型Enum": "13", "题干HTML": "", "题干文本": "", "解题思路": "", "填空空格集合": []}',T14:'{ "小题型Enum": "14", "题干HTML": "", "题干文本": "", "解题思路": "","选词空格集合": [], "选项组": { "选项集合": [{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": ""}]}}',T15:'{ "小题型Enum": "15", "题干HTML": "", "题干文本": "", "解题思路": "","单选空格集合": [] }',T20:'{ "小题型Enum": "20", "题干HTML": "", "题干文本": "", "解题思路": "","答案": null }',T30:'{ "小题型Enum": "30", "题干HTML": "", "题干文本": "", "解题思路": "","连线题左选项集合": [{ "选项内容HTML": "", "选项内容文本": "", "ID": "" }, { "选项内容HTML": "", "选项内容文本": "", "ID": ""}],"连线题右选项集合": [{ "选项内容HTML": "", "选项内容文本": "", "ID": "" }, { "选项内容HTML": "", "选项内容文本": "", "ID": ""}],"连线题答案集合": [{ "连线题左选项ID": null, "连线题右选项ID": null }, { "连线题左选项ID": null, "连线题右选项ID": null}]}',T40:'{ "小题型Enum": "40", "题干HTML": "", "题干文本": "", "子小题集合": [], "解题思路": "" }',T41:'{ "小题型Enum": "41", "题干HTML": "", "题干文本": "", "子小题集合": ["11","11","13","13","60","60"], "解题思路": "" }',T42:'{ "小题型Enum": "42", "题干HTML": "", "题干文本": "", "子小题集合": ["11","11","11","11","11"], "解题思路": "" }',T43:'{ "小题型Enum": "43", "题干HTML": "", "题干文本": "", "子小题集合": ["11","11","11","11","11","11","11","13","13","13"], "解题思路": "" }',T44:'{ "小题型Enum": "44", "题干HTML": "", "题干文本": "", "子小题集合": ["11", "12", "13", "60"], "解题思路": "" }',T45:'{ "小题型Enum": "45", "题干HTML": "", "题干文本": "", "子小题集合": ["11", "12", "13", "60"], "解题思路": "" }',T46:'{ "小题型Enum": "46", "题干HTML": "", "题干文本": "", "子小题集合": ["11", "12", "13", "60"], "解题思路": "" }',T47:'{ "小题型Enum": "47", "题干HTML": "", "题干文本": "", "子小题集合": ["11", "12", "13", "60"], "解题思路": "" }',T50:"{}",T60:'{ "小题型Enum": "60", "题干HTML": "", "题干文本": "", "解题思路": "", "答案": "" }',T61:'{ "小题型Enum": "61", "题干HTML": "", "题干文本": "", "解题思路": "", "答案": "" }',T62:'{ "小题型Enum": "62", "题干HTML": "", "题干文本": "", "解题思路": "", "答案": "" }',T63:'{ "小题型Enum": "63", "题干HTML": "", "题干文本": "", "解题思路": "", "答案": "" }',T64:'{ "小题型Enum": "64", "题干HTML": "", "题干文本": "", "解题思路": "", "答案": "" }',T65:'{ "小题型Enum": "65", "题干HTML": "", "题干文本": "", "解题思路": "", "答案": "" }',T66:'{ "小题型Enum": "66", "题干HTML": "", "题干文本": "", "解题思路": "", "答案": "" }',T67:'{ "小题型Enum": "67", "题干HTML": "", "题干文本": "", "解题思路": "", "答案": "" }',T68:'{ "小题型Enum": "68", "题干HTML": "", "题干文本": "", "解题思路": "", "答案": "" }',T69:'{ "小题型Enum": "69", "题干HTML": "", "题干文本": "", "解题思路": "", "答案": "" }',T80:'{ "小题型Enum": "80", "题干HTML": "", "题干文本": "", "解题思路": "", "子小题集合": ["8011", "8011", "8011"], "选项组集合": [] }',T8011:'{ "小题型Enum": "8011", "题干HTML": "", "题干文本": "","解题思路": "", "答案ID": null, "选项组ID": "","选项集合": [{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" },{ "选项内容HTML": "", "选项内容文本": "", "ID": "" }]}'}},HandleTip={fullMsgBox:0,recogMsg:0,helpMsgBox:0,maskLayer:0,showMaskLayer:function(){var a=$(document),b={width:a.width(),height:a.height()};this.maskLayer=$('<div class="maskLayer"></div>').appendTo("body");this.maskLayer.css(b)},hideMaskLayer:function(){var a=this.maskLayer;a&&a.remove()},initFullMsg:function(){this.fullMsgBox=this.fullMsgBox||new MsgBox("",{isTipMsg:false,isAutoHide:true,bgColor:"#ffffcd",timeOut:2e3})},setFullMsgCont:function(a){this.fullMsgBox.setContent(a)},showFullMsg:function(){this.fullMsgBox.show()},hideFullMsg:function(){this.fullMsgBox.hide()},setFullMsgSite:function(c,b){var a=DataManage.getOffset(c);switch(b){case"11":case"12":a.left+=130;a.top-=6;break;case"13":a.left+=95;a.top-=4;break;case"14":a.left+=130;a.top-=45;break;case"15":a.left+=100;a.top-=4;break;case"8011":a.left-=260;a.top+=40;break;case"sort":a.left+=70;a.top-=6}this.fullMsgBox.moveElem(a)},getFullMsgNum:function(a){return'<span class="handleT_c_t_num">'+a+"</span>个"},getFullMsgInner:function(a){return'<div class="handleT_c_T11">'+a+"</div>"},getFullOptionCont:function(a){return SetManage.getNames(a)+"—选项个数不能超过"+this.getFullMsgNum(SetManage.getOptionMax(a))},getFullBlankCont:function(a){return SetManage.getNames(a)+"—答案个数不能超过"+this.getFullMsgNum(SetManage.getBlankMax(a))},getFullSortCont:function(){return'分类个数不能超过<span class="handleT_c_t_num">'+SetManage.sort.max+"</span>个"},fullMsg:function(c,b){var a;switch(b){case"11":case"12":case"14":case"15":case"8011":a=this.getFullOptionCont(b);break;case"13":a=this.getFullBlankCont(b);break;case"sort":a=this.getFullSortCont(b);break;default:a="没有找到相关项"}a=this.getFullMsgInner(a);this.initFullMsg();this.setFullMsgCont(a);this.setFullMsgSite(c,b);this.showFullMsg()},fullMsgT30Site:function(c,b){var a=DataManage.getOffset(c);switch(b){case"Left":a.left+=127;a.top-=52;break;case"Right":a.left-=60;a.top-=52;break;case"Answer":a.left-=247;a.top-=52}this.fullMsgBox.moveElem(a)},fullMsgT30Cont:function(b){var a;switch(b){case"Left":a="连线题—左选框选项个数不能超过"+this.getFullMsgNum(SetManage.link.Left.max);break;case"Right":a="连线题—右选框选项个数不能超过"+this.getFullMsgNum(SetManage.link.Right.max);break;case"Answer":a="连线题—答案栏个数不能超过"+this.getFullMsgNum(SetManage.link.Answer.max);break;default:a="没有找到相关项"}a=this.getFullMsgInner(a);this.setFullMsgCont(a)},fullMsgT30:function(b,a){this.initFullMsg();this.fullMsgT30Cont(a);this.fullMsgT30Site(b,a);this.showFullMsg()},fullMsgSpaceSite:function(b){var a=DataManage.getOffset(b);a.left+=180;a.top-=3;this.fullMsgBox.moveElem(a);this.fullMsgBox.setIndex(1600)},fullMsgSpaceCont:function(b){var a;switch(b){case"13":case"14":case"15":a=SetManage.getNames(b)+"—空格个数不能超过"+this.getFullMsgNum(SetManage.getSpaceMax(b));break;default:a="没有找到相关项"}a=this.getFullMsgInner(a);this.setFullMsgCont(a)},fullMsgSpace:function(b,a){this.initFullMsg();this.fullMsgSpaceCont(a);this.fullMsgSpaceSite(b);this.showFullMsg()},initRecogMsg:function(){this.recogMsg=this.recogMsg||new MsgBox("",{isTipMsg:true,isAutoHide:true,isDireBottom:true,bgColor:"#ffffcd",timeOut:6e3})},setRecogMsgCont:function(a){this.recogMsg.setContent(a)},showRecogMsg:function(){this.recogMsg.show()},hideRecogMsg:function(){this.recogMsg.hide()},recogMsgT15Site:function(b){var a=DataManage.getOffset(b);a.top-=78;this.recogMsg.moveElem(a);this.recogMsg.setIndex(1600)},recogMsgT15Cont:function(){var a='"<span class="z369">题干</span>"内容未包含空格!(至少1个空格)<br/><br/>请请编辑题干并插入空格，再操作"<span class="z369">识别输入</span>"';a=this.getFullMsgInner(a);this.setRecogMsgCont(a)},recogMsgT15:function(a){this.initRecogMsg();this.recogMsgT15Site(a);this.recogMsgT15Cont();this.showRecogMsg()},recogMsgT8011Site:function(b){var a=DataManage.getOffset(b);a.top-=78;this.recogMsg.moveElem(a);this.recogMsg.setIndex(1600)},recogMsgT8011Cont:function(){var a='该小题引用其他小题的选项组,<br/><br/>不支持"<span class="z369">识别输入</span>"';a=this.getFullMsgInner(a);this.setRecogMsgCont(a)},recogMsgT8011:function(a){this.initRecogMsg();this.recogMsgT8011Site(a);this.recogMsgT8011Cont();this.showRecogMsg()},recogMsgNoneSupSite:function(b){var a=DataManage.getOffset(b);a.top-=50;this.recogMsg.moveElem(a);this.recogMsg.setIndex(1600)},recogMsgNoneSupCont:function(b){var a=SetManage.getNames(b)+',暂不支持"<span class="z369">识别输入</span>"';a=this.getFullMsgInner(a);this.setRecogMsgCont(a)},recogMsgNoneSup:function(b,a){this.initRecogMsg();this.recogMsgNoneSupSite(b);this.recogMsgNoneSupCont(a);this.showRecogMsg()},help_init:function(){this.helpMsgBox=this.helpMsgBox||new MsgBox("",{isTipMsg:true,isDireBottom:true,isAutoHide:true,bgColor:"#ffffcd",timeOut:0})},help_show:function(){this.helpMsgBox&&this.helpMsgBox.show()},help_hide:function(){this.helpMsgBox&&this.helpMsgBox.hide()},help_site:function(c,b){var a=DataManage.getOffset(c);switch(b){case"sort":a.top-=96;a.left+=0}this.helpMsgBox.moveElem(a)},help_cont:function(b){var a="";switch(b){case"sort":a='<span style="line-height:1.5em; color:#444;">例：若您录入的试题或试卷是"2010年浙江高考语文"<br/>则您的分类可以填写为"2010"，"浙江"，"高考语文"。<br/>分类填写的越精准，则试题或试卷的价值越高。</span>';a=this.getFullMsgInner(a)}this.helpMsgBox.setContent(a)},help:function(b,a){this.help_init();this.help_cont(a);this.help_site(b,a);this.help_show()},removeMsg:function(a,d){var e='<div class="handleTip">    <div class="handleT_head">'+(a.header||"确定删除?")+'</div>    <div class="handleT_cont">'+(a.content||"")+"</div></div>",b=a.isRemove,c=this;Boxy[b?"confirm":"alert"](e,function(){if(b){c.showMaskLayer();d(function(){c.hideMaskLayer()})}},{title:a.title||"提示确认删除",show:false,modal:true})}},EqualsManage={data:{},isLoadJs:false,loadJs:function(){var a=this;$.getScript(LKConfig.URLAssembly.Common.JavaScript.get("Equals"),function(){a.isLoadJs=true},false)},cloneData:function(d,e){this.isLoadJs||this.loadJs();this.data=DataManage.clone(d);switch(e){case"80":for(var c=this.data.content,b=c.子小题集合,a=0;a<b.length;a++)delete b[a].选项集合}},changeContent:function(a){return!LK_Equals.json(this.data.content,a)},changeSort:function(j){for(var e=j,c,d={},h=0,g=this.data.outside.分类列表,b,f={},i=0,a=0;a<e.length;a++){c=e[a].分类名;if(DataManage.trim(c)!=""&&!d[c]){d[c]=true;h++}}for(var a=0;a<g.length;a++){b=g[a].分类名;if(DataManage.trim(b)!=""&&!f[b]){f[b]=true;i++;if(!d[b])return true}}return h!=i?true:false},changePublic:function(a){return!this.data.outside.是否公开==a},changeDifficult:function(a){return!(this.data.outside.难易度==a)}},DataManage={rtrim:/(\&nbsp\;)+$|(\s|\u00A0)+$/g,rbr:/(\<br \/\>)+$/g,getRandom:function(){return((1+Math.random())*65536|0).toString(16).substring(1)},getGuid:function(){return this.getRandom()+this.getRandom()+"-"+this.getRandom()+"-"+this.getRandom()+"-"+this.getRandom()+"-"+this.getRandom()+this.getRandom()+this.getRandom()},getVersion:function(){return $.browser.msie?"MSIE"+$.browser.version:false},textToJson:function(a){return JSON.textToJson(a)},jsonToText:function(a){return JSON.jsonToText(a)},markToJson:function(a){return this.textToJson(SetManage.content["T"+a])},clone:function(a){var b;if(a instanceof Array){b=[];var c=a.length;while(c--)b[c]=this.clone(a[c]);return b}else if(a instanceof Object){b={};for(var d in a)b[d]=this.clone(a[d]);return b}else return a},isEmptyOrNull:function(a){a=this.trim(a);return a==""||a==null?true:false},htmlToText:function(a){return(a||"").replace(/<.+?>/gim,"").replace(/\&nbsp\;/g,"").replace(/\&quot\;/g,'"').replace(/\&ldquo\;/g,"“").replace(/\&rdquo\;/g,"”").replace(/(^\s*)|(\s*$)/g,"")},clearHtmlTag:function(a){return(a||"").replace(/<\/?div[^>]*>/gi,"").replace(/<\/?P[^>]*>/gi,"").replace(this.rtrim,"").replace(/\n/g,"").replace(this.rbr,"")},trim:function(a){return $.trim(a)},subStrText:function(a,b){a=this.trim(a);b=b||10;return a==""?"":a.length<b?a:a.substr(0,b)},timeOut:function(a,b){window.setTimeout(function(){a()},b)},equalArray:function(a,e){a=a||[];for(var d=a.length,b=0;b<d;b++)for(var c=0;c<d;c++)if(b!=c&&a[b]==a[c]){e({result:true,info:{start:b,end:c}});return}e({result:false,info:{}})},getOffset:function(c){var a=$(c),d=a.offset().top,b=a.offset().left;return{top:d,left:b}},getPosition:function(c){var a=$(c),d=a.position().top,b=a.position().left;return{top:d,left:b}},getInner:function(b){var a=$(b),d=a.width(),c=a.height();return{width:d,height:c}},getDispaly:function(a){return $(a).css("display")},getLowerCase:function(a){return String.fromCharCode(97+a)},getUpperCase:function(a){return String.fromCharCode(65+a)},getCutPoint:function(b,a){a=a||10;return b.length<a?b:b.substr(0,a)+"..."},getRepStr:function(a){return a.replace(/\d/gi,"")},getRepDigit:function(a){return a.replace(/\D/gi,"")},setQueryNone:function(a){a.css("display","none")},setQueryBlock:function(a){a.css("display","block")},setIDNone:function(a){$("#"+a).css("display","none")},setIDBlock:function(a){$("#"+a).css("display","block")},get分类列表:function(){return SetManage.outside.分类列表},get分类列表长度:function(){return SetManage.outside.分类列表.length},get分类列表分类名:function(a){return SetManage.outside.分类列表[a].分类名},getOptionMax:function(a){return SetManage.option["T"+a].max},getOptionMin:function(a){return SetManage.option["T"+a].min}},IFrameFckEditor={fckBoxy:0,fckMenu:0,fckNav:0,fckHand:0,fckConWindowManage:0,data:{},afterSet:false,isKey:false,navTagLen:0,currIndex:0,ischange:false,settings:{guidTeam:null,mark:null,guidGroup:0,index:null,types:null,tag:"",html:"",curClass:"fckNavcur",fulClass:"fckNavful",norClass:"fckNavNor"},extendSet:function(a){jQuery.extend(this.settings,a)},extendData:function(a){this.data={};jQuery.extend(this.data,a)},initBoxy:function(){this.fckBoxy=this.fckBoxy||new Boxy('<div class="fckBoxy"><div class="fckMenu" id="FckMenu"></div><div class="fckContent"><iframe name="FckEditorName" src="'+LKConfig.URLAssembly.Subject.IFrame.get("Fckeditor")+'" onload="IFrameFckEditor.load(this);" frameborder="0" ></iframe><div class="fckHandle" ><div class="fckH_Header"><a title="隐藏工具条"></a></div><div class="fckH_Content" id="fckHandle"></div></div></div><div class="fckNav" id="FckNav"></div></div>',{title:"FckEditor",show:false,modal:true,fixed:true,closeText:"[关闭]",afterShow:function(){IFrameFckEditor.afterShow()},beforeHide:function(){IFrameFckEditor.beforeHide()},afterHide:function(){}});this.fckMenu=this.fckMenu||$("#FckMenu");this.fckNav=this.fckNav||$("#FckNav");this.fckHand=this.fckHand||$("#fckHandle")},load:function(a){this.fckConWindowManage=a.contentWindow.FckEditorManage},getDirty:function(){var a=this.fckConWindowManage.getDirty();this.ischange=this.ischange||a;return a},setBoxyTitle:function(){var a=this.settings,c=a.mark,d=a.tag,b=SetManage.names["T"+c];this.fckBoxy.setTitle(b+"—"+d)},getMenuSpace:function(){var a=this.settings;return a.types=="Title"?'<a href="javascript:void(0)" title="插入空格到题干" class="fckM_Space" onclick="SpaceGroup.insert(this,\''+a.guidTeam+"','"+a.mark+"')\" ></a>":""},getMenuImage:function(){var a=this.settings;switch(a.types){case"OptionT14":case"OptionT15":return"";break;default:return'<a href="javascript:void(0)" title="图片管理" class="fckM_Image" onclick="Image试题管理.显示图片管理();" ></a>'}},getMenuHtml:function(a){switch(a){case"13":return this.getMenuSpace()+this.getMenuImage();break;case"14":return this.getMenuSpace()+this.getMenuImage();break;case"15":return this.getMenuSpace()+this.getMenuImage();break;default:return this.getMenuImage()}},setMenuHtml:function(a){this.fckMenu.html(this.getMenuHtml(a))},getNavEvent:function(c,a,b){return"IFrameFckEditor.navToggle('"+c+"', '"+a+"', '"+b+"')"},getNavTagNor:function(b,d,a,c){this.navTagLen++;return'<a class="fckNavNor '+b+'" title="'+d+'" onclick="'+a+'" href="javascript:void(0)" >'+c+"</a>"},getNavTagSpe:function(b,e,a,d,c){this.navTagLen++;return'<a style="'+c+'" class="fckNavNor '+b+'" title="'+e+'" onclick="'+a+'" href="javascript:void(0)" >'+d+"</a>"},getNavTitle:function(b){var a="",c="编辑题干",e=b.types,d=this.getNavEvent("Title",null,null);if(e=="Title"){a=b.curClass;c="正在编辑题干";d="return false;";this.currIndex=this.navTagLen}else if(DataManage.trim(this.data.题干文本)!=""){a=b.fulClass;c="已编辑题干"}return this.getNavTagNor(a,c,d,"题 干")},getNavOption:function(b,g,h){var d,c,e,f,i="",m=b.types,l=b.index,j=b.curClass,k=b.fulClass;if(g.length==0)return"";for(var a=0;a<g.length;a++){d="";c=DataManage.getUpperCase(a);e="编辑选项"+c;f=this.getNavEvent(h,b.guidGroup,a);if(m==h&&l==a){d=j;e="正在编辑选项"+c;f="return false;";this.currIndex=this.navTagLen}else if(g[a].选项内容文本!=""){d=k;e="已编辑选项"+c}i+=this.getNavTagNor(d,e,f,"选项"+c)}return i},getNavOptionNormal:function(a){return this.getNavOption(a,this.data.选项列表,"OptionNormal")},getNavOptionT14:function(a){return this.getNavOption(a,this.data.选项组.选项集合,"OptionT14")},getNavOptionT15Cell:function(b){var c=this.data.单选空格集合,d=c.length,a=parseInt(b.guidGroup);if(!d==0){var e=a+1,f=c[a].选项组.选项集合,g=this.getNavOption(b,f,"OptionT15");return"<div class=\"fckNavT15\"><span>第<font color='red'>"+e+"</font>个空格的选项组</span>"+g+"</div>"}else return""},getNavOptionT15:function(a){return'<div class="fckNavT15Box">'+this.getNavOptionT15Cell(a)+"</div>"},refNavOptionT15:function(a,c){var b=c||this.getNavOptionT15Cell(a);this.fckNav.children("div .fckNavT15Box").html(b)},getNavOptionT8011:function(a){return this.getNavOption(a,this.data.选项集合,"OptionT8011")},getNavAnswerT60:function(b){var a="",c="编辑答案",e=b.types,d=this.getNavEvent("AnswerT60",null,null);if(e=="AnswerT60"){a=b.curClass;c="正在编辑答案";d="return false;";this.currIndex=this.navTagLen}else if(DataManage.trim(DataManage.htmlToText(this.data.答案))!=""){a=b.fulClass;c="已编辑答案"}return this.getNavTagNor(a,c,d,"答 案")},getNavAnalysis:function(b){var a="",c="编辑解题思路",f=b.types,d=this.getNavEvent("Analysis",null,null);if(f=="Analysis"){a=b.curClass;c="正在编辑解题思路";d="return false;";this.currIndex=this.navTagLen}else if(DataManage.trim(DataManage.htmlToText(this.data.解题思路))!=""){a=b.fulClass;c="已编辑解题思路"}var e="margin-right:0px; width:60px;";return this.getNavTagSpe(a,c,d,"解题思路",e)},getNavHtml:function(a){switch(a.mark){case"11":case"12":return this.getNavTitle(a)+this.getNavOptionNormal(a)+this.getNavAnalysis(a);break;case"14":return this.getNavTitle(a)+this.getNavOptionT14(a)+this.getNavAnalysis(a);break;case"15":return this.getNavTitle(a)+this.getNavOptionT15(a)+this.getNavAnalysis(a);break;case"13":case"20":case"30":case"40":case"41":case"42":case"43":case"44":case"45":case"46":case"47":case"80":return this.getNavTitle(a)+this.getNavAnalysis(a);break;case"60":case"61":case"62":case"63":case"64":case"65":case"66":case"67":case"68":case"69":return this.getNavTitle(a)+this.getNavAnswerT60(a)+this.getNavAnalysis(a);break;case"8011":return this.getNavTitle(a)+this.getNavOptionT8011(a)+this.getNavAnalysis(a);break;default:return""}},setNavHtml:function(a){this.navTagLen=0;this.currIndex=0;this.fckNav.html(this.getNavHtml(a))},getHandleHtml:function(c){var a='class="fckH_C_Link" href="javascript:void(0)"',b=c.guidTeam;return"<a "+a+' title="智能识别输入试题" onclick="Recog试题管理.显示识别输入(this,\''+b+"',0);\" >识别输入</a><a "+a+' title="预览该试题内容" onclick="IFrameFckEditor.save();View试题管理.显示试题预览(\''+b+"');\">预览试题</a><a "+a+' title="保存修改后的试题内容" onclick="IFrameFckEditor.hide();">保存试题</a>'},getHandleT15Previous:function(b,a){return b?'<a class="fckH_C_T15_full_p_0" href="javascript:void(0)" title="显示第'+(parseInt(a)+1)+'个空格的选项组" onclick="IFrameFckEditor.exeHandleT15(\''+a+"')\" onmousedown=\"this.className='fckH_C_T15_full_p_1'\" onmouseup=\"this.className='fckH_C_T15_full_p_0'\" ></a>":'<a class="fckH_C_T15_empty_p" style="cursor:text;" href="javascript:void(0)" title="已经是第一个空格了"></a>'},getHandleT15Next:function(b,a){return b?'<a class="fckH_C_T15_full_n_0" href="javascript:void(0)" title="显示第'+(parseInt(a)+1)+'个空格的选项组" onclick="IFrameFckEditor.exeHandleT15(\''+a+"')\" onmousedown=\"this.className='fckH_C_T15_full_n_1'\" onmouseup=\"this.className='fckH_C_T15_full_n_0'\" ></a>":'<a class="fckH_C_T15_empty_n" style="cursor:text;" href="javascript:void(0)" title="已经是最后一个空格了"></a>'},getHandleT15Cell:function(d){var e=this.data.单选空格集合,c=e.length,b=parseInt(d.guidGroup),a="";if(c==0)return"";else switch(b){case 0:a+=this.getHandleT15Previous(false,null);if(c==1)a+=this.getHandleT15Next(false,null);else a+=this.getHandleT15Next(true,1);break;case c-1:if(c==1)a+=this.getHandleT15Previous(false,null);else a+=this.getHandleT15Previous(true,b-1);a+=this.getHandleT15Next(false,null);break;default:a+=this.getHandleT15Previous(true,b-1);a+=this.getHandleT15Next(true,b+1)}return"<div class=\"fckH_C_T15\"><span>切换空格-<font color='red'>"+(b+1)+"</font></span>"+a+"</div>"},getHandleT15:function(a){return'<div class="fckH_C_T15Box">'+this.getHandleT15Cell(a)+"</div>"},refHandleT15:function(a,c){var b=c||this.getHandleT15Cell(a);this.fckHand.children("div .fckH_C_T15Box").html(b)},exeHandleT15:function(a){this.navToggle("OptionT15",a,0);this.refHandleT15(this.settings)},setHandleHtml:function(a){var b;switch(a.mark){case"15":b=this.getHandleHtml(a)+this.getHandleT15(a);break;default:b=this.getHandleHtml(a)}this.fckHand.html(b)},show:function(){this.afterSet=false;this.ischange=false;this.fckBoxy.show()},afterShow:function(){var a=this.settings,b=a.mark;this.setNavHtml(a);this.setMenuHtml(b);this.setHandleHtml(a);this.setFckHtml();this.setBoxyTitle();this.isKey||this.initKey()},afterHide:function(){},beforeHide:function(){this.save(function(){IFrameFckEditor.ischange&&IFrameFckEditor.update()})},hide:function(){this.fckBoxy.hide()},afterToggle:function(a,d,b,c){this["get"+d](b,c);this.setNavHtml(a);this.setMenuHtml(a.mark);this.setFckHtml();this.setBoxyTitle()},navToggle:function(d,b,c){if(this.afterSet==false)return;this.afterSet=false;var a=this.settings,g=a.types,e=a.guidGroup,f=a.index;if(this.getDirty())this["set"+g](e,f,function(){IFrameFckEditor.afterToggle(a,d,b,c)});else this.afterToggle(a,d,b,c)},update:function(){HtmlManage.refFckEditor(this.settings,this.data)},save:function(b){var a=this.settings,e=a.types,c=a.guidGroup,d=a.index;this.getDirty()&&IFrameFckEditor["set"+e+""](c,d);b&&b()},tween:function(){var b=this.fckNav,c=b.height(),a=this.fckBoxy,d=a.getSize()},getFckHtml:function(){return DataManage.clearHtmlTag(this.fckConWindowManage.getHtml())},getFckInnerHtml:function(){return DataManage.clearHtmlTag(this.fckConWindowManage.getInnerHtml())},getFckText:function(){return this.fckConWindowManage.getText()},setFckHtml:function(){this.fckConWindowManage.setHtml(this.settings.html)},renSetHtml:function(a){this.fckConWindowManage.renSetHtml(a)},insertFckHtml:function(a,b){this.fckConWindowManage.insertHtml(a,b)},setFckData:function(a){var b=HashTable.get(a);_mark=b.小题型Enum;this.settings.guidTeam=a;this.settings.mark=_mark;this.data=b},navKey:function(){var a=this.currIndex+1,b=this.navTagLen;a=a>=b?0:a;this.afterSet&&this.fckNav.find("a").eq(a).click()},handleKey:function(b){var a=this.fckBoxy.isVisible();if(!a)return;switch(b){case 13:this.hide()}},initKey:function(){$(document).keydown(function(a){var b=a.keyCode;a.ctrlKey&&b==13&&IFrameFckEditor.handleKey(13)});this.isKey=true},getTitle:function(b,a){this.extendSet({types:"Title",index:a,tag:"题干",html:this.data.题干HTML})},getOption:function(a,b){var c=this.settings;switch(c.mark){case"11":case"12":this.getOptionNormal(a,b);break;case"14":this.getOptionT14(a,b);break;case"15":this.getOptionT15(a,b);break;case"8011":this.getOptionT8011(a,b);break;default:alert("没有找到相关项")}},getOptionNormal:function(f,c){for(var b=this.data.选项列表,e=b.length,a=0;a<e;a++)if(a==c){var d=DataManage.getUpperCase(a);this.extendSet({types:"OptionNormal",index:c,tag:"选项"+d,html:b[a].选项内容HTML});break}},getOptionT14:function(f,c){for(var b=this.data.选项组.选项集合,e=b.length,a=0;a<e;a++)if(a==c){var d=DataManage.getUpperCase(a);this.extendSet({types:"OptionT14",index:c,tag:"选项"+d,html:b[a].选项内容HTML});break}},getOptionT15:function(c,f){var b=this.data,d=b.单选空格集合[c];if(typeof d=="undefined"){alert("删除空格遇到异常,请重新编辑试题!");b.单选空格集合=[];b.题干HTML="";b.题干文本="";this.settings.html="";this.refHandleT15(this.settings);this.navToggle("Title","null","null");return}for(var e=d.选项组.选项集合,g=e.length,a=0;a<g;a++)if(a==f){var h=DataManage.getUpperCase(a);this.extendSet({types:"OptionT15",guidGroup:c,index:f,tag:"第"+(parseInt(c)+1)+"个空格—选项"+h,html:e[a].选项内容HTML});break}},getOptionT8011:function(f,c){for(var b=this.data.选项集合,e=b.length,a=0;a<e;a++)if(a==c){var d=DataManage.getUpperCase(a);this.extendSet({types:"OptionT8011",index:c,tag:"选项"+d,html:b[a].选项内容HTML});break}},getAnswerT60:function(b,a){this.extendSet({types:"AnswerT60",index:a,tag:"答案",html:this.data.答案})},getAnalysis:function(b,a){this.extendSet({types:"Analysis",index:a,tag:"解题思路",html:this.data.解题思路})},setTitle:function(e,f,d){var a=this.getFckHtml(),b=this.data,c=this.settings.mark;switch(c){case"13":case"14":case"15":SpaceGroup.finishDel(this.settings.guidTeam,c,a,function(b){a=b})}b.题干HTML=a;b.题干文本=DataManage.htmlToText(a);d&&d()},setOptionNormal:function(h,e,d){for(var f=this.data,b=f.选项列表,g=b.length,a=0;a<g;a++)if(a==e){var c=this.getFckHtml();b[a].选项内容HTML=c;b[a].选项内容文本=DataManage.htmlToText(c);break}d&&d()},setOptionT14:function(h,e,d){for(var f=this.data,b=f.选项组.选项集合,g=b.length,a=0;a<g;a++)if(a==e){var c=this.getFckHtml();b[a].选项内容HTML=c;b[a].选项内容文本=DataManage.htmlToText(c);break}d&&d()},setOptionT15:function(e,g,d){for(var b=this.data.单选空格集合[e].选项组.选项集合,f=b.length,a=0;a<f;a++)if(a==g){var c=this.getFckHtml();b[a].选项内容HTML=c;b[a].选项内容文本=DataManage.htmlToText(c);break}d&&d()},setOptionT8011:function(h,f,d){for(var g=this.data,b=g.选项集合,e=b.length,a=0;a<e;a++)if(a==f){var c=this.getFckHtml();b[a].选项内容HTML=c;b[a].选项内容文本=DataManage.htmlToText(c);break}d&&d()},setAnswerT60:function(b,c,a){this.data.答案=this.getFckHtml();a&&a()},setAnalysis:function(b,c,a){this.data.解题思路=this.getFckHtml();a&&a()}},TextEditor={change:function(e,b,d,a,c){switch(d){case"13":this.T13(e,b,a,c);break;default:alert("没有要执行的相关项")}},T13:function(d,b,a,c){HashTable.get(b).填空空格集合[a].填空空格答案集合[c].答案内容=$(d).val()},changeLink:function(d,a,c,b){this["changeLink"+c](d,a,b)},changeLinkLeft:function(c,a,b){HashTable.get(a).连线题左选项集合[b].选项内容文本=$(c).val()},changeLinkRight:function(c,a,b){HashTable.get(a).连线题右选项集合[b].选项内容文本=$(c).val()}},MouseManage={deleteBox:0,show:function(){this.deleteBox&&this.deleteBox.css("display","block")},hide:function(){this.deleteBox&&this.deleteBox.hide();this.deleteBox=0},T11:function(c,a){var b=HashTable.get(a).选项列表.length;if(b<=SetManage.option.T11.min){this.deleteBox=0;return}this.deleteBox=$(c).children("a:last")},T12:function(c,a){var b=HashTable.get(a).选项列表.length;if(b<=SetManage.option.T12.min){this.deleteBox=0;return}this.deleteBox=$(c).children("a:last")},T13:function(d,b,a){var c=HashTable.get(b).填空空格集合[a].填空空格答案集合.length;if(c<=SetManage.blank.T13.min){this.deleteBox=0;return}this.deleteBox=$(d).children("a:last")},T14:function(c,a){var b=HashTable.get(a).选项组.选项集合.length;if(b<=SetManage.option.T14.min){this.deleteBox=0;return}this.deleteBox=$(c).children("a:last")},T15:function(d,b,a){var c=HashTable.get(b).单选空格集合[a].选项组.选项集合.length;if(c<=SetManage.option.T15.min){this.deleteBox=0;return}this.deleteBox=$(d).children("a:last")},T30Left:function(c,a){var b=HashTable.get(a).连线题左选项集合.length;if(b<=SetManage.link.Left.min){this.deleteBox=0;return}this.deleteBox=$(c).children("a:last")},T30Right:function(c,a){var b=HashTable.get(a).连线题右选项集合.length;if(b<=SetManage.link.Right.min){this.deleteBox=0;return}this.deleteBox=$(c).children("a:last")},T30Answer:function(c,a){var b=HashTable.get(a).连线题答案集合.length;if(b<=SetManage.link.Answer.min){this.deleteBox=0;return}this.deleteBox=$(c).children("a:last")},T8011:function(c,a){var b=HashTable.get(a).选项集合.length;if(b<=SetManage.option.T8011.min){this.deleteBox=0;return}this.deleteBox=$(c).children("a:last")},sort:function(b){var a=DataManage.get分类列表长度();if(a<=SetManage.sort.min){this.deleteBox=0;return}this.deleteBox=$(b).children("a")}},HtmlManage={eleMoreHtml:0,initDivEle:function(){this.eleMoreHtml=this.eleMoreHtml||$("#ID_MoreHtml_Box")},getBarHtml:function(b,a){return'<div class="E_H_L_Bar">'+b+a+"</div>"},getBarHtmlStyle:function(b,a,c){return'<div class="E_H_L_Bar" style="'+c+'">'+b+a+"</div>"},getMarkHtml:function(a){return'<div class="E_H_L_B_Mark">'+a+"：</div>"},getFixHtml:function(a){return'<div class="E_H_L_B_Fix">'+a+"</div>"},getAutoHtml:function(a){return'<div class="E_H_L_B_Auto">'+a+"</div>"},getBorderHtml:function(c,b){var a=b?"htmlNavFul":"",d='<a class="htmlNavNor htmlNavInputBase '+a+'" title="'+c+'" href="javascript:void(0)" ';return d},getEvent:function(d,b,a,c){return"IFrameFckEditor.setFckData('"+b+"');IFrameFckEditor.get"+d+"('"+a+"','"+c+"');IFrameFckEditor.show()"},getTitle:function(f,g){var a,b,c=g.题干文本;if(!DataManage.isEmptyOrNull(c)){b=true;a=DataManage.getCutPoint(c,null)}else{b=false;a="请输入题干..."}var e=this.getMarkHtml("题干"),d=this.getBorderHtml("点击编辑题干",b)+'onclick="'+this.getEvent("Title",f,null,null)+'" >'+a+"</a>",h=this.getFixHtml(d);return this.getBarHtml(e,h)},getAnalysis:function(f,g){var a,b,c=DataManage.htmlToText(g.解题思路);if(!DataManage.isEmptyOrNull(c)){b=true;a=DataManage.getCutPoint(c,null)}else{b=false;a="请输入解题思路..."}var e=this.getMarkHtml("解题思路"),d=this.getBorderHtml("点击编辑解题思路",b)+'onclick="'+this.getEvent("Analysis",f,null,null)+'" >'+a+'</a><span style="color: #999;padding-left:3px;">(可填)</span>',h=this.getFixHtml(d);return this.getBarHtml(e,h)},getMarkToContHtml:function(b,a,d){var c=this.getTitle(b,a);d=d||a.小题型Enum;switch(d){case"11":c+=MultipleOption.getT11(b,a)+AnswerGroup.getT11(b,a);break;case"12":c+=MultipleOption.getT12(b,a)+AnswerGroup.getT12(b,a);break;case"13":c+=MultipleBlank.getBlankT13(b,a);break;case"14":c+=MultipleOption.getT14(b,a)+MultipleBlank.getBlankT14(b,a);break;case"15":c+=MultipleBlank.getBlankT15(b,a);break;case"20":c+=AnswerGroup.getT20(b,a);break;case"30":c+=LinkManage.getLink(b,a);break;case"40":case"41":case"42":case"43":case"44":case"45":case"46":case"47":c+=MulitpleSubject.getListHtml(b,a);break;case"60":case"61":case"62":case"63":case"64":case"65":case"66":case"67":case"68":case"69":c+=AnswerGroup.getT60(b,a);break;case"80":c+=MulitpleSubject.getListHtml(b,a);break;case"8011":c+=MulitpleSubject.getT8011OpQuote(b,a,false)+AnswerGroup.getT8011(b,a);break;default:alert("没有找到相关项");return""}c+=this.getAnalysis(b,a);return c},getParentHtml:function(a,b){var c=this.getMarkToContHtml(a,b,null);return'<div id="'+a+'">'+c+"</div>"},setParentHtml:function(a,b){this.eleMoreHtml.html(this.getParentHtml(a,b))},getT40ListElem:function(a){return $("#"+a+"List")},getT40ChsElem:function(a){return $("#"+a+"List").children("div")},insertCellByList:function(f,b,d,e,h,c){var i=b.children("div").length,g=MulitpleSubject.getCell(f,d,e,h,i),a=$(g).appendTo(b);MulitpleSubject.eveCellHover(a);c&&c(a)},insertCellAfter:function(a,b,c,e){var d=this.getT40ListElem(a);this.insertCellByList(a,d,b,c,e,function(a){MulitpleSubject.addQueTypesTimeOut(a)})},insertCellBoth:function(a,f,d,e,c){var g=MulitpleSubject.getCell(a,d,e,c,0),b=$(g).insertAfter(f);MulitpleSubject.refCellHeadNum(a);c=="8011"&&MulitpleSubject.refT8011QuoteList(a);MulitpleSubject.eveCellHover(b);MulitpleSubject.addQueTypesTimeOut(b)},refHtmlByGuid:function(a,b,d){var c=this.getMarkToContHtml(a,b,d);$("#"+a).html(c)},refHtmlT40:function(b,c){var d=$("#"+b).children("div"),a;a=this.getTitle(b,c);d.eq(0).replaceWith(a);a=this.getAnalysis(b,c);d.eq(2).replaceWith(a)},refHtmlT8011:function(b,c){var d=$("#"+b).children("div"),a;a=this.getTitle(b,c);d.eq(0).replaceWith(a);a=this.getAnalysis(b,c);d.eq(3).replaceWith(a);var e=c.选项组ID;a=MultipleOption.getT8011(b,c);$("#"+e,$("#"+b).parent("div")).html(a)},refFckEditor:function(c,b){var d=c.mark,a=c.guidTeam;switch(d){case"40":case"41":case"42":case"43":case"44":case"45":case"46":case"47":case"80":this.refHtmlT40(a,b);break;case"8011":this.refHtmlT8011(a,b);MulitpleSubject.setCellHeaderTitle(a,b.题干文本);break;default:this.refHtmlByGuid(a,b,d);MulitpleSubject.setCellHeaderTitle(a,b.题干文本)}}},AnswerColumn={getBox:function(a){return'<div class="E_H_C_A_Column">'+a+"</div>"},getBar:function(j,h,g,a,e,i,c,b,f){var d=a+h;return'<label class="E_H_C_A_C_Bar" for="'+d+'" title="选项'+c+":"+b+'" ><input id="'+d+'" '+g+' type="'+j+'" name="'+a+'" onclick="AnswerColumn.setT'+i+"('"+a+"','"+e+"','"+f+"',this)\" /><span>"+c+"):"+DataManage.getCutPoint(b,4)+"</span></label>"},getT11:function(l,f){for(var i=HashTable.get(f),h=i.选项列表,k=i.答案ID,j="",d,e,b,c,g,a=0;a<h.length;a++){d=h[a];e=d.选项内容文本;b=d.ID;g=DataManage.getUpperCase(a);c="";if(b==k)c='checked="checked" ';j+=this.getBar(l,a,c,f,null,"11",g,e,b)}return this.getBox(j)},getT12:function(n,g){for(var k=HashTable.get(g),j=k.选项列表,h=k.答案列表,m=h.length,l="",d,f,b,c,i,a=0;a<j.length;a++){d=j[a];f=d.选项内容文本;b=d.ID;i=DataManage.getUpperCase(a);c="";for(var e=0;e<m;e++)if(h[e]==b){c='checked="checked" ';break}l+=this.getBar(n,a,c,g,null,"12",i,f,b)}return this.getBox(l)},setT11:function(a,c,b){HashTable.get(a).答案ID=b;AnswerGroup.refT11(a,true)},setT12:function(c,h,d,g){var a=HashTable.get(c).答案列表,f=$(g).attr("checked");if(f){a.push(d);AnswerGroup.refT12(c,true)}else for(var e=a.length,b=0;b<e;b++)if(a[b]==d){a.splice(b,1);e==1&&AnswerGroup.refT12(c,false);break}},getSite:function(d,e){var a=DataManage.getPosition(d),b=DataManage.getInner(e),c=TestManage.getScroll();return{left:a.left-b.width-2,top:a.top-b.height/2+15+c}},show:function(c,h,e,d,g){var a=$(c);if(a.children("div").size()!=0)return;var f=this["getT"+g](h,e,d),b;a.html("选择答案"+f).hover(function(){},function(){AnswerColumn.close(a)});b=a.children("div");b.css(this.getSite(c,b))},close:function(a){a.unbind().html("选择答案")},getCellT14:function(a,f,h,b,e,c,g){var d=a+h;return'<label class="g_b_column_b_cellT14" for="'+d+'" title="选项'+c+":"+b+'" ><input id="'+d+'" '+g+' type="radio" name="'+a+'" onclick="AnswerColumn.setAnswerT14(\''+a+"','"+f+"','"+e+"')\" /><span>"+c+"):"+DataManage.getCutPoint(b,4)+"</span></label>"},getListT14:function(g,h){for(var f=HashTable.get(g),k=f.选项组.选项集合,m=k.length,i=f.选词空格集合,n=i.length,l="",d,e,b,c,j,a=0;a<m;a++){d=k[a];e=d.选项内容文本;b=d.ID;j=DataManage.getUpperCase(a);c="";if(i[h].答案ID==b)c='checked="checked" ';l+=this.getCellT14(g,h,a,e,b,j,c)}return l},getColumnT14:function(a,b){return'<div class="g_b_column_b_listT14">'+this.getListT14(a,b)+"</div>"},setAnswerT14:function(a,c,b){HashTable.get(a).选词空格集合[c].答案ID=b},getSiteT14:function(c){var a=DataManage.getPosition(c),b=TestManage.getScroll();return{left:a.left+2,top:a.top+27+b}},showListT14:function(e,c,b){var a=$(e);if(a.children("div").size()!=0)return;var f=parseInt(b)+1,g=this.getColumnT14(c,b),d;a.html("选择第"+f+"个空格的答案"+g).hover(function(){},function(){DataManage.timeOut(function(){AnswerColumn.closeT14(a,c,b)},10)});d=a.children("div");d.css(this.getSiteT14(e))},closeT14:function(a,b,c){a.unbind().children("div").remove();AnswerGroup.refCellT14(b,c,true)},getT15:function(n,g,f){for(var h=HashTable.get(g).单选空格集合[f],j=h.选项组.选项集合,l=j.length,m=h.答案ID,k="",d,e,b,c,i,a=0;a<l;a++){d=j[a];e=d.选项内容文本;b=d.ID;i=DataManage.getUpperCase(a);c="";if(b==m)c='checked="checked" ';k+=this.getBar(n,a,c,g,f,"15",i,e,b)}return this.getBox(k)},setT15:function(b,a,c){HashTable.get(b).单选空格集合[a].答案ID=c;AnswerGroup.refT15(b,a,true)},getCellT30:function(b,e,c,d,a){return'<a onclick="AnswerColumn.setAnswerT30'+e+"(this,'"+b+"','"+c+"','"+d+"','"+a+'\')" title="选择'+a+'">[ '+a+" ]</a>"},getCellFullT30:function(a){return'<a title="该选项的答案栏已存在" style="color:red; cursor: text;">[ '+a+" ]</a>"},getCellAlreadyT30:function(a){return'<a title="已经选择过该选项了" style="color:red;  cursor: text;">[ '+a+" ]</a>"},getListT30Left:function(k,g){var j=HashTable.get(k),l=j.连线题左选项集合,n=l.length,b,d=j.连线题答案集合,o=d.length,c,i=d[g].连线题左选项ID,h=d[g].连线题右选项ID,e,f="",m={};if(h)for(var a=0;a<o;a++){c=d[a];if(c.连线题右选项ID==h&&c.连线题左选项ID!=i)m[c.连线题左选项ID]=true}for(var a=0;a<n;a++){b=l[a].ID;e=DataManage.getUpperCase(a);if(m[b])f+=this.getCellFullT30(e);else if(b==i)f+=this.getCellAlreadyT30(e);else f+=this.getCellT30(k,"Left",g,b,e)}return f},getListT30Right:function(k,g){var j=HashTable.get(k),l=j.连线题右选项集合,n=l.length,b,d=j.连线题答案集合,o=d.length,c,i=d[g].连线题左选项ID,h=d[g].连线题右选项ID,e,f="",m={};if(i)for(var a=0;a<o;a++){c=d[a];if(c.连线题左选项ID==i&&c.连线题右选项ID!=h)m[c.连线题右选项ID]=true}for(var a=0;a<n;a++){b=l[a].ID;e=DataManage.getLowerCase(a);if(m[b])f+=this.getCellFullT30(e);else if(b==h)f+=this.getCellAlreadyT30(e);else f+=this.getCellT30(k,"Right",g,b,e)}return f},getColumnT30:function(a,c,b){return'<div class="g_b_column_b_listT30">'+this["getListT30"+c](a,b)+"</div>"},refAnswerT30:function(b,a){$(b).parent("div").parents("a").addClass("htmlNavFul").text(a)},setAnswerT30Left:function(e,a,b,c,d){HashTable.get(a).连线题答案集合[b].连线题左选项ID=c;this.refAnswerT30(e,d)},setAnswerT30Right:function(e,a,b,c,d){HashTable.get(a).连线题答案集合[b].连线题右选项ID=c;this.refAnswerT30(e,d)},getSiteT30:function(c){var a=DataManage.getPosition(c),b=TestManage.getScroll();return{left:a.left,top:a.top+22+b}},showListT30:function(d,e,f,b){var a=$(d);if(a.children("div").size()!=0)return;var h=parseInt(b)+1,g=this.getColumnT30(e,f,b),c;a.append(g).hover(function(){},function(){AnswerColumn.closeT30(a)});c=a.children("div");c.css(this.getSiteT30(d))},closeT30:function(a){$(a).unbind().children("div").remove()},getT8011:function(n,d){for(var b=HashTable.get(d),l=b.选项组ID,g=$("#"+l).prev("div").attr("id"),j=g==d?b.选项集合:HashTable.get(g).选项集合,m=b.答案ID,k="",f,h,c,e,i,a=0;a<j.length;a++){f=j[a];h=f.选项内容文本;c=f.ID;i=DataManage.getUpperCase(a);e="";if(c==m)e='checked="checked" ';k+=this.getBar(n,a,e,d,null,"8011",i,h,c)}return this.getBox(k)},setT8011:function(a,c,b){HashTable.get(a).答案ID=b;AnswerGroup.refT8011(a,true)}},AnswerGroup={getBox:function(f,c,b,e,d){var a=d?"htmlNavFul":"";return'<a class="htmlNavNor htmlNavInputAnswer '+a+'" href="javascript:void(0)" onmouseover="AnswerColumn.show(this,\''+f+"','"+c+"','"+b+"','"+e+"');\" >选择答案</a>"},getT11:function(b,c){var f=c.答案ID!=null?true:false,a=HtmlManage.getMarkHtml("答案"),d=this.getBox("Radio",b,null,"11",f),e=HtmlManage.getFixHtml(d);return HtmlManage.getBarHtml(a,e)},refT11:function(b,c){var a=$("#"+b).children("div:eq(2)").children("div:eq(1)").children("a");if(c)a.addClass("htmlNavFul");else a.removeClass("htmlNavFul")},getT12:function(e,f){for(var b=f.答案列表,i=b.length,c=false,a=0;a<i;a++)if(b[a]!=null){c=true;break}var d=HtmlManage.getMarkHtml("答案"),g=this.getBox("CheckBox",e,null,"12",c),h=HtmlManage.getFixHtml(g);return HtmlManage.getBarHtml(d,h)},refT12:function(b,c){var a=$("#"+b).children("div:eq(2)").children("div:eq(1)").children("a");if(c)a.addClass("htmlNavFul");else a.removeClass("htmlNavFul")},getT20:function(f,k){var a="点击选择该答案",b=DataManage.getGuid(),h=b+"1",i=b+"2",g=b+"name",c=k.答案,d="",e="";if(c!=null){d=c?' checked="checked" ':"";e=!c?' checked="checked" ':""}var l='<div class="E_S_L_B_Radio"><input title="'+a+'" type="radio" '+d+' name="'+g+'" id="'+h+'" onclick="AnswerGroup.setT20(\''+f+"','1');\" /><label title=\""+a+'" for="'+h+'"  >正确</label><input title="'+a+'" type="radio" '+e+' name="'+g+'" id="'+i+'" onclick="AnswerGroup.setT20(\''+f+'\',\'0\');" style="margin-left:6px;*margin-left:2px;" /><label title="'+a+'" for="'+i+'" >错误</label></div>',j=HtmlManage.getMarkHtml("答案");return HtmlManage.getBarHtml(j,l)},setT20:function(a,b){HashTable.get(a).答案=b=="1"?true:false},getEleListT14:function(a){return $("#"+a).children("div:eq(2)").children("div:eq(1)")},getEleCellT14:function(a,b){return this.getEleListT14(a).children("div:eq("+b+")").children("a")},refListT14:function(a,c){var b=MultipleBlank.getListT14(a,c);this.getEleListT14(a).html(b)},refCellT14:function(c,a,i){if(i){var e=HashTable.get(c),f=e.选词空格集合,j=f.length,d=f[a].答案ID;if(d!=null)for(var g=e.选项组.选项集合,h=g.length,k,b=0;b<h;b++)if(d==g[b].ID){this.getEleCellT14(c,a).addClass("htmlNavFul").html("已选择[ "+DataManage.getUpperCase(b)+" ]");break}}else this.getEleCellT14(c,a).removeClass("htmlNavFul").html("选择第"+(parseInt(a)+1)+"个空格的答案")},getT15:function(b,a,d){var c=d!=null?true:false;return this.getBox("Radio",b,a,"15",c)},refT15:function(c,b,d){var a=$("#"+c).children("div:eq(1)").children("div:eq(1)").children("div:eq("+b+")").children("a");if(d)a.addClass("htmlNavFul");else a.removeClass("htmlNavFul")},getT60:function(f,g){var a,b,c=DataManage.htmlToText(g.答案);if(!DataManage.isEmptyOrNull(c)){b=true;a=DataManage.getCutPoint(c,null)}else{b=false;a="请输入答案..."}var e=HtmlManage.getMarkHtml("答案"),d=HtmlManage.getBorderHtml("点击编辑答案",b)+'onclick="'+HtmlManage.getEvent("AnswerT60",f,null,null)+'" >'+a+"</a>",h=HtmlManage.getFixHtml(d);return HtmlManage.getBarHtml(e,h)},getT8011:function(b,c){var f=c.答案ID!=null?true:false,a=HtmlManage.getMarkHtml("答案"),d=this.getBox("Radio",b,null,"8011",f),e=HtmlManage.getFixHtml(d);return HtmlManage.getBarHtml(a,e)},refT8011:function(b,c){var a=$("#"+b).children("div:eq(2)").children("div:eq(1)").children("a");if(c)a.addClass("htmlNavFul");else a.removeClass("htmlNavFul")},refT8011Sib:function(c,b,a){var d=$("#"+c).parent("div").siblings("div");d.each(function(){var d=$(this).children("div:eq(1)").attr("id"),c=HashTable.get(d);if(c.选项组ID==b&&c.答案ID==a){c.答案ID=null;AnswerGroup.refT8011(d,false)}})}},MultipleManage={getOptionInput:function(d,h,c,g,a,e,f){var b=f?"htmlNavFul":"";return'<span class="g_b_more_o_mark" >'+a+'：</span><a class="htmlNavNor htmlNavInputOption '+b+'" href="javascript:void(0)" title="点击编辑选项'+a+'" onclick="'+HtmlManage.getEvent("Option",d,c,g)+'" >'+e+"</a>"},getBlankInput:function(c,f,b,a,d){var e=a==0?"":'<span class="g_b_more_b_c_or">或</span>';return e+'<input type="text" value="'+d+'" onchange="TextEditor.change(this,\''+c+"','"+f+"','"+b+"','"+a+"')\"/>"},getOptionDelete:function(b,e,a,d,c){return'<a title="删除选项'+c+'" class="deleteBox"  href="javascript:void(0)"onclick="MultipleManage.remove(this,\''+b+"','"+e+"','"+a+"','"+d+"');\" ></a>"},getBlankDelete:function(c,d,b,a){return'<a title="删除第'+parseInt(a+1)+'个备选答案" class="deleteBox"  href="javascript:void(0)"onclick="MultipleManage.remove(this,\''+c+"','"+d+"','"+b+"','"+a+"');\" ></a>"},getOptionCell:function(c,a,b,e,d,g,i){var j=this.getOptionInput(c,a,b,e,d,g,i),h=this.getOptionDelete(c,a,b,e,d),f=j+h;switch(a){case"11":case"12":case"8011":return'<div class="g_b_more_o_cell" onmouseover="MouseManage.T'+a+"(this,'"+c+"','"+b+'\');MouseManage.show();" onmouseout="MouseManage.hide();">'+f+"</div>";break;case"14":case"15":return'<div class="g_b_more_o_cellT14" onmouseover="MouseManage.T'+a+"(this,'"+c+"','"+b+'\');MouseManage.show();" onmouseout="MouseManage.hide();">'+f+"</div>";break;default:alert("没有找到相关项")}},getBlankCell:function(b,d,a,c,f){var h=this.getBlankInput(b,d,a,c,f),g=this.getBlankDelete(b,d,a,c),i=h+g,e=c==0?"":"g_b_more_b_cellor";return'<div class="g_b_more_b_cell '+e+'" onmouseover="MouseManage.T'+d+"(this,'"+b+"','"+a+'\');MouseManage.show();" onmouseout="MouseManage.hide();">'+i+"</div>"},getOptionList:function(j,k,h,f){for(var d,b,c,g="",i=f.length,e,a=0;a<i;a++){d=DataManage.getUpperCase(a);e=f[a].选项内容文本;if(DataManage.isEmptyOrNull(e)){c=false;b="请输入选项"+d+"..."}else{c=true;b=DataManage.getCutPoint(e,null)}g+=this.getOptionCell(j,k,h,a,d,b,c)}return g},getBlankList:function(g,h,e,b){for(var d="",c,f=b.length,a=0;a<f;a++){c=b[a].答案内容;d+=this.getBlankCell(g,h,e,a,c)}return d},getHeader:function(d,b,c){var a;switch(b){case"11":case"12":case"14":case"15":case"8011":a=["选项组","点击新增选项卡","新增选项"];break;case"13":a=["备选答案组","点击新增备选答案","新增备选答案"];break;default:alert("没有找到相关项");return""}var e='<div class="module_b_header"><span>'+a[0]+'</span><a class="iconAdd" title="'+a[1]+'" href="javascript:void(0)" onclick="MultipleManage.insert(this,\''+d+"','"+b+"','"+c+"');\" >"+a[2]+"</a></div>";return e},getOptionModule:function(c,a,b){switch(c){case"11":case"12":case"8011":return'<div class="modulebox module_b_option">'+a+'<div class="module_b_body">'+b+"</div></div>";break;case"14":return'<div class="modulebox module_b_optionT14">'+a+'<div class="module_b_body">'+b+"</div></div>";break;case"15":return'<div class="modulebox module_b_optionT15">'+a+'<div class="module_b_body">'+b+"</div></div>";break;default:alert("没有找到相关项")}},getBlankModule:function(a,b){return'<div class="modulebox module_b_blankT13">'+a+'<div class="module_b_body">'+b+"</div></div>"},insert:function(b,d,e,c){var a;switch(e){case"11":a=this.insertOptionNormal(b,d,"11",c);break;case"12":a=this.insertOptionNormal(b,d,"12",c);break;case"13":a=this.insertBlankT13(b,d,"13",c);break;case"14":a=this.insertOptionT14(b,d,"14",c);break;case"15":a=this.insertOptionT15(b,d,"15",c);break;case"8011":a=this.insertOptionT8011(b,d,"8011",c);break;default:a=""}a!=""&&this.appendHtml(b,a)},insertOption:function(i,f,b,e,d){var a=d.length;if(a>=SetManage.option["T"+b].max){HandleTip.fullMsg(i,b);return""}var c=DataManage.getUpperCase(a),g="请输入选项"+c+"...",h=this.getOptionCell(f,b,e,a,c,g,false);this.putOptionJson(d);return h},insertOptionNormal:function(e,a,d,b){var c=HashTable.get(a).选项列表;return this.insertOption(e,a,d,b,c)},insertOptionT14:function(e,a,d,b){var c=HashTable.get(a).选项组.选项集合;return this.insertOption(e,a,d,b,c)},insertOptionT15:function(e,b,d,a){var c=HashTable.get(b).单选空格集合[a].选项组.选项集合;return this.insertOption(e,b,d,a,c)},insertOptionT8011:function(e,a,d,b){var c=HashTable.get(a).选项集合;return this.insertOption(e,a,d,b,c)},insertBlankT13:function(h,c,e,a){var d=HashTable.get(c).填空空格集合[a].填空空格答案集合,b=d.length;if(b>=SetManage.blank.T13.max){HandleTip.fullMsg(h,e);return""}var f=b,g=this.getBlankCell(c,e,a,f,"");this.putBlankJson(d);return g},putOptionJson:function(a){a.push({选项内容HTML:"",选项内容文本:"",ID:DataManage.getGuid()})},putBlankJson:function(a){a.push({答案内容:""})},appendHtml:function(b,a){$(b).parent("div").next("div").append(a)},remove:function(f,c,e,b,d){var a;switch(e){case"11":a=this.removeT11(c,b,d);break;case"12":a=this.removeT12(c,b,d);break;case"13":a=this.removeT13(c,b,d);break;case"14":a=this.removeT14(c,b,d);break;case"15":a=this.removeT15(c,b,d);break;case"8011":a=this.removeT8011(c,b,d);break;default:a=""}a!=""&&this.refurbish(f,a)},removeIsEmpty:function(){},removeT11:function(d,h,f){var c=HashTable.get(d),b=c.选项列表,e=b.length;if(e<=SetManage.option.T11.min){this.removeIsEmpty();return""}for(var g=c.答案ID,a=0;a<e;a++)if(a==f){if(g==b[a].ID){c.答案ID=null;AnswerGroup.refT11(d,false)}b.splice(a,1);return this.getOptionList(d,"11",null,b)}return""},removeT12:function(d,k,j){var f=HashTable.get(d),b=f.选项列表,g=b.length,h;if(g<=SetManage.option.T12.min){this.removeIsEmpty();return""}for(var e=f.答案列表,i=e.length,a=0;a<g;a++)if(a==j){h=b[a].ID;for(var c=0;c<i;c++)if(e[c]==h){e.splice(c,1);i==1&&AnswerGroup.refT12(d,false);break}b.splice(a,1);return this.getOptionList(d,"12",null,b)}return""},removeT13:function(e,c,f){var b=HashTable.get(e).填空空格集合[c].填空空格答案集合,d=b.length;if(d<=SetManage.blank.T13.min){this.removeIsEmpty();return""}for(var a=0;a<d;a++)if(a==f){b.splice(a,1);return this.getBlankList(e,"13",c,b)}return""},removeT14:function(c,i,h){var b=HashTable.get(c),d=b.选项组.选项集合,f=d.length,e="";if(f<=SetManage.option.T14.min){this.removeIsEmpty();return""}for(var g=b.选词空格集合,j=g.length,a=0;a<f;a++)if(a==h){d.splice(a,1);AnswerGroup.refListT14(c,b);e=this.getOptionList(c,"14",null,d);break}return e},removeT15:function(d,c,g){var e=HashTable.get(d).单选空格集合[c],b=e.选项组.选项集合,f=b.length;if(f<=SetManage.option.T15.min){this.removeIsEmpty();return""}for(var h=e.答案ID,a=0;a<f;a++)if(a==g){if(h==b[a].ID){e.答案ID=null;AnswerGroup.refT15(d,c,false)}b.splice(a,1);return this.getOptionList(d,"15",c,b)}return""},removeT8011:function(c,j,h){var b=HashTable.get(c),g=b.选项组ID,d=b.选项集合,f=d.length,e;if(f<=SetManage.option.T8011.min){this.removeIsEmpty();return""}for(var i=b.答案ID,a=0;a<f;a++)if(a==h){e=d[a].ID;if(i==e){b.答案ID=null;AnswerGroup.refT8011(c,false)}AnswerGroup.refT8011Sib(c,g,e);d.splice(a,1);return this.getOptionList(c,"8011",null,d)}return""},refurbish:function(b,a){$(b).parent("div").parent("div").html(a)}},MultipleOption={getT11:function(a,d){var h=d.选项列表,g=MultipleManage.getOptionList(a,"11",null,h),e=MultipleManage.getHeader(a,"11",null),f=MultipleManage.getOptionModule("11",e,g),c=HtmlManage.getMarkHtml("选项"),b=HtmlManage.getAutoHtml(f);return HtmlManage.getBarHtml(c,b)},getT12:function(a,d){var h=d.选项列表,g=MultipleManage.getOptionList(a,"12",null,h),e=MultipleManage.getHeader(a,"12",null),f=MultipleManage.getOptionModule("12",e,g),c=HtmlManage.getMarkHtml("选项"),b=HtmlManage.getAutoHtml(f);return HtmlManage.getBarHtml(c,b)},getT14:function(a,d){var h=d.选项组.选项集合,g=MultipleManage.getOptionList(a,"14",null,h),e=MultipleManage.getHeader(a,"14",null),f=MultipleManage.getOptionModule("14",e,g),c=HtmlManage.getMarkHtml("选项"),b=HtmlManage.getAutoHtml(f);return HtmlManage.getBarHtmlStyle(c,b,"width:790px;")},getT15:function(b,a,e){var f=MultipleManage.getOptionList(b,"15",a,e),c=MultipleManage.getHeader(b,"15",a),d=MultipleManage.getOptionModule("15",c,f);return d},getT8011:function(a,d){var g=MultipleManage.getOptionList(a,"8011",null,d.选项集合),e=MultipleManage.getHeader(a,"8011",null),f=MultipleManage.getOptionModule("8011",e,g),c=HtmlManage.getMarkHtml("选项组"),b=HtmlManage.getAutoHtml(f);return HtmlManage.getBarHtml(c,b)}},MultipleBlank={getTipMsg:function(){return'<span class="g_b_more_b_l_tip">(还未插入空格,请编辑题干并插入空格)</span>'},getNumHtml:function(a){return'<div class="E_H_L_B_Order">'+a+".</div>"},getGroupCellT13:function(b,a,c){var e=MultipleManage.getHeader(b,"13",a),g=MultipleManage.getBlankList(b,"13",a,c),d=this.getNumHtml(a+1),f=MultipleManage.getBlankModule(e,g);return HtmlManage.getBarHtml(d,f)},getGroupListT13:function(e,f){for(var d=f.填空空格集合,c=d.length,b="",a=0;a<c;a++)b+=this.getGroupCellT13(e,a,d[a].填空空格答案集合);return c==0?this.getTipMsg():b},getBlankT13:function(c,d){var b=HtmlManage.getMarkHtml("空格"),a='<div class="g_b_more_b_list g_b_more_b_g_listT13">'+this.getGroupListT13(c,d)+"</div>";return HtmlManage.getBarHtml(b,a)},getCellT14:function(c,a,b,d){return'<div class="g_b_more_b_cellT14"><span class="g_b_more_b_markT14">'+parseInt(a+1)+'.</span><a class="htmlNavNor g_b_more_b_inputT14 '+b+'" href="javascript:void(0)" onclick="AnswerColumn.showListT14(this,\''+c+"','"+a+"');\" >"+d+"</a></div>"},getListT14:function(l,h){for(var i=h.选词空格集合,f=i.length,c,d,e,g="",a=0;a<f;a++){d="";e="选择第"+(a+1)+"个空格的答案";c=i[a].答案ID;if(c!=null)for(var j=h.选项组.选项集合,k=j.length,b=0;b<k;b++)if(j[b].ID==c){d="htmlNavFul";e="已选择[ "+DataManage.getUpperCase(b)+" ]";break}g+=this.getCellT14(l,a,d,e)}return f==0?this.getTipMsg():g},getBlankT14:function(c,d){var b=HtmlManage.getMarkHtml("空格"),a='<div class="g_b_more_b_list g_b_more_b_listT14">'+this.getListT14(c,d)+"</div>";return HtmlManage.getBarHtmlStyle(b,a,"width:790px;")},getGroupCellT15:function(b,a,c){var d=this.getNumHtml(a+1),e=AnswerGroup.getT15(b,a,c.答案ID),f=MultipleOption.getT15(b,a,c.选项组.选项集合);return HtmlManage.getBarHtml(d,e+f)},getGroupListT15:function(e,f){for(var d=f.单选空格集合,c=d.length,b="",a=0;a<c;a++)b+=this.getGroupCellT15(e,a,d[a]);return c==0?this.getTipMsg():b},getBlankT15:function(c,d){var b=HtmlManage.getMarkHtml("空格"),a='<div class="g_b_more_b_list g_b_more_b_listT15">'+this.getGroupListT15(c,d)+"</div>";return HtmlManage.getBarHtmlStyle(b,a,"width:892px;")}},SpaceGroup={TempDiv:0,isInit:false,initTemp:function(){this.TempDiv=$("<div>",{style:"display:none;"}).appendTo("body");this.isInit=true},getChild:function(b,a){this.isInit||this.initTemp();return this.TempDiv.html(a||"").find("img.UnderLine"+b)},getLen:function(a,b){switch(b){case"13":return a.填空空格集合.length;break;case"14":return a.选词空格集合.length;break;case"15":return a.单选空格集合.length;break;default:alert("没有找到相关项")}},getArg:function(a){return a.substring(a.indexOf("index=")+6,a.length).split("&")[0]},getOrder:function(a){a.each(function(a){$(this).attr("src",LKConfig.URLAssembly.Subject.Images.get("UnderLine")+"?index="+(a+1))});return this.TempDiv.html()},addT13:function(e,c,d){var b=e.填空空格集合,a={填空空格答案集合:[{答案内容:""}]};c?b.splice(d,0,a):b.push(a)},delT13:function(b,a){if(a.isEmpty){b.填空空格集合=[];return}b.填空空格集合.splice(a.start,a.length)},addT14:function(e,c,d){var b=e.选词空格集合,a={答案ID:null};c?b.splice(d,0,a):b.push(a)},delT14:function(b,a){if(a.isEmpty){b.选词空格集合=[];return}b.选词空格集合.splice(a.start,a.length)},addT15:function(g,f,a){var b=g.单选空格集合,e={选项组:{选项集合:[{选项内容HTML:"",选项内容文本:"",ID:DataManage.getGuid()},{选项内容HTML:"",选项内容文本:"",ID:DataManage.getGuid()},{选项内容HTML:"",选项内容文本:"",ID:DataManage.getGuid()},{选项内容HTML:"",选项内容文本:"",ID:DataManage.getGuid()}]},答案ID:null};f?b.splice(a,0,e):b.push(e);var d=b.length;if(d==0)return;var c=IFrameFckEditor.settings;c.guidGroup=a!=undefined?a:d-1;IFrameFckEditor.refNavOptionT15(c);IFrameFckEditor.refHandleT15(c)},delT15:function(d,b){var a=IFrameFckEditor.settings;if(b.isEmpty){d.单选空格集合=[];IFrameFckEditor.refNavOptionT15(a,"");IFrameFckEditor.refHandleT15(a,"");return}var c=d.单选空格集合,f=c.length;c.splice(b.start,b.length);var e=parseInt(a.guidGroup);if(e>=b.start){a.guidGroup=f-b.length-1;IFrameFckEditor.refNavOptionT15(a);IFrameFckEditor.refHandleT15(a)}},insert:function(f,d,a){var b=HashTable.get(d),c=this.getLen(b,a);if(c>=SetManage.getSpaceMax(a)){HandleTip.fullMsgSpace(f,a);return}var e='<img class="UnderLine'+a+'" src="'+LKConfig.URLAssembly.Subject.Images.get("UnderLine")+"?index="+(c+1)+'" />';IFrameFckEditor.insertFckHtml(e,function(c){c&&SpaceGroup.finishAdd(b,a)})},equalsAdd:function(e){for(var f=e.size(),b=false,d,c,a=0;a<f;a++){c=SpaceGroup.getArg(e[a].src);if(a+1!=c){b=true;d=a;break}}return{ischange:b,start:d}},finishAdd:function(d,e){var b=this.getChild(e,IFrameFckEditor.getFckInnerHtml()),c=this.equalsAdd(b),a=c.ischange;switch(e){case"13":this.addT13(d,a,c.start);a&&IFrameFckEditor.renSetHtml(this.getOrder(b));break;case"14":this.addT14(d,a,c.start);a&&IFrameFckEditor.renSetHtml(this.getOrder(b));break;case"15":this.addT15(d,a,c.start);a&&IFrameFckEditor.renSetHtml(this.getOrder(b))}},equalsDel:function(f,c){var b=f.size(),g;if(b==0)return{ischange:true,issetHtml:false,isEmpty:true};else if(b==c)return{ischange:false,issetHtml:false};for(var e={},d=0;d<b;d++)e[SpaceGroup.getArg(f[d].src)]=true;for(var a=0;a<c;a++)if(!e[a+1])return{ischange:true,issetHtml:a!=c-1,start:a,length:c-b}},finishDel:function(h,f,i,g){var b=HashTable.get(h),j=this.getLen(b,f),c=this.getChild(f,i),a=this.equalsDel(c,j),e=a.ischange,d=a.issetHtml;switch(f){case"13":e&&this.delT13(b,a);d&&g(this.getOrder(c));break;case"14":e&&this.delT14(b,a);d&&g(this.getOrder(c));break;case"15":e&&this.delT15(b,a);d&&g(this.getOrder(c))}}},LinkManage={getInput:function(c,b,a,d){var e=b=="Left"?DataManage.getUpperCase(a):DataManage.getLowerCase(a);return'<span class="g_b_link_mark" >'+e+'.</span><input type="text" value="'+d+'" onchange="TextEditor.changeLink(this,\''+c+"','"+b+"','"+a+"')\"/>"},getInputDelete:function(c,b,a){var d=b=="Left"?"左选框":"右选框";return'<a title="删除'+d+"第"+parseInt(a+1)+'个选项" class="deleteBox" style="margin-top:6px;"  href="javascript:void(0)"onclick="LinkManage.remove(this,\''+c+"','"+b+"','"+a+"');\" ></a>"},getInputCell:function(a,b,c,d){var f=this.getInput(a,b,c,d),e=this.getInputDelete(a,b,c),g=f+e;return'<div class="g_b_link_cell" onmouseover="MouseManage.T30'+b+"(this,'"+a+'\');MouseManage.show();" onmouseout="MouseManage.hide();">'+g+"</div>"},getInputList:function(f,g,c){for(var b,d="",e=c.length,a=0;a<e;a++){b=c[a].选项内容文本;d+=this.getInputCell(f,g,a,b)}return d},getAnswer:function(c,e,d,a){var b=a!="请选择"?"htmlNavFul":"";return'<a class="htmlNavNor g_b_link_answer '+b+'" href="javascript:void(0)" onclick="AnswerColumn.showListT30(this,\''+c+"','"+e+"','"+d+"');\" >"+a+"</a>"},getAnswerDelete:function(b,a){return'<a title="删除第'+parseInt(a+1)+'个答案栏" class="deleteBox" style="margin-top:7px;"  href="javascript:void(0)"onclick="LinkManage.remove(this,\''+b+"','Answer','"+a+"');\" ></a>"},getAnswerCell:function(a,b,g,f){var h='<span  class="g_b_link_mark">'+(parseInt(b)+1)+".</span>",e=this.getAnswer(a,"Left",b,g),d=this.getAnswer(a,"Right",b,f),c=this.getAnswerDelete(a,b),i=h+e+d+c;return'<div class="g_b_link_cell" onmouseover="MouseManage.T30Answer(this,\''+a+'\');MouseManage.show();" onmouseout="MouseManage.hide();">'+i+"</div>"},getAnswerList:function(o,g){for(var j=g.连线题左选项集合,m=j.length,i=g.连线题右选项集合,l=i.length,h=g.连线题答案集合,n=h.length,f,e,d,c,k="",b=0;b<n;b++){f=h[b].连线题左选项ID;d="请选择";if(f!=null)for(var a=0;a<m;a++)if(f==j[a].ID){d=DataManage.getUpperCase(a);break}e=h[b].连线题右选项ID;c="请选择";if(e!=null)for(var a=0;a<l;a++)if(e==i[a].ID){c=DataManage.getLowerCase(a);break}k+=this.getAnswerCell(o,b,d,c)}return k},getHeader:function(c,b){var a;switch(b){case"Left":a=["左选项框","新增左选框选项","新增选项"];break;case"Right":a=["右选项框","新增右选框选项","新增选项"];break;case"Answer":a=["答案栏","新增答案栏","新增答案"];break;default:alert("没有找到相关项");return""}var d='<div class="module_b_header"><span>'+a[0]+'</span><a class="iconAdd" title="'+a[1]+'" href="javascript:void(0)" onclick="LinkManage.insert(this,\''+c+"','"+b+"');\" >"+a[2]+"</a></div>";return d},getModuleInput:function(a,b){return'<div class="modulebox module_b_inputT30">'+a+'<div class="module_b_body">'+b+"</div></div>"},getModuleAnswer:function(a,b){return'<div class="modulebox module_b_answerT30">'+a+'<div class="module_b_body">'+b+"</div></div>"},getLinkLeft:function(a,b){var c=b.连线题左选项集合,f=this.getInputList(a,"Left",c),d=this.getHeader(a,"Left"),e=this.getModuleInput(d,f);return e},getLinkRight:function(a,b){var c=b.连线题右选项集合,f=this.getInputList(a,"Right",c),d=this.getHeader(a,"Right"),e=this.getModuleInput(d,f);return e},getLinkAnswer:function(a,b){var e=this.getAnswerList(a,b),c=this.getHeader(a,"Answer"),d=this.getModuleAnswer(c,e);return d},getLink:function(a,b){var g=HtmlManage.getMarkHtml("连线框"),f=this.getLinkLeft(a,b),d=this.getLinkRight(a,b),c=this.getLinkAnswer(a,b),e='<div class="g_b_link">'+f+d+c+"</div>";return HtmlManage.getBarHtml(g,e)},insert:function(b,c,d){var a="";switch(d){case"Left":a=this.insertInputLeft(b,c);break;case"Right":a=this.insertInputRight(b,c);break;case"Answer":a=this.insertAnswer(b,c);break;default:alert("没有找到相关项")}this.appendHtml(b,a)},insertInput:function(f,d,a,c){var b=c.length;if(b>=SetManage.link[a].max){HandleTip.fullMsgT30(f,a);return""}var e=this.getInputCell(d,a,b,"");this.putJsonInput(c);return e},insertInputLeft:function(c,a){var b=HashTable.get(a).连线题左选项集合;return this.insertInput(c,a,"Left",b)},insertInputRight:function(c,a){var b=HashTable.get(a).连线题右选项集合;return this.insertInput(c,a,"Right",b)},insertAnswer:function(e,b){var c=HashTable.get(b).连线题答案集合,a=c.length;if(a>=SetManage.link.Answer.max){HandleTip.fullMsgT30(e,"Answer");return""}var d=this.getAnswerCell(b,a,"请选择","请选择");this.putJsonAnswer(c);return d},putJsonInput:function(a){a.push({选项内容HTML:"",选项内容文本:"",ID:DataManage.getGuid()})},putJsonAnswer:function(a){a.push({连线题左选项ID:null,连线题右选项ID:null})},appendHtml:function(b,a){$(b).parent("div").next("div").append(a)},remove:function(e,a,c,b){var d=this["remove"+c](a,b);this.refurbish(e,d)},removeLeft:function(e,j){var d=HashTable.get(e),b=d.连线题左选项集合,h=b.length,g,f=d.连线题答案集合,i=f.length;if(h<=SetManage.link.Left.min){MultipleManage.removeIsEmpty();return""}for(var a=0;a<h;a++)if(a==j){g=b[a].ID;b.splice(a,1);for(var c=0;c<i;c++)if(f[c].连线题左选项ID==g)f[c].连线题左选项ID=null;this.refAnswer(e,d);return this.getInputList(e,"Left",b)}return""},removeRight:function(e,j){var d=HashTable.get(e),b=d.连线题右选项集合,h=b.length,g,f=d.连线题答案集合,i=f.length;if(h<=SetManage.link.Right.min){MultipleManage.removeIsEmpty();return""}for(var a=0;a<h;a++)if(a==j){g=b[a].ID;b.splice(a,1);for(var c=0;c<i;c++)if(f[c].连线题右选项ID==g)f[c].连线题右选项ID=null;this.refAnswer(e,d);return this.getInputList(e,"Right",b)}return""},removeAnswer:function(d,f){var c=HashTable.get(d),e=c.连线题答案集合,b=e.length;if(b<=SetManage.link.Answer.min){MultipleManage.removeIsEmpty();return""}for(var a=0;a<b;a++)if(a==f){e.splice(a,1);return this.getAnswerList(d,c)}return""},refAnswer:function(a,b){var c=this.getAnswerList(a,b);$("#"+a).children("div:eq(1)").children("div:eq(1)").children("div:eq(2)").children("div:eq(1)").html(c)},refurbish:function(b,a){$(b).parent("div").parent("div").html(a)}},MulitpleSubject={menuBox:0,queTypesBox:0,queTypesIFrame:0,opGroupBoxMsg:0,isMoveUpDown:false,insSettings:{parGuidTeam:0,curGuidTeam:0},getCellHeaderTitle:function(a){var b=HashTable.get(a),c=b.题干文本;return DataManage.getCutPoint(c,30)||"暂无"},setCellHeaderTitle:function(b,a){if(this.isChild(b)){a="题干："+(DataManage.getCutPoint(a,30)||"暂无");$("#"+b).prev("div.g_b_more_s_b_c_head").children("label").text(a)}},getCellHeader:function(d,a,c,e){var b=SetManage.names["T"+c];return'<div class="g_b_more_s_b_c_head">   <span names="'+b+'" >'+(parseInt(e)+1)+".["+b+"]</span>   <label>题干："+this.getCellHeaderTitle(a)+'</label>   <div class="g_b_more_s_b_c_h_set" isShow=\'false\' >       <a href="javascript:void(0)" class="g_b_more_s_h_set_up" title="上移"            onclick="MulitpleSubject.cellUpDown(this,\''+d+"','"+a+"','"+c+'\',\'true\');"></a>       <a href="javascript:void(0)" class="g_b_more_s_h_set_down" title="下移"            onclick="MulitpleSubject.cellUpDown(this,\''+d+"','"+a+"','"+c+'\',\'false\');"></a>       <a href="javascript:void(0)" class="g_b_more_s_h_set_min" title="最小化'+b+'" names="'+b+'"            onclick="MulitpleSubject.cellMinMax(this,\''+a+'\');"></a>       <a href="javascript:void(0)" class="g_b_more_s_b_c_h_s_menu" title="设置'+b+'"            onclick="MulitpleSubject.showMenu(this,\''+d+"','"+a+"','"+c+"');\"></a>   </div></div>"},getCellContT40:function(a,b,c){return'<div class="g_b_more_s_b_c_cont" isChild="true" id="'+a+'" >'+HtmlManage.getMarkToContHtml(a,b,c)+"</div>"},getCellContT8011OpGroup:function(b,c,a){return'<div class="g_b_more_s_b_c_t8011_right" id="'+a+'">'+MultipleOption.getT8011(b,c)+"</div>"},getCellContT8011:function(a,b,e){var c=b.选项组ID,d=$("#"+c).length==0?this.getCellContT8011OpGroup(a,b,c):"";return'<div class="g_b_more_s_b_c_t8011_left" isChild="true" id="'+a+'" >'+HtmlManage.getMarkToContHtml(a,b,e)+"</div>"+d},getCell:function(e,c,d,a,f){var b='<div class="g_b_more_s_b_cell">';b+=this.getCellHeader(e,c,a,f);switch(a){case"8011":b+=this.getCellContT8011(c,d,a);break;default:b+=this.getCellContT40(c,d,a)}return b+="</div>"},getListHeader:function(a){return'<div class="g_b_more_s_header"><h2><span>小题列表</span><a class="iconAdd" href="javascript:void(0)" onclick="MulitpleSubject.addQueTypesAfter(this,\''+a+'\')">新增小题型</a></h2><div class="g_b_more_s_h_set"><a class="g_b_more_s_h_set_min" href="javascript:void(0)" title="最小化全部小题型" onclick="MulitpleSubject.minAll(\''+a+'\');"></a><a class="g_b_more_s_h_set_max" href="javascript:void(0)" title="最大化全部小题型" onclick="MulitpleSubject.maxAll(\''+a+"');\"></a></div></div>"},getListContent:function(a){return'<div class="g_b_more_s_body" id="'+a+'List"></div>'},getListHtml:function(a){var c=HtmlManage.getMarkHtml("小题列表"),b='<div class="g_b_more_subject">'+this.getListHeader(a)+this.getListContent(a)+"</div>";return HtmlManage.getBarHtml(c,b)},eveCellHover:function(a){a.hover(function(){MulitpleSubject.showCellNav(this)},function(){MulitpleSubject.hideCellNav(this)})},showCellNav:function(f){var c=$(f),e=c.children("div"),d=e.eq(0).children("div"),a=d.children("a");c.prev("div").length==1?a.eq(0).show():a.eq(0).hide();c.next("div").length==1?a.eq(1).show():a.eq(1).hide();var b=a.eq(2);if(e.eq(1).css("display")!="none")b.removeClass("g_b_more_s_h_set_max").attr("title","最小化"+b.attr("names"));else b.addClass("g_b_more_s_h_set_max").attr("title","最大化"+b.attr("names"));d.show()},hideCellNav:function(a){$(a).children("div:first").children("div").hide()},minAll:function(a){var b=HtmlManage.getT40ChsElem(a);b.each(function(){$(this).children("div:gt(0)").hide()})},maxAll:function(a){var b=HtmlManage.getT40ChsElem(a);b.each(function(){$(this).children("div:gt(0)").show()})},cellMin:function(a,b){b.slideUp("fast",function(){a.addClass("g_b_more_s_h_set_max").attr("title","最大化"+a.attr("names"))}).next("div").slideUp("fast")},cellMax:function(a,b){b.slideDown("fast",function(){a.removeClass("g_b_more_s_h_set_max").attr("title","最小化"+a.attr("names"))}).next("div").slideDown("fast")},cellMinMax:function(d,c){var a=$("#"+c),b=$(d);a.css("display")!="none"?this.cellMin(b,a):this.cellMax(b,a)},cellUpDown:function(i,e,d,g,h){if(this.isMoveUpDown)return;this.isMoveUpDown=true;var f=$(i),b=f.parent("div"),a=$("#"+d).parent("div"),c=this;a.addClass("html_move").fadeTo("normal","0.5",function(){b.hide();var j=a.index(),l=b.siblings("span"),f,m=l.attr("names"),d,i,k;if(h=="true"){f=j;d=a.prev("div").before(a)}else{f=j+2;d=a.next("div").after(a)}l.html(f+".["+m+"]");i=d.children("div:first").children("span");k=i.attr("names");i.html(j+1+".["+k+"]");a.fadeTo("normal","1",function(){a.css("filter","none");g=="8011"&&c.refT8011QuoteList(e)});DataManage.timeOut(function(){a.removeClass("html_move");c.isMoveUpDown=false},600)})},removeCell:function(c,b,a){this.menuBox.hide();switch(a){case"8011":this.removeCellT80(c,b,a);break;default:this.removeCellT40(c,b,a)}},removeCellT40:function(b,a,c){var e=this,d=$("#"+a).parent("div").index()+1;HandleTip.removeMsg({isRemove:true,header:"确定删除第"+d+"小题-"+SetManage.names["T"+c]+"？"},function(c){e.removeCellNow(b,a,function(){c&&c()})})},removeCellT80:function(c,a){var j=$("#"+a).parent("div").index(),d=HashTable.get(a),i=d.选项集合,g=d.选项组ID,b=true,e="",f=this;if(i.length!=0){var h=HtmlManage.getT40ChsElem(c);h.each(function(d){var c=$(this).children("div:eq(1)").attr("id");if(a!=c&&g==HashTable.get(c).选项组ID){b=false;e+="<samp>第"+(d+1)+"小题</samp>"}})}HandleTip.removeMsg({isRemove:b,header:b?"确定删除第"+(j+1)+"小题-单选题？":"无法删除该小题,已被以下小题引用选项组.",content:b?"":e},function(b){f.removeCellNow(c,a,function(){f.refT8011QuoteList(c);b&&b()})})},removeCellNow:function(e,c,d){var b=$("#"+c),a=b.parent("div");b.prev("div").children("div").remove();a.addClass("html_remove");DataManage.timeOut(function(){a.remove();MulitpleSubject.refCellHeadNum(e);HashTable.remove(c);d&&d()},600)},refCellHeadNum:function(b){var c=HtmlManage.getT40ChsElem(b),a;c.each(function(b){a=$(this).children("div:first").children("span");a.html(b+1+".["+a.attr("names")+"]")})},isChild:function(a){return $("#"+a).attr("isChild")=="true"?true:false},getT8011OpQuoteSelf:function(a){return'<span>见本小题的选项组</span><a href="javascript:void(0)" onclick="MulitpleSubject.showOpGroupMsg(this,\''+a+"',false);\">引用选项组</a>"},getT8011OpQuoteTother:function(a,b){return"<span>见第"+b+'小题的选项组</span><a href="javascript:void(0)" onclick="MulitpleSubject.showOpGroupMsg(this,\''+a+'\',true);">新增选项组</a><a href="javascript:void(0)" onclick="MulitpleSubject.showOpGroupMsg(this,\''+a+"',false);\">引用其他选项组</a>"},getT8011OpQuote:function(b,c,f){var a=f?this.getT8011OpQuoteUpdate(b,c):this.getT8011OpQuoteNew(b,c);a='<div class="g_b_more_t8011_op_box">'+a+"</div>";var e=HtmlManage.getMarkHtml("选项"),d=HtmlManage.getAutoHtml(a);return HtmlManage.getBarHtml(e,d)},getT8011OpQuoteNew:function(b,c){var a=$("#"+c.选项组ID);if(a.length==0)return this.getT8011OpQuoteSelf(b);else{var d=a.parent("div").index()+1;return this.getT8011OpQuoteTother(b,d)}},getT8011OpQuoteUpdate:function(a,c){var b=c.选项组ID;if($("#"+a).next("div[id='"+b+"']").length!=0)return this.getT8011OpQuoteSelf(a);else{var d=$("#"+b).parent("div").index()+1;return this.getT8011OpQuoteTother(a,d)}},initOpGroupMsg:function(){this.opGroupBoxMsg=this.opGroupBoxMsg||new MsgBox("",{isTipMsg:true,isDireTop:true,isAutoHide:true})},setOpGroupMsgSite:function(b){var a=DataManage.getOffset(b);a.top+=30;this.opGroupBoxMsg.moveElem(a)},showOpGroupMsg:function(c,a,b){this.initOpGroupMsg();this.setOpGroupMsgSite(c);b?this.setOpGroupMsgNewCont(a):this.setOpGroupMsgQuoteCont(a);this.opGroupBoxMsg.show()},hideOpGroupMsg:function(){this.opGroupBoxMsg.hide()},setOpGroupMsgNewCont:function(a){var b='<div class="g_b_more_t8011_op_group"><span>确定新增本小题的选项组?</span><a href="javascript:void(0)" onclick="MulitpleSubject.newT8011OpGroup(\''+a+'\');">确定</a><a href="javascript:void(0)" onclick="MulitpleSubject.hideOpGroupMsg()">取消</a></div>';this.opGroupBoxMsg.setContent(b)},setOpGroupMsgQuoteCont:function(b){var f=HashTable.get(b),e=f.选项组ID,i=f.选项集合,g=i.length,d="",c="",h=$("#"+b).parent("div").parent("div").children("div");h.each(function(a){var h=$(this).children("div:eq(1)").attr("id"),i=HashTable.get(h),f=i.选项组ID;if(g!=0&&h!=b&&e==f)d+="<samp>第["+(a+1)+"]小题</samp>";else if(i.选项集合.length!=0&&e!=f)c+='<a href="javascript:void(0)" onclick="MulitpleSubject.QuoteT8011OpGroup(\''+b+"','"+f+"','"+(a+1)+"');\">第["+(a+1)+"]小题</a>";else c+="<samp>第["+(a+1)+"]小题</samp>"});var a='<div class="g_b_more_t8011_op_group">';if(d!=""){a+="<span>不允许引用,本小题选项组已被引用</span>";a+=d}else if(c!="")a+="<span>请选择可引用小题的选项组?</span>"+c;else a+="<span>没有可引用的选项组</span>";a+="</div>";this.opGroupBoxMsg.setContent(a)},newT8011OpGroup:function(a){this.hideOpGroupMsg();var b=HashTable.get(a),e=DataManage.getGuid();b.选项组ID=e;b.答案ID=null;b.选项集合=[];for(var g=0;g<5;g++)b.选项集合.push({选项内容HTML:"",选项内容文本:"",ID:DataManage.getGuid()});var f=this.getCellContT8011OpGroup(a,b,e),c=$("#"+a),d=c.next("div");d.length!=0?d.replaceWith($(f)):c.after($(f));this.refT8011Quote(a,this.getT8011OpQuoteSelf(a));AnswerGroup.refT8011(a,false)},QuoteT8011OpGroup:function(a,c,d){this.hideOpGroupMsg();var b=HashTable.get(a);b.选项组ID=c;b.答案ID=null;b.选项集合=[];$("#"+a).next("div").fadeOut("fast",function(){$(this).remove()});this.refT8011Quote(a,this.getT8011OpQuoteTother(a,d));AnswerGroup.refT8011(a,false)},refT8011Quote:function(a,b){$("#"+a).children("div:eq(1)").children("div:eq(1)").children("div:eq(0)").html(b)},refT8011QuoteList:function(c){var d=HtmlManage.getT40ChsElem(c),a,b,e=this;d.each(function(){a=$(this).children("div:eq(1)").attr("id");b=HashTable.get(a);$("#"+a).children("div:eq(1)").replaceWith(e.getT8011OpQuote(a,b,true))})},initMenu:function(){this.menuBox=this.menuBox||new MsgBox("",{isTipMsg:false,isAutoHide:true,show:false,afterHide:function(){}})},getMenuLi:function(a,b,c){return'<a href="javascript:void(0)" title="'+c+'" style="margin:0px;" onclick="'+a+'">'+b+"</a>"},getMenuLiNone:function(a,b,c){return'<a title="'+c+'" style="margin:0px;cursor:text;color:#999;"  onclick="'+a+'">'+b+"</a>"},getMenuInsert:function(b,a){return this.getMenuLi("MulitpleSubject.addQueTypesBoth(this,'"+b+"','"+a+"')","插入小题","该小题后插入新小题")},getMenuRemove:function(b,a,c){return this.getMenuLi("MulitpleSubject.removeCell('"+b+"','"+a+"','"+c+"');","删除该题","删除该小题")},getMenuRecogLink:function(a){return this.getMenuLi("Recog试题管理.显示识别输入(this,'"+a+"',1);MulitpleSubject.hideMunu();","识别输入","识别输入")},getMenuRecogNone:function(a,b){return this.getMenuLiNone("Recog试题管理.显示识别输入(this,'"+a+"',null);","识别输入",b)},getMenuRecog:function(a,c){switch(c){case"11":case"12":case"14":return this.getMenuRecogLink(a);break;case"15":var b=HashTable.get(a);if(b.单选空格集合.length!=0)return this.getMenuRecogLink(a);else return this.getMenuRecogNone(a,"'题干'内容未包含空格!(至少1个空格),请请编辑题干并插入空格，再操作'识别输入'");break;case"8011":var b=HashTable.get(a),d=b.选项组ID,e=$("#"+d,$("#"+a).parent("div"));if(e.length!=0)return this.getMenuRecogLink(a);else return this.getMenuRecogNone(a,"该小题引用其他小题的选项组,不支持'识别输入'");break;default:return this.getMenuRecogNone(a,SetManage.getNames(c)+",暂不支持'识别输入'")}},getMenuPreview:function(a){return this.getMenuLi("View试题管理.显示试题预览('"+a+"');MulitpleSubject.hideMunu();","预览试题","预览该小题")},getMenu:function(c,a,b){var d='<div class="g_b_more_s_munu">';switch(b){case"11":case"12":case"13":case"14":case"15":case"20":case"30":case"60":case"61":case"62":case"63":case"64":case"65":case"66":case"67":case"68":case"69":case"8011":d+=this.getMenuRecog(a,b)+this.getMenuPreview(a)+this.getMenuInsert(c,a)+this.getMenuRemove(c,a,b);break;default:return"没有找到相关项"}return d+="<div>"},setMunu:function(b,a,c){var d=this.getMenu(b,a,c);this.menuBox.setContent(d)},moveMenu:function(b){var a=DataManage.getOffset(b);a.left+=16;a.top-=1;this.menuBox.moveElem(a)},showMenu:function(d,b,a,c){this.initMenu();this.setMunu(b,a,c);this.moveMenu(d);this.menuBox.show()},hideMunu:function(){this.menuBox&&this.menuBox.hide()},initQueTypesBox:function(a){this.queTypesBox=this.queTypesBox||new MsgBox("<iframe onload=\"MulitpleSubject.loadQueTypesBox(this,'"+a+'\');" frameborder="0" scrolling="no" width="383px" height="160px"></iframe>',{isTipMsg:false,isAutoHide:true,show:false}).set内部对象属性("iframe","src",LKConfig.URLAssembly.Subject.IFrame.get("ChildQuestionTypes"))},loadQueTypesBox:function(b,a){this.queTypesIFrame=b.contentWindow.ChildQueTypesManage;this.sendQueTypes(a)},moveQueTypesBoxAfter:function(b){var a=DataManage.getOffset(b);a.left+=0;a.top+=23;this.queTypesBox.moveElem(a)},moveQueTypesBoxBoth:function(c){var b=$("#"+c).prev("div"),a=DataManage.getOffset(b),d=DataManage.getInner(b);a.left+=d.width-387;a.top+=27;this.queTypesBox.moveElem(a)},showQueTypesBox:function(a){this.initQueTypesBox(a);this.queTypesBox.show();this.queTypesIFrame&&this.sendQueTypes(a)},addQueTypesAfter:function(b,a){this.showQueTypesBox(a);this.moveQueTypesBoxAfter(b);this.insSettings={parGuidTeam:a,curGuidTeam:0}},addQueTypesBoth:function(c,b,a){this.menuBox.hide();this.showQueTypesBox(b);this.moveQueTypesBoxBoth(a);this.insSettings={parGuidTeam:b,curGuidTeam:a}},addQueTypesTimeOut:function(a){a.addClass("html_insert");DataManage.timeOut(function(){a.removeClass("html_insert")},1e3)},sendQueTypes:function(a){var b=HashTable.get(a).小题型Enum;this.queTypesIFrame.receive(b)},receiveQueTypes:function(e){var d=this.insSettings,b=d.parGuidTeam,a=d.curGuidTeam;if(a==0){this.minAll(b);EditSubjectManage.newChildAfter(b,e)}else{var c=$("#"+a),f=c.prev("div").children("div").children("a:eq(2)");this.cellMin(f,c);EditSubjectManage.newChildBoth(b,a,e)}},minimizeQueTypes:function(){this.queTypesBox.hide()}},EditSubjectManage={isShow:false,isInit:false,hiddenBox:0,initHidden:function(){this.hiddenBox=this.hiddenBox||$("#ID_Hidden_Box")},fadeHalf:function(a){this.hiddenBox.fadeTo("normal","0.5",function(){EditSubjectManage.isShow=false;EditSubjectManage.fadeRenew();a&&a()})},fadeRenew:function(){this.hiddenBox.fadeTo("slow","1",function(){$(this).css("filter","none");EditSubjectManage.isShow=true})},setJsonData:function(w,d){d.ID=DataManage.getGuid();switch(w){case"11":for(var e=d.选项列表,p=d.答案ID,g,c,a=0;a<e.length;a++){c=DataManage.getGuid();g=e[a];if(g.ID==p)d.答案ID=c;g.ID=c}break;case"12":for(var e=d.选项列表,o=d.答案列表,v=o.length,h,c,j,a=0;a<e.length;a++){c=DataManage.getGuid();h=e[a];j=h.ID;h.ID=c;for(var b=0;b<v;b++)if(j==o[b]){o[b]=c;break}}break;case"14":for(var e=d.选项组.选项集合,i=d.选词空格集合,n=e.length,u=i.length,h,c,j,a=0;a<n;a++){c=DataManage.getGuid();h=e[a];j=h.ID;h.ID=c;for(var b=0;b<u;b++)if(j==i[b].答案ID)i[b].答案ID=c}break;case"15":for(var i=d.单选空格集合,u=i.length,k,e,n,g,c,a=0;a<u;a++){k=i[a];e=k.选项组.选项集合;n=e.length,p=k.答案ID;for(var b=0;b<n;b++){c=DataManage.getGuid();g=e[b];if(g.ID==p)k.答案ID=c;g.ID=c}}break;case"30":for(var r=d.连线题左选项集合,q=d.连线题右选项集合,f=d.连线题答案集合,c,m,t,a=0;a<r.length;a++){c=DataManage.getGuid();m=r[a];t=m.ID;for(var b=0;b<f.length;b++)if(f[b].连线题左选项ID==t)f[b].连线题左选项ID=c;m.ID=c}for(var l,s,a=0;a<q.length;a++){c=DataManage.getGuid();l=q[a];s=l.ID;for(var b=0;b<f.length;b++)if(f[b].连线题右选项ID==s)f[b].连线题右选项ID=c;l.ID=c}break;case"8011":var e=d.选项集合;d.选项组ID=DataManage.getGuid();for(var a=0;a<e.length;a++)e[a].ID=DataManage.getGuid()}return d},setJsonData8011:function(m,l){var a,c,b,d={},f={};l.选项组集合=[];for(var i=0;i<m.length;i++){a=m[i];a.ID=DataManage.getGuid();c=a.选项组ID;if(!d[c]){b=DataManage.getGuid();a.选项组ID=b;d[c]=b;for(var h=a.选项集合,g,k,e,j=0;j<h.length;j++){e=DataManage.getGuid();g=h[j];k=g.ID;g.ID=e;f[k]=e}a.答案ID=f[a.答案ID]||null;l.选项组集合.push({ID:b,选项集合:h})}else{a.选项组ID=d[c];a.选项集合=[];a.答案ID=f[a.答案ID]||null}}},getJsonData:function(b,a,c,d){$.extend(BaseManage,{guidTeam:b,mark:a,isNew:d,names:SetManage.names["T"+a]});return this.setJsonData(a,c)},setBase:function(a,b){HashTable.clear();HashTable.put(a,b);HtmlManage.setParentHtml(a,b);OutsideManage.initSort()},fadeBox:function(c,a,b){this.initHidden();this.isShow||c.call(this,a,b);this.isShow?this.fadeHalf(function(){c.call(EditSubjectManage,a,b)}):this.fadeRenew()},newChild:function(e,c,d){var b,a;b=DataManage.getGuid();a=DataManage.markToJson(c);a=this.setJsonData(c,a);HashTable.put(b,a);d(b,a)},newChildAfter:function(a,b){this.newChild(a,b,function(c,d){HtmlManage.insertCellAfter(a,c,d,b)})},newChildBoth:function(a,d,b){var c=$("#"+d).parent("div");this.newChild(a,b,function(d,e){HtmlManage.insertCellBoth(a,c,d,e,b)})},newParent:function(e){SetManage.outside.小题型Enum=e;var d,a;d=DataManage.getGuid();a=DataManage.markToJson(e);a.试题外部信息ID=DataManage.getGuid();a=this.getJsonData(d,e,a,true);this.setBase(d,a);switch(e){case"40":case"41":case"42":case"43":case"44":case"45":case"46":case"47":for(var b=a.子小题集合,c=0;c<b.length;c++)this.newChildAfter(d,b[c]);break;case"80":for(var b=a.子小题集合,c=0;c<b.length;c++)b[c]=DataManage.markToJson(b[c]);this.setJsonData8011(b,a);this.updateChildT40(d,b)}},updateChildT40:function(c,d){for(var f="",a,e=HtmlManage.getT40ListElem(c),b=0;b<d.length;b++){a=d[b];_chsGuidTeam=DataManage.getGuid();_chsMark=a.小题型Enum.toString();a.小题型Enum=_chsMark;if(_chsMark!="8011")a=this.setJsonData(_chsMark,a);HashTable.put(_chsGuidTeam,a);HtmlManage.insertCellByList(c,e,_chsGuidTeam,a,_chsMark,null)}},updateChildT8011:function(i,c){for(var h=c.子小题集合,a,g,e=c.选项组集合,d=[],f=0;f<h.length;f++){a=h[f];g=a.选项组ID;for(var b=0;b<e.length;b++)if(e[b].ID==g){a.选项集合=e[b].选项集合;break}d.push(a)}this.setJsonData8011(d,c);this.updateChildT40(i,d)},updateParent:function(e){var c,a,d,b;c=e.outside;SetManage.outside=c;a=e.content;d=DataManage.getGuid();b=a.小题型Enum.toString();a.小题型Enum=b;a=this.getJsonData(d,b,a,false);this.setBase(d,a);IFrameQuestionTypesManage.setName(b);IFrameQuestionTypesManage.setState(c.试题状态Enum);BaseManage.is协同编辑||OutsideManage.initUpdatePublic(c.是否公开);switch(b){case"40":case"41":case"42":case"43":case"44":case"45":case"46":case"47":this.updateChildT40(d,a.子小题集合);break;case"80":this.updateChildT8011(d,a)}EqualsManage.cloneData({content:a,outside:c},b)},reNewSpecial:function(d,q){var a=DataManage.markToJson(q);switch(q){case"11":case"12":var e=HashTable.get(d),h=e.选项列表.length;if(h!=4){a.选项列表=[];for(var b=0;b<h;b++)a.选项列表.push({选项内容HTML:"",选项内容文本:"",ID:""})}break;case"14":var e=HashTable.get(d),h=e.选项组.选项集合.length;if(h!=15){var n=a.选项组;n.选项集合=[];for(var b=0;b<h;b++)n.选项集合.push({选项内容HTML:"",选项内容文本:"",ID:""})}break;case"30":var e=HashTable.get(d),k=e.连线题左选项集合.length,j=e.连线题右选项集合.length,o=e.连线题答案集合.length;if(k!=2){a.连线题左选项集合=[];for(var b=0;b<k;b++)a.连线题左选项集合.push({选项内容HTML:"",选项内容文本:"",ID:""})}if(j!=2){a.连线题右选项集合=[];for(var b=0;b<j;b++)a.连线题右选项集合.push({选项内容HTML:"",选项内容文本:"",ID:""})}if(o!=2){a.连线题答案集合=[];for(var b=0;b<o;b++)a.连线题答案集合.push({连线题左选项ID:null,连线题右选项ID:null})}break;case"40":case"41":case"42":case"43":case"44":case"45":case"46":case"47":a.子小题集合=[];var m=HtmlManage.getT40ChsElem(d),c,f,p=this;m.each(function(){c=$(this).children("div:eq(1)").attr("id");f=HashTable.get(c).小题型Enum;a.子小题集合.push(p.reNewSpecial(c,f))});break;case"80":a.子小题集合=[];var m=HtmlManage.getT40ChsElem(d),c,f,p=this,i;m.each(function(){c=$(this).children("div:eq(1)").attr("id");f=HashTable.get(c).小题型Enum;i=p.reNewSpecial(c,f);i.选项组ID=HashTable.get(c).选项组ID;a.子小题集合.push(i)});break;case"8011":var l=HashTable.get(d),g=l.选项集合.length;if(g==0){var s=l.选项组ID,r=$("#"+s).prev("div").attr("id");g=HashTable.get(r).选项集合.length}if(g!=5){a.选项集合=[];for(var b=0;b<g;b++)a.选项集合.push({选项内容HTML:"",选项内容文本:"",ID:""})}}return a},reNewParent:function(e,c){var b,a;b=DataManage.getGuid();a=this.reNewSpecial(e,c);a.试题外部信息ID=DataManage.getGuid();a=this.getJsonData(b,c,a,true);this.setBase(b,a);IFrameQuestionTypesManage.switchTypes(true);IFrameQuestionTypesManage.setMark(c);IFrameQuestionTypesManage.setName(c);BaseManage.is协同编辑||OutsideManage.initNewPublic(SetManage.outside.是否公开);switch(c){case"40":case"41":case"42":case"43":case"44":case"45":case"46":case"47":this.updateChildT40(b,a.子小题集合);break;case"80":var d=a.子小题集合;this.setJsonData8011(d,a);this.updateChildT40(b,d)}},reUpdateParent:function(f){var b,a,c,e,d=SetManage.outside;b=DataManage.getGuid();a=HashTable.get(f);c=a.小题型Enum;SetManage.outside.ID=a.试题外部信息ID;e=d.是否公开;a=this.getJsonData(b,c,a,false);this.setBase(b,a);IFrameQuestionTypesManage.switchTypes(false);IFrameQuestionTypesManage.setName(c);IFrameQuestionTypesManage.setState(d.试题状态Enum);BaseManage.is协同编辑||OutsideManage.initUpdatePublic(e);switch(c){case"40":case"41":case"42":case"43":case"44":case"45":case"46":case"47":this.updateChildT40(b,a.子小题集合);break;case"80":this.updateChildT8011(b,a)}EqualsManage.cloneData({content:a,outside:d},c)},refurbish:function(){},removeSubject:function(){},moveDownSubject:function(){},moveUpSubject:function(){}},IFrameQuestionTypesManage={questionBox:0,msgBox:0,iFrameElem:0,chs:0,chsFirst:0,chsLast:0,initQuestionBox:function(){var b=$("#ID_QuestionTypes_Box"),a=b.children("a");this.questionBox=b;this.chs=a;this.chsFirst=a.eq(0);this.chsLast=a.eq(1)},initMsgBox:function(){var a=this;a.msgBox=a.msgBox||new MsgBox('<iframe src="'+LKConfig.URLAssembly.Subject.IFrame.get("QuestionTypes")+'" onload="IFrameQuestionTypesManage.loadMsgBox(this);" frameborder="0" scrolling="no" width="383px" height="160px"></iframe>',{isTipMsg:false,isAutoHide:true,show:false,afterHide:function(){a.afterHide()}})},loadMsgBox:function(a){this.iFrameElem=a.contentWindow.QuestionTypesManage;this.send()},switchTypes:function(b){var a=b?0:1;this.chs.each(function(b){if(b==a)$(this).show();else $(this).hide()})},mouseOver:function(){this.chsFirst.addClass("E_S_L_B_Q_S_Hover")},mouseOut:function(){this.chsFirst.removeClass("E_S_L_B_Q_S_Hover")},setSite:function(d){var a=DataManage.getOffset(d),b=a.left-2,c=a.top+32;this.msgBox.moveTo(b,c)},show:function(a){if(!BaseManage.isNew)return;this.initMsgBox();if(this.msgBox.isVisible)return;this.setSite(a);this.msgBox.show();this.mouseOver();this.send()},afterHide:function(){this.mouseOut()},minimize:function(){this.msgBox.hide()},send:function(){var a=this;this.iFrameElem&&this.iFrameElem.receive(function(b){a.receive(b)},function(){a.minimize()})},receive:function(a){this.setMark(a);this.setName(a);EditSubjectManage.fadeBox(EditSubjectManage.newParent,a,null)},setMark:function(a){this.chsFirst.attr("mark",a)},setName:function(b){var a=SetManage.names["T"+b];if(BaseManage.isNew)this.chsFirst.children("span").text(a);else this.chsLast.children("span").text(a)},setState:function(a){var b=a==0?"[修改试题]":"[修改草稿]";this.chsLast.children("samp").text(b).show()}},OutsideManage={sortBox:0,publicBox:0,difficultBox:0,difficultAmount:0,isInit:false,isEstop:false,isPublic:false,initBox:function(){this.sortBox=this.sortBox||$("#ID_Sort_Box");this.publicBox=this.publicBox||$("#ID_Public_Box");this.difficultBox=this.difficultBox||$("#ID_Difficult_Box");this.difficultAmount=this.difficultAmount||$("#ID_Difficult_Amount")},setEstop:function(){if(this.isEstop)return;BaseManage.is协同编辑&&EditSubjectManage.hiddenBox.children("div.unxtbj").remove();this.isEstop=true},initSort:function(){if(BaseManage.is协同编辑||this.isInit)return;this.initBox();this.initDifficult();this.sortBox.lksort({norList:DataManage.clone(SetManage.outside.分类列表),afterUpdate:function(a){SetManage.outside.分类列表=DataManage.clone(a)}});this.isInit=true},initDifficult:function(){var a=SetManage.outside.难易度,b=SetManage.outside.答题人数;if(typeof b=="undefined"||b==0){this.updateDifficultAmount(a);this.difficultBox.css({"margin-top":"10px"}).slider({value:a,min:0,max:1,step:.1,range:"min",animate:true,slide:function(b,a){SetManage.outside.难易度=a.value;OutsideManage.updateDifficultAmount(a.value)}})}else this.difficultBox.css({"margin-top":"0px"}).html("<span>"+a+'</span><span style="color: #999;">(已做答题不能更改)</span>')},updateDifficultAmount:function(a){OutsideManage.difficultAmount.html(a+'度<span style="color: #999;">(值越小越难)</span>')},initNewPublic:function(a){this.isPublic=false;this.publicBox.show();this.publicBox.next("div").hide();a=a||SetManage.outside.是否公开;if(a)this.publicBox.children("input:first").attr("checked","checked");else this.publicBox.children("input:last").attr("checked","checked")},initUpdatePublic:function(a){this.isPublic=a;if(a){this.publicBox.hide();this.publicBox.next("div").show()}else{this.publicBox.show();this.publicBox.next("div").hide();this.publicBox.children("input:last").attr("checked","checked")}},setPublic:function(a){if(this.isPublic)return;SetManage.outside.是否公开=a=="1"?true:false}},ValidateManage={T11:function(i,b){for(var f=SetManage.compose.T11,h=f.length,d,a,g,e=0;e<h;e++){d=f[e];a=i[d];switch(d){case"题干文本":if(DataManage.isEmptyOrNull(a)){b({result:false,info:"题干内容为空"});return}break;case"选项列表":for(var c=0;c<a.length;c++){g=a[c].选项内容文本;if(DataManage.isEmptyOrNull(g)){b({result:false,info:"选项组:选项"+DataManage.getUpperCase(c)+"的内容为空"});return}}break;case"答案ID":if(DataManage.isEmptyOrNull(a)){b({result:false,info:"没有选择答案"});return}}}b({result:true,infor:""})},T12:function(i,b){for(var f=SetManage.compose.T12,h=f.length,d,a,g,e=0;e<h;e++){d=f[e];a=i[d];switch(d){case"题干文本":if(DataManage.isEmptyOrNull(a)){b({result:false,info:"题干内容为空"});return}break;case"选项列表":for(var c=0;c<a.length;c++){g=a[c].选项内容文本;if(DataManage.isEmptyOrNull(g)){b({result:false,info:"选项组:选项"+DataManage.getUpperCase(c)+"的内容为空"});return}}break;case"答案列表":if(a.length==0){b({result:false,info:"没有选择答案"});return}}}b({result:true,infor:""})},T13:function(o,a){for(var j=SetManage.compose.T13,n=j.length,e,c,i=0;i<n;i++){e=j[i];c=o[e];switch(e){case"题干文本":if(DataManage.isEmptyOrNull(c)){a({result:false,info:"题干内容为空"});return}break;case"填空空格集合":var m=c.length,g,k,f,h;if(m==0){a({result:false,info:"题干内容没有插入空格!"});return}for(var b=0;b<m;b++){g=c[b].填空空格答案集合;k=g.length;f=[];for(var d=0;d<k;d++){h=g[d].答案内容;if(DataManage.isEmptyOrNull(h)){a({result:false,info:"第"+(b+1)+"个空格的第"+(d+1)+"个备选答案为空"});return}f.push(h)}var l=false;DataManage.equalArray(f,function(c){if(c.result){a({result:false,info:"第"+(b+1)+"空格的第"+(c.info.start+1)+"个备选答案和第"+(c.info.end+1)+"个备选答案相同"});l=true}});if(l)return}}}a({result:true,infor:""})},T14:function(k,b){for(var g=SetManage.compose.T14,i=g.length,e,a,f=0;f<i;f++){e=g[f];a=k[e];switch(e){case"题干文本":if(DataManage.isEmptyOrNull(a)){b({result:false,info:"题干内容为空"});return}break;case"选项组":for(var h=a.选项集合,j=h.length,d=0;d<j;d++){_text=h[d].选项内容文本;if(DataManage.isEmptyOrNull(_text)){b({result:false,info:"选项组:选项"+DataManage.getUpperCase(d)+"的内容为空"});return}}break;case"选词空格集合":if(a.length==0){b({result:false,info:"题干内容没有插入空格!"});return}for(var c=0;c<a.length;c++)if(a[c].答案ID==null){b({result:false,info:"第"+(c+1)+"个空格没有选择答案"});return}}}b({result:true,infor:""})},T15:function(n,a){for(var g=SetManage.compose.T15,l=g.length,e,c,k,f=0;f<l;f++){e=g[f];c=n[e];switch(e){case"题干文本":if(DataManage.isEmptyOrNull(c)){a({result:false,info:"题干内容为空"});return}break;case"单选空格集合":var h=c.length;if(h==0){a({result:false,info:"题干内容没有插入空格!"});return}for(var b=0;b<h;b++){var i=c[b],o=i.答案ID;if(DataManage.isEmptyOrNull(o)){a({result:false,info:"第"+(b+1)+"空格的答案还没有选择"});return}for(var j=i.选项组.选项集合,m=j.length,d=0;d<m;d++){k=j[d].选项内容文本;if(DataManage.isEmptyOrNull(k)){a({result:false,info:"第"+(b+1)+"空格的选项"+DataManage.getUpperCase(d)+"的内容为空"});return}}}}}a({result:true,infor:""})},T20:function(g,c){for(var e=SetManage.compose.T20,f=e.length,a,b,d=0;d<f;d++){a=e[d];b=g[a];switch(a){case"题干文本":if(DataManage.isEmptyOrNull(b)){c({result:false,info:"题干内容为空"});return}break;case"答案":if(b==null){c({result:false,info:"没有选择答案"});return}}}c({result:true,infor:""})},T30:function(k,d){for(var i=SetManage.compose.T30,j=i.length,f,b,h=0;h<j;h++){f=i[h];b=k[f];switch(f){case"题干文本":if(DataManage.isEmptyOrNull(b)){d({result:false,info:"题干内容为空"});return}break;case"连线题左选项集合":for(var e=b.length,a=0;a<e;a++)if(DataManage.isEmptyOrNull(b[a].选项内容文本)){d({result:false,info:"左选框:选项"+DataManage.getUpperCase(a)+"的内容为空"});return}for(var a=0;a<e;a++)for(var c=0;c<e;c++)if(a!=c&&b[a].选项内容文本==b[c].选项内容文本){d({result:false,info:"左选框:选项"+DataManage.getUpperCase(a)+"与选项"+DataManage.getUpperCase(c)+"个内容相同"});return}break;case"连线题右选项集合":for(var e=b.length,a=0;a<e;a++)if(DataManage.isEmptyOrNull(b[a].选项内容文本)){d({result:false,info:"右选框:选项"+DataManage.getLowerCase(a)+"的内容为空"});return}for(var a=0;a<e;a++)for(var c=0;c<e;c++)if(a!=c&&b[a].选项内容文本==b[c].选项内容文本){d({result:false,info:"右选框:选项"+DataManage.getLowerCase(a)+"与选项"+DataManage.getLowerCase(c)+"个内容相同"});return}break;case"连线题答案集合":for(var g,a=0;a<b.length;a++){g=b[a];if(DataManage.isEmptyOrNull(g.连线题左选项ID)){d({result:false,info:"答案栏:第"+(a+1)+"栏的第1个答案没有选择"});return}if(DataManage.isEmptyOrNull(g.连线题右选项ID)){d({result:false,info:"答案栏:第"+(a+1)+"栏的第2个答案没有选择"});return}}}}d({result:true,infor:""})},T40:function(i,b){for(var g=SetManage.compose.T40,k=g.length,d,a,j=SetManage.names["T"+i.小题型Enum],f=0;f<k;f++){d=g[f];a=i[d];switch(d){case"题干文本":if(DataManage.isEmptyOrNull(a)){b({result:false,info:j+"的题干内容为空"});return}break;case"子小题集合":if(a.length==0){b({result:false,info:j+"没有包括子小题型"});return}for(var e,h=false,c=0;c<a.length;c++){e=a[c];this.content(e,function(a){if(!a.result){b({result:false,info:"第"+(c+1)+"小题["+SetManage.names["T"+e.小题型Enum]+"]-"+a.info});h=true}});if(h)return}}}b({result:true,infor:""})},T60:function(g,c){for(var e=SetManage.compose.T60,f=e.length,a,b,d=0;d<f;d++){a=e[d];b=g[a];switch(a){case"题干文本":if(DataManage.isEmptyOrNull(b)){c({result:false,info:"题干内容为空"});return}break;case"答案":if(DataManage.isEmptyOrNull(DataManage.htmlToText(b))){c({result:false,info:"答案内容为空"});return}}}c({result:true,infor:""})},T80:function(m,c){for(var i=SetManage.compose.T80,p=i.length,f,a,g=0;g<p;g++){f=i[g];a=m[f];switch(f){case"题干文本":if(DataManage.isEmptyOrNull(a)){c({result:false,info:"多题干共选项题的题干内容为空"});return}break;case"子小题集合":if(a.length==0){c({result:false,info:"多题干共选项题没有包括子小题型"});return}for(var b,l=false,j={},k=m.选项组集合,o=k.length,d=0;d<a.length;d++){b=a[d];b.选项集合=[];var e=b.选项组ID,q=$("#"+e).parent("div").index();if(!j[e]&&q==d){for(var h=0;h<o;h++){var n=k[h];if(n.ID==e){b.选项集合=n.选项集合;break}}j[e]=true}this.content(b,function(a){if(!a.result){c({result:false,info:"第"+(d+1)+"小题["+SetManage.names["T"+b.小题型Enum]+"]-"+a.info});l=true}});if(l)return}break;case"选项组集合":if(a.length==0){c({result:false,info:"没有包括选项组!"});return}}}c({result:true,infor:""})},T8011:function(g,b){for(var f=SetManage.compose.T8011,i=f.length,d,a,h,e=0;e<i;e++){d=f[e];a=g[d];switch(d){case"题干文本":if(DataManage.isEmptyOrNull(a)){b({result:false,info:"题干内容为空"});return}break;case"答案ID":if(DataManage.isEmptyOrNull(a)){b({result:false,info:"没有选择答案"});return}break;case"选项集合":for(var c=0;c<a.length;c++){h=a[c].选项内容文本;if(DataManage.isEmptyOrNull(h)){b({result:false,info:"选项组:选项"+DataManage.getUpperCase(c)+"的内容为空"});return}}}}delete g.选项集合;b({result:true,infor:""})},content:function(a,b){switch(a.小题型Enum){case"11":this.T11(a,b);break;case"12":this.T12(a,b);break;case"13":this.T13(a,b);break;case"14":this.T14(a,b);break;case"15":this.T15(a,b);break;case"20":this.T20(a,b);break;case"30":this.T30(a,b);break;case"40":case"41":case"42":case"43":case"44":case"45":case"46":case"47":this.T40(a,b);break;case"60":case"61":case"62":case"63":case"64":case"65":case"66":case"67":case"68":case"69":this.T60(a,b);break;case"80":this.T80(a,b);break;case"8011":this.T8011(a,b);break;default:b({result:false,info:"没有找到需验证的试题！"})}},sortToArray:function(b){for(var c=[],a=0;a<b.length;a++)c.push(b[a].分类名);return c},sort:function(e,c){for(var b=this.sortToArray(e.分类列表),d=b.length,a=0;a<d;a++)if(!DataManage.isEmptyOrNull(b[a])){c({result:true,info:""});return}c({result:false,info:"分类组:请填写分类名称(至少一个分类)"})}},View试题管理={isLoadJs:false,loadJs:function(a){if(this.isLoadJs){a();return}$.getScript(LKConfig.URLAssembly.Subject.JavaScript.get("SubjectView"),function(){View试题管理.isLoadJs=true;a()},false)},显示试题预览:function(a){this.loadJs(function(){var b=a&&MulitpleSubject.isChild(a)?HashTable.get(a).ID:null;IFrameSubjectViewJson.loadIFrame(function(){TestManage.getData(null,function(a){IFrameSubjectViewJson.showViewBox(a,b)})})})},显示相似试题的试题预览:function(a){this.loadJs(function(){IFrameSubjectViewJson.loadIFrame(function(){TestManage.getData(a,function(a){IFrameSubjectViewJson.showViewBox(a,null)})})})}},Recog试题管理={isLoadJs:false,loadJs:function(a){if(this.isLoadJs){a();return}$.getScript(LKConfig.URLAssembly.Subject.JavaScript.get("SubjectRecog"),function(){Recog试题管理.isLoadJs=true;a()},false)},显示识别输入:function(c,a,g){a=a||BaseManage.guidTeam;var b=DataManage.clone(HashTable.get(a)),d=b.小题型Enum;switch(d){case"11":case"12":case"14":break;case"15":if(b.单选空格集合.length<1){HandleTip.recogMsgT15(c);return}break;case"8011":var e=b.选项组ID,f=$("#"+e,$("#"+a).parent("div"));if(f.length==0){HandleTip.recogMsgT8011(c);return}break;default:HandleTip.recogMsgNoneSup(c,d);return}this.loadJs(function(){IFrameSubjectRecogJson.loadIFrame(function(){IFrameSubjectRecogJson.showRecogBox(a,b,function(){switch(g){case 0:var c=IFrameFckEditor.settings,e=c.guidTeam,l=c.mark,d=c.types,k=c.guidGroup,a=c.index;switch(l){case"11":case"12":if(d=="OptionNormal"){var f=HashTable.get(e),h=f.选项列表,b=h.length-1;a=a>b?b:a}break;case"14":if(d=="OptionT14"){var f=HashTable.get(e),h=f.选项组.选项集合,b=h.length-1;a=a>b?b:a}break;case"15":if(d=="OptionT15")for(var f=HashTable.get(e),j=f.单选空格集合,i=0;i<j.length;i++)if(i==k){var h=j[i].选项组.选项集合,b=h.length-1;a=a>b?b:a;break}break;case"8011":if(d=="OptionT8011"){var f=HashTable.get(e),h=f.选项集合,b=h.length-1;a=a>b?b:a}}IFrameFckEditor.navToggle(d,c.guidGroup,a)}})})})},pushDataTitle:function(a,b){a.题干HTML=b.题干文本;a.题干文本=b.题干文本},getOptionsData:function(h,g,i){for(var e,c,a,f=[],d={},b=0;b<g.length;b++){e=h[b]||{};a=e.ID||DataManage.getGuid();c=g[b].选项内容文本;d[a]=a;f.push({ID:a,选项内容HTML:c,选项内容文本:c})}i(f,d)},pushDataT11:function(a,b,e){e&&this.pushDataTitle(a,b);var c=a.选项列表,d=b.选项列表;this.getOptionsData(c,d,function(c,b){a.选项列表=c;a.答案ID=b[a.答案ID]||null})},pushDataT12:function(a,e,h){h&&this.pushDataTitle(a,e);var f=a.选项列表,d=a.答案列表,b,c=[],g=e.选项列表;this.getOptionsData(f,g,function(g,f){a.选项列表=g;for(var e=0;e<d.length;e++){b=d[e];f[b]&&c.push(b)}a.答案列表=c})},pushDataT14:function(b,f){var d=b.选项组.选项集合,c=b.选词空格集合,a,e=f.选项组.选项集合;this.getOptionsData(d,e,function(f,e){b.选项组.选项集合=f;for(var d=0;d<c.length;d++){a=c[d];a.答案ID=e[a.答案ID]?a.答案ID:null}})},pushDataT15:function(h,i){for(var d=h.单选空格集合,a,e,g=i.单选空格集合,c,f,b=0;b<d.length;b++){a=d[b];c=g[b];if(c){e=a.选项组.选项集合;f=c.选项组.选项集合;this.getOptionsData(e,f,function(c,b){a.选项组.选项集合=c;a.答案ID=b[a.答案ID]||null})}}},pushDataT8011:function(c,a,d,h){h&&this.pushDataTitle(a,d);var f=a.选项集合,g=d.选项集合,e=a.选项组ID,b;this.getOptionsData(f,g,function(h,g){a.选项集合=h;a.答案ID=g[a.答案ID]||null;b=a.答案ID?true:false;AnswerGroup.refT8011(c,b);var i=$("#"+c).parent("div"),j=i.siblings("div"),f,d;j.each(function(){f=$(this).children("div:eq(1)").attr("id");d=HashTable.get(f);if(e==d.选项组ID){d.答案ID=g[d.答案ID]||null;b=d.答案ID?true:false;AnswerGroup.refT8011(f,b)}})})},pushData:function(c,b,d){var e=c.guidTeam,f=c.mark,a=HashTable.get(e);switch(f){case"11":this.pushDataT11(a,b,d);break;case"12":this.pushDataT12(a,b,d);break;case"14":this.pushDataT14(a,b);break;case"15":this.pushDataT15(a,b);break;case"8011":this.pushDataT8011(e,a,b,d);break;default:alert("没有找到相关项,标识为"+f)}HtmlManage.refFckEditor(c,a)}},Image试题管理={isLoadJs:false,loadJs:function(a){if(this.isLoadJs){a();return}$.getScript(LKConfig.URLAssembly.Subject.JavaScript.get("SubjectImages"),function(){Image试题管理.isLoadJs=true;a()},false)},显示图片管理:function(){var a=this;LK_LoginReg.show({是否提示未登录:true,预回调函数:function(){a.loadJs(function(){IFrameSubjectImages.loadIFrame(function(){IFrameSubjectImages.showImagesBox()})})}})}},TestManage={isTest:false,testID:0,init:function(){this.testID=this.testID||$("#TestID")},getScroll:function(){this.init();return this.testID.scrollTop()},callbackTest:function(b,a){this.isTest&&this.getData(b,function(b){AddSubManage.AddSubJson(b,function(b){alert(b.info);if(b.result)a&&a()})})},getData:function(a,b){ReferServer.getData(a,function(g){for(var f=DataManage.clone(g),d=f.content,h=d.ID,a=d.子小题集合||[],c=0;c<a.length;c++){var e=a[c];e.父试题内容ID=h;a[c]={试题内容Json:{content:e},每小题分值:null}}delete d.子小题集合;b({试题内容Json:f,子小题集合:a,每小题分值:null})})}},ReferServer={boxy:0,referBox:0,data:{content:0,outside:0},isInit:false,isTest:false,isEdited:false,isTimeOut:false,stateEnum:{referState:0,beforeState:0},equals:{isCont:false,isSort:false},initBoxy:function(){this.boxy=this.boxy||new Boxy('<div class="referServer" id="ReferServerBox"></div>',{title:"请稍等......",closeText:"[关闭]",show:false,modal:true,fixed:true,afterShow:function(){ReferServer.afterShow()},afterHide:function(){ReferServer.afterHide()}});this.referBox=$("#ReferServerBox");this.isInit=true},show:function(){this.boxy.show()},hide:function(){this.boxy.hide()},afterShow:function(){this.setTitle();this.checkData()},afterHide:function(){},isCloseAble:function(a){this.boxy.isCloseAble(a)},setTitle:function(a){a=a||this.boxy;a.setTitle("提交"+BaseManage.names)},getNamesNorHtml:function(){return'<span class="refer_s_h_red">'+BaseManage.names+"试题</span>"},getNamesDraftHtml:function(){return'<span class="refer_s_h_red">'+BaseManage.names+"草稿</span>"},getHeader:function(a){switch(a){case"newNormalFull":return"新增["+this.getNamesNorHtml()+"]已保存成功，你可以继续执行以下操作.";break;case"newDraftFin":return"新增["+this.getNamesDraftHtml()+"]已保存成功，你可以继续执行以下操作.";break;case"updateNormalFull":return"修改["+this.getNamesNorHtml()+"]已保存成功，你可以继续执行以下操作.";break;case"updateDraftFin":return"修改["+this.getNamesDraftHtml()+"]已保存成功，你可以继续执行以下操作.";break;case"existSimil":return"提交["+this.getNamesNorHtml()+"]还未完成,该试题在爱考网上已有相似试题.";break;case"unFinish":return"提交["+this.getNamesNorHtml()+"]失败,请查看以下原因,更改后再提交.";break;case"timeOut":return"提交["+this.getNamesNorHtml()+"]已超时，你可以点击下面的按钮'重新提交'.";break;case"thrown":return"提交["+this.getNamesNorHtml()+"]发生异常，检测到以下异常信息.";break;default:return""}},getWait:function(b){return'<div class="refer_s_c_load"></div><div class="refer_s_c_msg">'+b+"</div>"},getSpan:function(a){return'<div class="refer_s_c_bar"><div class="refer_s_c_icon"></div><div class="refer_s_c_font"><span class="font666" style="font-size:13px;">'+a+"</span></div></div>"},getLink:function(a,b){return'<div class="refer_s_c_bar"><div class="refer_s_c_icon"></div><div class="refer_s_c_font"><a class="fontLink" href="javascript:void(0)" title="'+DataManage.htmlToText(a)+'" onclick="'+b+'">'+a+"</a></div></div>"},getHref:function(a,b){return'<div class="refer_s_c_bar"><div class="refer_s_c_icon"></div><div class="refer_s_c_font"><a class="fontLink" target="_blank" href="'+b+'" title="'+DataManage.htmlToText(a)+'" >'+a+"</a></div></div>"},getContent:function(b,a){switch(b){case"checkWait":return this.getWait("正在检验["+this.getNamesNorHtml()+"],请稍等 ......");break;case"referWait0":return this.getWait("正在提交["+this.getNamesNorHtml()+"],请稍等 ......");break;case"referWait4":return this.getWait("正在提交["+this.getNamesDraftHtml()+"],请稍等 ......");break;case"unFinish":return this.getSpan(a);break;case"unUpdate":return this.getSpan("您还没有做任何的修改,请修改内容后再提交");break;case"exeHandle":return a;break;case"nullState":return this.getSpan("试题状态无效");break;case"timeOut":return this.getLink("重新提交","ReferServer.verify_login();");break;case"thrown":return this.getSpan(a);break;default:return""}},setBodysBox:function(c,a,d){var b='<div class="refer_s_header" >'+this.getHeader(c)+'</div><div class="refer_s_content" >'+this.getContent(a,d)+"</div>";this.referBox.html(b)},save_sel_box:0,save_sel_isshow:false,save_sel_init:function(b){var a=this;this.save_sel_box=this.save_sel_box||new MsgBox('<div class="E_S_L_B_H_B_Cont">    <a href="javascript:void(0)" onclick="ReferServer.submit(0);ReferServer.save_sel_hide();" title="提交到爱考网">提&nbsp;&nbsp;&nbsp;交</a>    <a href="javascript:void(0)" onclick="ReferServer.submit(4);ReferServer.save_sel_hide();" title="保存为草稿类型">保 存 草 稿</a></div>',{isAutoHide:true,afterShow:function(){a.save_sel_isshow=true;a.save_sel_hight(b,"addClass")},afterHide:function(){a.save_sel_isshow=false;a.save_sel_hight(b,"removeClass")},afterOver:function(){a.save_sel_hight(b,"addClass")}})},save_sel_show:function(){this.save_sel_box.show()},save_sel_hide:function(){this.save_sel_box&&this.save_sel_box.hide()},save_sel_site:function(b){var a=DataManage.getOffset(b);a.top+=24;a.left-=60;this.save_sel_box.moveElem(a)},save_sel_set:function(){var a=this.save_sel_box.getInner();if(TestManage.isTest||!BaseManage.isNew&&SetManage.outside.试题状态Enum==0)a.children("div").find("a:last").hide();else a.children("div").find("a:last").show()},save_sel:function(b){var a=$(b);this.save_sel_init(a);this.save_sel_site(a);this.save_sel_show();this.save_sel_set()},save_sel_mouse:function(c,b){var a=$(c);switch(b){case"over":this.save_sel_hight(a,"addClass");break;case"out":this.save_sel_isshow||this.save_sel_hight(a,"removeClass")}},save_sel_hight:function(a,b){a[b]&&a[b]("E_S_L_B_H_B_right1")},submit:function(c){ReferServer.isInit||ReferServer.initBoxy();var a=parseInt(c),b=this.stateEnum;if(a!=0&&a!=4){alert("没有找到提交的相关项!!!");return}b.referState=a;b.beforeState=SetManage.outside.试题状态Enum;this.getData(null,function(a){ReferServer.data=a;ReferServer.show()})},getData:function(h,g){var j=HtmlManage.eleMoreHtml.children("div"),f=h||j.attr("id"),c=HashTable.get(f),i=c.小题型Enum;switch(i){case"40":case"41":case"42":case"43":case"44":case"45":case"46":case"47":var d;c.子小题集合=[];_chsElem=HtmlManage.getT40ChsElem(f);_chsElem.each(function(){d=$(this).children("div:eq(1)").attr("id");c.子小题集合.push(HashTable.get(d))});break;case"80":var d,b,e,a;c.子小题集合=[];c.选项组集合=[];_chsElem=HtmlManage.getT40ChsElem(f);_chsElem.each(function(){d=$(this).children("div:eq(1)").attr("id");b=HashTable.get(d);a={};a.小题型Enum=b.小题型Enum;a.题干HTML=b.题干HTML;a.题干文本=b.题干文本;a.解题思路=b.解题思路;a.选项组ID=b.选项组ID;a.答案ID=b.答案ID;a.ID=b.ID;a.父试题内容ID=b.父试题内容ID;c.子小题集合.push(a);e=b.选项集合;if(e.length!=0){a={};a.ID=b.选项组ID;a.选项集合=e;c.选项组集合.push(a)}})}g&&g({content:c,outside:SetManage.outside})},checkContent:function(a,b){ValidateManage.content(a,function(a){if(a.result)b();else ReferServer.checkFail(a.info)})},checkOutside:function(b,a){BaseManage.is协同编辑?a():ValidateManage.sort(b,function(b){if(b.result)a();else ReferServer.checkFail(b.info)})},equalsData:function(f,a,h){var b=this.equals,c=EqualsManage.changeContent(f),d=EqualsManage.changeSort(a.分类列表),g=EqualsManage.changePublic(a.是否公开),e=EqualsManage.changeDifficult(a.难易度);if(!c&&!d&&!g&&!e)this.setBodysBox("unFinish","unUpdate",null);else{b.isCont=c;b.isSort=d;h()}},checkData:function(){var c=this.data,a=c.content,b=c.outside;this.checkContent(a,function(){ReferServer.checkOutside(b,function(){BaseManage.isNew?ReferServer.verify_login():ReferServer.equalsData(a,b,function(){ReferServer.verify_login()})})})},getJsonText:function(c,b){if(BaseManage.isNew)return DataManage.jsonToText({content:c,outside:b});var d=this.equals,e=d.isCont,f=d.isSort,a={content:null,outside:null};a.content=e?c:null;if(f)a.outside=b;else{a.outside=DataManage.clone(b);a.outside.分类列表=[]}return DataManage.jsonToText(a)},verify_login:function(){var a=this;if(GlobalManage.get_cookie_uid()!=null)a.checkSuccess("验证相似试题");else{a.hide();LK_LoginReg.show({是否提示未登录:true,预回调函数:function(){a.show()}})}},checkSuccess:function(b){var e=this.stateEnum,c=e.referState;this.setBodysBox(null,"referWait"+c,null);this.isCloseAble(false);var h=this.data,f=h.content,d=h.outside,g=GlobalManage.get_cookie_uid();f.操作人ID=g;d.试题状态Enum=c;d.创建人ID=d.创建人ID||g;var a=this.getJsonText(f,d);if(BaseManage.isNew)if(c==0)this.ajaxNewNormal(a,b);else this.ajaxNewDraft(a,b);else if(e.beforeState==0)this.ajaxUpdateNormal(a,b);else if(c==0)this.ajaxUpdateDraftToNormal(a,b);else this.ajaxUpdateDraftToDraft(a,b)},checkFail:function(a){this.setBodysBox("unFinish","unFinish",a)},reBeforeHide:function(){ReferServer.boxy.options.beforeHide=function(){}},beforeReNewNormal:function(a,b){this.boxy.options.beforeHide=function(){EditSubjectManage.fadeBox(EditSubjectManage.reNewParent,a,b);ReferServer.reBeforeHide()}},beforeReUpdateNormal:function(a){this.boxy.options.beforeHide=function(){EditSubjectManage.fadeBox(EditSubjectManage.reUpdateParent,a,null);ReferServer.reBeforeHide()}},getNewNormalHandle:function(){var a=BaseManage.guidTeam,b=BaseManage.mark;this.beforeReNewNormal(a,b);return this.getLink("预览该试题","View试题管理.显示试题预览(null);")+this.getLink('新增试题<span class="font666">(同新增该试题的模式)</span>',"ReferServer.beforeReNewNormal('"+a+"','"+b+"');ReferServer.hide();")+this.getLink("修改该试题","ReferServer.beforeReUpdateNormal('"+a+"');ReferServer.hide();")+(TestManage.isTest?this.getLink("查看自己添加的试题","TestReferSever.ajaxFindSub(1);ReferServer.hide();"):this.getHref("查看自己添加的试题",LKConfig.URLAssembly.Subject.Page.get("Subject_Finish")))},getNewDraftHandle:function(){var a=BaseManage.guidTeam,b=BaseManage.mark;this.beforeReNewNormal(a,b);return this.getLink("预览该草稿","View试题管理.显示试题预览(null);")+this.getLink('新增试题<span class="font666">(同新增该草稿的模式)</span>',"ReferServer.beforeReNewNormal('"+a+"','"+b+"');ReferServer.hide();")+this.getLink("修改该草稿","ReferServer.beforeReUpdateNormal('"+a+"');ReferServer.hide();")+this.getHref("查看试题草稿箱",LKConfig.URLAssembly.Subject.Page.get("Subject_DraftBox"))},getUpdateNormalHandle:function(){var a=BaseManage.guidTeam,b=BaseManage.mark;this.beforeReUpdateNormal(a);return this.getLink("预览该试题","View试题管理.显示试题预览(null);")+this.getLink('新增试题<span class="font666">(同修改该试题的模式)</span>',"ReferServer.beforeReNewNormal('"+a+"','"+b+"');ReferServer.hide();")+this.getLink("修改该试题","ReferServer.beforeReUpdateNormal('"+a+"');ReferServer.hide();")+(TestManage.isTest?this.getLink("查看自己添加的试题","ReferServer.beforeReNewNormal('"+a+"','"+b+"');TestReferSever.ajaxFindSub(1);ReferServer.hide();"):this.getHref("查看自己添加的试题",LKConfig.URLAssembly.Subject.Page.get("Subject_Finish")))},getUpdateDraftHandle:function(){var a=BaseManage.guidTeam,b=BaseManage.mark;this.beforeReUpdateNormal(a);return this.getLink("预览该草稿","View试题管理.显示试题预览(null);")+this.getLink('新增试题<span class="font666">(同修改该草稿的模式)</span>',"ReferServer.beforeReNewNormal('"+a+"','"+b+"');ReferServer.hide();")+this.getLink("修改该草稿","ReferServer.beforeReUpdateNormal('"+a+"');ReferServer.hide();")+this.getHref("查看试题草稿箱",LKConfig.URLAssembly.Subject.Page.get("Subject_DraftBox"))},exeNewNormalFull:function(){this.setBodysBox("newNormalFull","exeHandle",this.getNewNormalHandle())},exeNewDraftFull:function(){this.setBodysBox("newDraftFin","exeHandle",this.getNewDraftHandle())},exeUpdateNormalFull:function(){this.setBodysBox("updateNormalFull","exeHandle",this.getUpdateNormalHandle())},exeUpdateDraftFull:function(){this.setBodysBox("updateDraftFin","exeHandle",this.getUpdateDraftHandle())},getExistSimilAddTest:function(a){TestManage.callbackTest(a,function(){ReferServer.beforeReNewNormal(BaseManage.guidTeam,BaseManage.mark);ReferServer.hide()})},getExistSimilHandle:function(j,l){for(var h=j.相似试题列表||[],d,f,e=j.百分比列表||[],g,i=false,b,k,c="",a=0;a<h.length;a++){d=h[a].content;f=d.题干文本;g=e[a];i=g==100?true:false;b=d.ID;HashTable.put(b,d);k=DataManage.getCutPoint(f,15);c+='<div class="refer_simil_cell"><div class="refer_s_c_icon"></div><label>'+(a+1)+'.</label><span style="width:200px;display:inline-block;"><a href="javascript:void(0)" title="'+f+'" onclick="View试题管理.显示相似试题的试题预览(\''+b+"');\" >"+k+'</a></span><span class="baifenbi" title="约'+e[a]+'%相似">约<font>'+e[a]+'</font>%相似</span><a class="yulan" href="javascript:void(0)" title="预览该相似试题" onclick="View试题管理.显示相似试题的试题预览(\''+b+"');\" >预览</a>"+(TestManage.isTest?'<a class="shijuan" href="javascript:void(0)" title="添加到该试卷当前题型中" onclick="ReferServer.getExistSimilAddTest(\''+b+"');\" >加入到试卷</a>":"")+"</div>"}if(i)switch(l){case"新增一道完整试题":case"新增一道草稿试题":c+=this.getLink('我要重新新增试题<span class="font666">(放弃当前试题)</span>',"ReferServer.beforeReNewNormal('"+BaseManage.guidTeam+"','"+BaseManage.mark+"');ReferServer.hide();");break;case"修改一道完整试题":case"修改草稿为完整试题":case"修改草稿为草稿试题":c+=this.getLink("我要重新修改试题","ReferServer.hide();")}else c+=this.getLink("不管，我要继续保存试题","ReferServer.checkSuccess('取消验证相似题');");return c},exeExistSimil:function(a,b){this.setBodysBox("existSimil","exeHandle",this.getExistSimilHandle(a,b))},exeFail:function(a,b){if(this.isTimeOut&&a.info.indexOf("插入重复键")!=-1){this.isTimeOut=false;b&&b()}else this.setBodysBox("unFinish","unFinish",a.info)},exeError:function(c,a){switch(a){case"timeout":this.isTimeOut=true;this.setBodysBox("timeOut","timeOut",null);break;default:this.setBodysBox("thrown","thrown","对不起,未检测到任何异常信息！")}},ajaxNewNormal:function(a,b){$.ajax({type:"POST",url:LKConfig.URLAssembly.Subject.Server.get("NewNormal"),data:{action:"试题管理_新增一道完整试题",text:a,type:b},dataType:"json",success:function(a){ReferServer.isCloseAble(true);if(a.result)switch(a.type){case"simil":ReferServer.exeExistSimil(a.info,"新增一道完整试题");break;case"subject":ReferServer.exeNewNormalFull();TestManage.callbackTest(null,null);ReferServer.isEdited=true}else ReferServer.exeFail(a,function(){ReferServer.exeNewNormalFull();TestManage.callbackTest(null,null);ReferServer.isEdited=true})},error:function(c,b,a){ReferServer.isCloseAble(true);ReferServer.exeError(c,b,a)}})},ajaxNewDraft:function(a,b){$.ajax({type:"POST",url:LKConfig.URLAssembly.Subject.Server.get("NewDraft"),data:{action:"试题管理_新增一道草稿试题",text:a,type:b},dataType:"json",success:function(a){ReferServer.isCloseAble(true);if(a.result)switch(a.type){case"simil":ReferServer.exeExistSimil(a.info,"新增一道草稿试题");break;case"subject":ReferServer.exeNewDraftFull();ReferServer.isEdited=true}else ReferServer.exeFail(a,function(){ReferServer.exeNewDraftFull();ReferServer.isEdited=true})},error:function(c,b,a){ReferServer.isCloseAble(true);ReferServer.exeError(c,b,a)}})},ajaxUpdateNormal:function(a,b){$.ajax({type:"POST",url:LKConfig.URLAssembly.Subject.Server.get("UpdateNormal"),data:{action:"试题管理_修改一道完整试题",text:a,type:b},dataType:"json",success:function(a){ReferServer.isCloseAble(true);if(a.result)switch(a.type){case"simil":ReferServer.exeExistSimil(a.info,"修改一道完整试题");break;case"subject":ReferServer.exeUpdateNormalFull();TestManage.callbackTest(null,null);ReferServer.isEdited=true}else ReferServer.exeFail(a,function(){ReferServer.exeUpdateNormalFull();TestManage.callbackTest(null,null);ReferServer.isEdited=true})},error:function(c,b,a){ReferServer.isCloseAble(true);ReferServer.exeError(c,b,a)}})},ajaxUpdateDraftToNormal:function(a,b){$.ajax({type:"POST",url:LKConfig.URLAssembly.Subject.Server.get("UpdateDraftToNormal"),data:{action:"试题管理_修改草稿为完整试题",text:a,type:b},dataType:"json",success:function(a){ReferServer.isCloseAble(true);if(a.result)switch(a.type){case"simil":SetManage.outside.试题状态Enum=4;ReferServer.exeExistSimil(a.info,"修改草稿为完整试题");break;case"subject":ReferServer.exeUpdateNormalFull();ReferServer.isEdited=true}else ReferServer.exeFail(a,function(){ReferServer.exeUpdateNormalFull();ReferServer.isEdited=true})},error:function(c,b,a){ReferServer.isCloseAble(true);ReferServer.exeError(c,b,a)}})},ajaxUpdateDraftToDraft:function(a,b){$.ajax({type:"POST",url:LKConfig.URLAssembly.Subject.Server.get("UpdateDraftToDraft"),data:{action:"试题管理_修改草稿为草稿试题",text:a,type:b},dataType:"json",success:function(a){ReferServer.isCloseAble(true);if(a.result)switch(a.type){case"simil":ReferServer.exeExistSimil(a.info,"修改草稿为草稿试题");break;case"subject":ReferServer.exeUpdateDraftFull();ReferServer.isEdited=true}else ReferServer.exeFail(a,function(){ReferServer.exeUpdateDraftFull();ReferServer.isEdited=true})},error:function(c,b,a){ReferServer.isCloseAble(true);ReferServer.exeError(c,b,a)}})},ajaxGetData:function(a,b){$.ajax({type:"POST",url:LKConfig.URLAssembly.Subject.Server.get("GetSubject"),data:{action:"试题管理_查询一道试题",guid:a},dataType:"json",success:function(a){if(a.result){if(typeof a.info=="string")a.info=eval("("+a.info+")");EditSubjectManage.fadeBox(EditSubjectManage.updateParent,a.info,null);b()}else alert("对不起,获取该试题失败，错误原因："+a.info)},error:function(c,a){alert("对不起,获取该试题失败."+a)}})}}